<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0088cc">
    <title>–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤ –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè†</text></svg>">

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- Google Fonts: Roboto (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap&subset=cyrillic" rel="stylesheet">

    <style>
        /* TELEGRAM THEME VARIABLES */
        :root {
            --tg-bg-color: var(--tg-theme-bg-color, #ffffff);
            --tg-text-color: var(--tg-theme-text-color, #000000);
            --tg-hint-color: var(--tg-theme-hint-color, #999999);
            --tg-button-color: var(--tg-theme-button-color, #2481cc);
            --tg-button-text-color: var(--tg-theme-button-text-color, #ffffff);
            --tg-secondary-bg-color: var(--tg-theme-secondary-bg-color, #f0f2f5);

            /* –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ */
            --bg-primary: var(--tg-secondary-bg-color, #f0f2f5);
            --bg-secondary: var(--tg-bg-color, #ffffff);
            --text-primary: var(--tg-text-color, #000000);
            --text-secondary: var(--tg-hint-color, #999999);
            --border-color: rgba(128, 128, 128, 0.2);
            --hover-bg: var(--tg-secondary-bg-color, #f5f7fa);
        }

        /* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ Telegram */
        * {
            box-sizing: border-box;
        }

        html, body {
            background-color: var(--tg-secondary-bg-color);
            color: var(--tg-text-color);
        }

        /* –í—Å–µ —Ñ–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .sidebar-menu,
        .chats-panel,
        .menu-content,
        .chats-list,
        .chat-item,
        .message-input-area,
        .search-box,
        .filter-chip,
        .menu-item,
        .report-card,
        .detail-value,
        .action-btn.secondary,
        .fab-item-label {
            background: var(--bg-secondary) !important;
            color: var(--text-primary) !important;
        }

        /* –û—Å–Ω–æ–≤–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ */
        .main-chat,
        .messages-container,
        .large-report-panel,
        .side-menu-overlay {
            background: var(--bg-primary) !important;
        }

        /* –¢–µ–∫—Å—Ç –≤–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö */
        .chat-name,
        .chat-time,
        .last-message,
        .cooperative-name,
        .cooperative-stats,
        .menu-item-name,
        .menu-item-subtitle,
        .menu-section-title,
        .report-card-title,
        .report-card-desc,
        .message-content,
        .message-time,
        .detail-label {
            color: var(--text-primary) !important;
        }

        /* –ì—Ä–∞–Ω–∏—Ü—ã */
        .sidebar-menu,
        .chats-panel,
        .chat-item,
        .menu-item,
        .search-box,
        .message-input,
        .detail-value {
            border-color: var(--border-color) !important;
        }

        /* –í—Ç–æ—Ä–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç */
        .chat-time,
        .last-message,
        .cooperative-stats,
        .menu-item-subtitle,
        .report-card-desc,
        .message-time,
        .detail-label,
        .filter-chip {
            color: var(--text-secondary) !important;
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ç—ë–º–Ω–æ–π —Ç–µ–º—ã - —É–±–∏—Ä–∞–µ–º –∂—ë—Å—Ç–∫–∏–µ —Ü–≤–µ—Ç–∞ */
        @media (prefers-color-scheme: dark) {
            /* –°–≤–µ—Ç–ª—ã–µ —Ñ–æ–Ω—ã –¥–µ–ª–∞–µ–º —Ç—ë–º–Ω—ã–º–∏ */
            [style*="background:#fff"],
            [style*="background:#ffffff"],
            [style*="background:#f5f7fa"],
            [style*="background:#e3f2fd"],
            [style*="background:#e8f5e9"],
            [style*="background:#fff3e0"],
            [style*="background:#ffebee"] {
                background: var(--bg-secondary) !important;
            }
            
            /* –¢—ë–º–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–µ–ª–∞–µ–º —Å–≤–µ—Ç–ª—ã–º */
            [style*="color:#000"],
            [style*="color:#000000"],
            [style*="color:#333"],
            [style*="color:#666"] {
                color: var(--text-primary) !important;
            }
        }
        
        .container {
            display: flex;
            height: 100%;
            height: 100dvh;  /* Dynamic viewport height –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
            position: relative;
            overflow: hidden;
        }
        
        /* –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò - –®–†–ò–§–¢–´ */
        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-size: 15px;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            font-weight: 500;
            line-height: 1.3;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º */
        button, input, select, textarea {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        }
        
        /* –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –î–ï–°–ö–¢–û–ü–ê */
        .chats-panel {
            position: relative;
            width: 100%;
            max-width: 400px;  /* –ï–¥–∏–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è —á–∞—Ç–æ–≤ –∏ –º–µ–Ω—é */
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            z-index: 50;
        }
        
        .main-chat {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
            min-width: 0;
            position: relative;
        }
        
        /* –õ–ï–í–û–ï –ú–ï–ù–Æ –ù–ê–í–ò–ì–ê–¶–ò–ò - –µ–¥–∏–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Å —á–∞—Ç–∞–º–∏ */
        .sidebar-menu {
            width: 100%;
            max-width: 400px;  /* = chats-panel */
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            height: 100%;
            height: 100dvh;
            z-index: 200;
            transform: translateX(-100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
        }
        
        .sidebar-menu.visible {
            transform: translateX(0);
        }

        /* –ö–ù–û–ü–ö–ê –Ø–ù–î–ï–ö–°.–î–ò–°–ö–ê */
        .yandex-disk-section {
            padding: 10px 16px;
            background: linear-gradient(135deg, #fc0 0%, #f9a800 100%);
            border-bottom: 1px solid var(--border-color);
        }

        .yandex-disk-status {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            gap: 10px;
        }

        .yandex-disk-status:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(252, 0, 0, 0.15);
        }

        .yandex-disk-status:active {
            transform: translateY(0);
        }

        .yandex-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .yandex-text {
            flex: 1;
            font-size: 14px;
            font-weight: 600;
            color: #000;
        }

        .yandex-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50;
            flex-shrink: 0;
        }

        .yandex-indicator.disconnected {
            background: #f44336;
        }

        .yandex-indicator.syncing {
            background: #ff9800;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .menu-header {
            padding: 20px 16px;
            padding-top: max(20px, env(safe-area-inset-top));
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        
        .menu-content {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* –°–¢–ò–õ–ò–ó–ê–¶–ò–Ø –°–ö–†–û–õ–õ–ë–ê–†–û–í - –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }
        
        /* Firefox */
        * {
            scrollbar-width: thin;
            scrollbar-color: var(--border-color) transparent;
        }
        .menu-section { padding: 15px 0; border-bottom: 1px solid #f0f0f0; }
        .menu-section-title {
            padding: 0 20px 10px;
            font-size: 11px;
            font-weight: bold;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .menu-item {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .menu-item:hover { background: var(--hover-bg); }
        .menu-item-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .menu-item-info { flex: 1; min-width: 0; }
        .menu-item-name { font-weight: 500; font-size: 13px; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .menu-item-subtitle { font-size: 11px; color: #999; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .menu-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            background: #e0e0e0;
            margin-left: 8px;
            flex-shrink: 0;
        }
        .menu-badge.alert { background: #ffebee; color: #c62828; }
        .menu-badge.success { background: #e8f5e9; color: #2e7d32; }
        .menu-arrow { color: #ccc; margin-left: 8px; font-size: 14px; }
        
        /* OVERLAY –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–µ–π */
        .panel-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 150;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
        }
        
        .panel-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        /* –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í */
        .table-filters {
            display: flex;
            gap: 10px;
            padding: 15px;
            background: #f5f7fa;
            border-bottom: 1px solid #e0e0e0;
            flex-wrap: wrap;
        }
        .filter-input {
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
            outline: none;
        }
        .filter-input:focus {
            border-color: #0088cc;
            box-shadow: 0 0 0 2px rgba(0,136,204,0.1);
        }
        .filter-select {
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
            background: #fff;
            cursor: pointer;
        }

        /* TOAST –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }
        .toast {
            min-width: 300px;
            padding: 16px 20px;
            border-radius: 8px;
            background: #fff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease;
            pointer-events: auto;
        }
        .toast.success { background: #e8f5e9; border-left: 4px solid #4caf50; }
        .toast.error { background: #ffebee; border-left: 4px solid #f44336; }
        .toast.warning { background: #fff3e0; border-left: 4px solid #ff9800; }
        .toast.info { background: #e3f2fd; border-left: 4px solid #2196f3; }
        .toast-icon { font-size: 20px; }
        .toast-message { flex: 1; font-size: 14px; color: #333; }
        .toast-close {
            background: none;
            border: none;
            font-size: 18px;
            color: #999;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
        }
        @keyframes slideInRight {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(400px); opacity: 0; }
        }
        
        /* INDOCTOR –ó–ê–ì–†–£–ó–ö–ò */
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .loader-overlay.active {
            display: flex;
        }
        .loader {
            width: 50px;
            height: 50px;
            border: 4px solid #fff;
            border-top-color: #0088cc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í */
        .reports-submenu {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            z-index: 50;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .reports-submenu.visible { transform: translateX(0); }
        
        .submenu-header {
            padding: 20px 15px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .submenu-title { font-size: 16px; font-weight: 600; }
        .submenu-back-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .submenu-content { flex: 1; overflow-y: auto; padding: 15px; }
        .submenu-section { margin-bottom: 20px; }
        .submenu-section-title {
            font-size: 11px;
            font-weight: bold;
            color: #999;
            text-transform: uppercase;
            margin-bottom: 12px;
            padding-left: 10px;
            letter-spacing: 0.5px;
        }
        .report-card {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f5f7fa;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .report-card:hover { background: #e3f2fd; transform: translateX(4px); }
        .report-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .report-card-info { flex: 1; min-width: 0; }
        .report-card-title { font-weight: 600; font-size: 13px; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .report-card-desc { font-size: 11px; color: #666; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        /* –°–ü–ò–°–û–ö –ß–ê–¢–û–í - –í–°–ï–ì–î–ê –ù–ê –ú–ï–°–¢–ï */
        .chats-panel {
            width: 400px;
            min-width: 400px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            z-index: 50;
            position: relative;
        }
        
        .chats-header {
            padding: 15px;
            background: #fff;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .burger-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 20px;
        }
        .burger-btn:hover { background: #e0e0e0; }
        
        .cooperative-info { flex: 1; }
        .cooperative-name { font-weight: 600; font-size: 14px; }
        .cooperative-stats { font-size: 12px; color: #666; }
        
        .search-section {
            padding: 12px 15px;
            background: #f5f7fa;
            border-bottom: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .search-box {
            display: flex;
            align-items: center;
            background: #fff;
            border-radius: 20px;
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
        }
        .search-box input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 14px;
        }
        .quick-filters {
            display: flex;
            gap: 6px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .filter-chip {
            padding: 4px 10px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            background: #fff;
            font-size: 12px;
            cursor: pointer;
        }
        .filter-chip.active { background: #0088cc; color: #fff; border-color: #0088cc; }
        
        .chats-list { flex: 1; overflow-y: auto; }
        .chat-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f0f2f5;
            cursor: pointer;
        }
        .chat-item:hover { background: #f5f7fa; }
        .chat-item.active { background: #e3f2fd; }
        .chat-item .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            margin-right: 12px;
            font-size: 18px;
            flex-shrink: 0;
        }
        .chat-item .chat-info {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .chat-item .chat-top, .chat-item .chat-middle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }
        .chat-item .chat-name {
            font-weight: 600;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .chat-item .chat-time { font-size: 11px; color: #999; }
        .chat-item .status { font-size: 11px; }
        .chat-item .status::before { content: '‚óè'; margin-right: 4px; }
        .chat-item .status.active { color: #4caf50; }
        .chat-item .status.debt { color: #f44336; }
        .chat-item .status.pending { color: #ff9800; }
        .chat-item .balance { font-size: 12px; font-weight: 600; }
        .chat-item .balance.positive { color: #4caf50; }
        .chat-item .balance.negative { color: #f44336; }
        .chat-item .last-message {
            font-size: 13px;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* –ú–ê–°–°–û–í–´–ï –û–ü–ï–†–ê–¶–ò–ò */
        .chat-item.selectable {
            position: relative;
            padding-left: 50px;
        }
        .chat-checkbox {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        .mass-actions-panel {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #333;
            color: #fff;
            padding: 15px 25px;
            border-radius: 50px;
            display: none;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        .mass-actions-panel.active {
            display: flex;
            transform: translateX(-50%) translateY(0);
        }
        .mass-actions-panel button {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
        }
        .mass-actions-panel button:hover {
            background: rgba(255,255,255,0.3);
        }
        .mass-count {
            font-weight: 600;
            font-size: 14px;
        }
        
        /* –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ */
        .main-chat {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #f0f2f5;
            min-height: 0;
            position: relative;
        }
        .chat-header {
            padding: 15px 20px;
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .chat-header-left { display: flex; align-items: center; flex: 1; }
        .chat-header-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            margin-right: 12px;
        }
        .chat-header-name { font-weight: 600; font-size: 16px; }
        .chat-header-status { font-size: 12px; color: #4caf50; margin-top: 2px; }
        .chat-header-actions { display: flex; gap: 8px; }
        .header-action-btn, .menu-more-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 16px;
        }
        .messages-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .message {
            max-width: 600px;
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 12px;
            border-radius: 12px;
            cursor: pointer;
            background: #fff;
            align-self: flex-start;
            border-top-left-radius: 4px;
        }
        .message.sent {
            background: #d9fdd3;
            align-self: flex-end;
            border-top-right-radius: 4px;
        }
        .message-type { font-size: 11px; color: #0088cc; font-weight: 600; margin-bottom: 4px; text-transform: uppercase; }
        .message-content { font-size: 14px; color: #333; margin-bottom: 6px; }
        .message-amount { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
        .message-time { font-size: 11px; color: #666; text-align: right; }
        .message-input-wrapper {
            background: #fff;
            border-top: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .message-input-area {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .attach-btn, .voice-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 18px;
        }
        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 24px;
            outline: none;
            font-size: 14px;
        }
        .send-button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            cursor: pointer;
            font-size: 18px;
        }
        
        /* –ë–û–õ–¨–®–ê–Ø –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–æ—Ç—á–µ—Ç—ã) */
        .large-report-panel {
            position: absolute;
            left: 400px;
            right: 0;
            top: 0;
            height: 100%;
            background: #f5f7fa;
            z-index: 97;
            display: none;
            flex-direction: column;
        }
        .large-report-panel.visible { display: flex; }
        .large-report-header {
            padding: 20px 30px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .large-report-title { font-size: 18px; font-weight: 600; }
        .close-large-report-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
        }
        .large-report-content { flex: 1; overflow-y: auto; padding: 30px; }
        
        /* –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ, –¥–µ—Ç–∞–ª–∏) - –±–æ–ª—å—à–∏–µ */
        .sidebar-right, .operation-details-panel, .menu-content-panel {
            width: 100%;
            max-width: 400px;  /* –ë–æ–ª—å—à–∏–µ –ø–∞–Ω–µ–ª–∏ */
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: fixed;
            right: 0;
            top: 0;
            height: 100%;
            height: 100dvh;
            transform: translateX(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 100;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
        }
        .sidebar-right.visible, .operation-details-panel.visible, .menu-content-panel.visible {
            transform: translateX(0);
        }
        .member-info-header, .details-header, .menu-panel-header {
            padding: 20px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .close-info-btn, .close-details-btn, .close-panel-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
        }
        .member-info-content, .details-content, .menu-panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        /* –î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ */
        .detail-tabs { display: flex; border-bottom: 2px solid #e0e0e0; margin-bottom: 20px; }
        .detail-tab {
            padding: 10px 16px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: #666;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }
        .detail-tab.active { color: #0088cc; border-bottom-color: #0088cc; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .detail-item { margin-bottom: 16px; }
        .detail-label { font-size: 12px; color: #666; margin-bottom: 6px; font-weight: 500; }
        .detail-value { padding: 10px 12px; background: #f5f7fa; border-radius: 8px; font-size: 14px; }
        .detail-value.highlight { background: #e3f2fd; color: #0088cc; font-weight: 600; }
        .action-buttons { display: flex; flex-direction: column; gap: 8px; margin-top: 24px; }
        .action-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .action-btn.primary { background: linear-gradient(135deg, #0088cc, #0066aa); color: #fff; }
        .action-btn.secondary { background: #f5f7fa; color: #333; }
        .action-btn.danger { background: #ffebee; color: #c62828; }
        
        /* –ò–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ */
        .member-avatar-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            font-size: 32px;
            margin: 0 auto 15px;
        }
        .member-name-large { text-align: center; font-size: 18px; font-weight: 600; margin-bottom: 5px; }
        .member-status-large { text-align: center; font-size: 13px; color: #666; margin-bottom: 20px; }
        .balance-card {
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .balance-label { font-size: 13px; opacity: 0.9; margin-bottom: 8px; }
        .balance-amount { font-size: 28px; font-weight: 700; }
        .info-section { margin-bottom: 25px; }
        .info-section-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e0e0e0;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f5f7fa;
        }
        .info-label { font-size: 13px; color: #666; }
        .info-value { font-size: 13px; font-weight: 500; color: #333; }
        .info-actions { display: flex; flex-direction: column; gap: 8px; margin-top: 20px; }
        .info-action-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .info-action-btn.primary { background: linear-gradient(135deg, #0088cc, #0066aa); color: #fff; }
        .info-action-btn.secondary { background: #f5f7fa; color: #333; }
        .info-action-btn.danger { background: #ffebee; color: #c62828; }
        
        /* FAB –ö–ù–û–ü–ö–ê */
        .fab-container {
            position: fixed;
            right: 20px;
            bottom: 90px;
            z-index: 1000;
            transition: opacity 0.3s, transform 0.3s;
        }
        .fab-container.hidden {
            opacity: 0;
            transform: scale(0);
            pointer-events: none;
        }
        .fab-main {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            border: none;
            box-shadow: 0 4px 12px rgba(0,136,204,0.4);
            cursor: pointer;
            font-size: 24px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .fab-main:hover { transform: scale(1.1); }
        .fab-main.close { transform: rotate(45deg); }
        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column-reverse;
            gap: 12px;
            pointer-events: none;
        }
        .fab-menu.expanded { pointer-events: all; }
        .fab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
            transition: all 0.3s;
            cursor: pointer;
        }
        .fab-menu.expanded .fab-item {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }
        .fab-item-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            color: #fff;
            font-size: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .fab-item-label {
            margin-top: 4px;
            font-size: 11px;
            color: #333;
            background: rgba(255,255,255,0.95);
            padding: 2px 8px;
            border-radius: 4px;
            white-space: nowrap;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        
        /* –î–ï–°–ö–¢–û–ü (>1024px) - –µ–¥–∏–Ω–∞—è —à–∏—Ä–∏–Ω–∞ 400px */
        @media (min-width: 1025px) {
            .sidebar-menu {
                width: 100%;
                max-width: 400px;  /* = chats-panel */
            }
            
            .chats-panel {
                width: 100%;
                max-width: 400px;
            }
            
            .sidebar-right,
            .operation-details-panel,
            .menu-content-panel {
                width: 100%;
                max-width: 400px;  /* –ë–æ–ª—å—à–∏–µ –ø–∞–Ω–µ–ª–∏ */
            }
            
            .large-report-panel {
                left: 400px;
                right: 0;
                width: auto;
                max-width: none;
            }
        }
        
        /* –ü–õ–ê–ù–®–ï–¢ (768px - 1024px) */
        @media (max-width: 1024px) {
            .sidebar-menu, .reports-submenu, .chats-panel { width: 100%; max-width: 400px; }
            .sidebar-right, .operation-details-panel, .menu-content-panel, .large-report-panel { width: 100%; max-width: 400px; }
            .message { max-width: 600px; }
        }
        
        /* –ú–û–ë–ò–õ–¨–ù–´–ô (481px - 768px) */
        @media (max-width: 768px) {
            .sidebar-menu, .reports-submenu, .chats-panel { width: 100%; max-width: 80%; }
            .sidebar-right, .operation-details-panel, .menu-content-panel, .large-report-panel { width: 100%; max-width: 100%; }
            .message { max-width: 600px; }
        }
        
        /* –ú–ê–õ–ï–ù–¨–ö–ò–ô –ú–û–ë–ò–õ–¨–ù–´–ô (<=480px) */
        @media (max-width: 480px) {
            .sidebar-menu, .reports-submenu, .chats-panel { width: 100%; max-width: 100%; }
        }
        
        /* Safe Areas (iPhone X –∏ –Ω–æ–≤–µ–µ) */
        @supports (padding: max(0px)) {
            .chat-header, .chats-header, .message-input-area {
                padding-left: max(16px, env(safe-area-inset-left));
                padding-right: max(16px, env(safe-area-inset-right));
            }
            
            .menu-header {
                padding-top: max(20px, env(safe-area-inset-top));
            }
        }
    </style>
</head>
<body>
    <!-- OVERLAY –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–µ–π -->
    <div class="panel-overlay" id="panelOverlay"></div>
    
    <div class="container">
        <!-- –õ–ï–í–û–ï –ú–ï–ù–Æ –ù–ê–í–ò–ì–ê–¶–ò–ò -->
        <div class="sidebar-menu" id="sidebarMenu">
            <div class="menu-header">
                <div class="menu-title">üè† –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
                <button class="menu-close-btn" id="menuCloseBtn">‚óÄ</button>
            </div>

            <!-- –ö–ù–û–ü–ö–ê –Ø–ù–î–ï–ö–°.–î–ò–°–ö–ê -->
            <div class="yandex-disk-section" id="yandexDiskSection">
                <div class="yandex-disk-status" id="yandexDiskStatus" onclick="handleYandexDiskClick()">
                    <span class="yandex-icon">‚òÅÔ∏è</span>
                    <span class="yandex-text" id="yandexDiskText">–Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫</span>
                    <span class="yandex-indicator" id="yandexIndicator"></span>
                </div>
            </div>

            <!-- –ü–û–ò–°–ö –ü–û –ú–ï–ù–Æ -->
            <div style="padding:12px 16px;background:#f5f7fa;border-bottom:1px solid var(--border-color)">
                <input type="text" id="menuSearch" placeholder="üîç –ü–æ–∏—Å–∫..." 
                       style="width:100%;padding:8px 12px;border:1px solid var(--border-color);border-radius:6px;font-size:14px;outline:none;background:var(--bg-secondary);color:var(--text-primary)">
            </div>
            
            <div class="menu-content">
                <!-- ‚ö° –ë–´–°–¢–†–´–ô –î–û–°–¢–£–ü -->
                <div class="menu-section">
                    <div class="menu-section-title">‚ö° –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</div>
                    <div class="menu-item" data-panel="favorites">
                        <div class="menu-item-icon" style="background:#fff3e0">‚≠ê</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
                            <div class="menu-item-subtitle">–ß–∞—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="calendar-full">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìÖ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</div>
                            <div class="menu-item-subtitle">–ü–ª–∞–Ω—ã –∏ —Å—Ä–æ–∫–∏</div>
                        </div>
                    </div>
                </div>

                <!-- üë• –ü–ê–ô–©–ò–ö–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">üë• –ü–∞–π—â–∏–∫–∏</div>
                    <div class="menu-item" data-report="members-registry-full">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìã</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤</div>
                            <div class="menu-item-subtitle">–°–ø–∏—Å–æ–∫ –ø–∞–π—â–∏–∫–æ–≤</div>
                        </div>
                        <span class="menu-badge success">12</span>
                    </div>
                    <div class="menu-item" data-action="create-member">
                        <div class="menu-item-icon" style="background:#e8f5e9">‚ûï</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–æ–±–∞–≤–∏—Ç—å –ø–∞–π—â–∏–∫–∞</div>
                            <div class="menu-item-subtitle">–ù–æ–≤—ã–π –ø–∞–π—â–∏–∫</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="edit-member">
                        <div class="menu-item-icon" style="background:#e8f5e9">‚úèÔ∏è</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–π—â–∏–∫–∞</div>
                            <div class="menu-item-subtitle">–ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="certificates-registry-full">
                        <div class="menu-item-icon" style="background:#fce4ec">üìú</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–í—ã–¥–∞–Ω–Ω—ã–µ –±–ª–∞–Ω–∫–∏</div>
                        </div>
                    </div>
                </div>

                <!-- üí≥ –í–ó–ù–û–°–´ -->
                <div class="menu-section">
                    <div class="menu-section-title">üí≥ –í–∑–Ω–æ—Å—ã</div>
                    <div class="menu-item" data-report="payments-report-full">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º</div>
                            <div class="menu-item-subtitle">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="create-payment">
                        <div class="menu-item-icon" style="background:#e3f2fd">‚ûï</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–æ–±–∞–≤–∏—Ç—å –≤–∑–Ω–æ—Å</div>
                            <div class="menu-item-subtitle">–ù–æ–≤—ã–π –≤–∑–Ω–æ—Å</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="create-return-payment">
                        <div class="menu-item-icon" style="background:#ffebee">‚Ü©Ô∏è</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–í–æ–∑–≤—Ä–∞—Ç –≤–∑–Ω–æ—Å–∞</div>
                            <div class="menu-item-subtitle">–û—Ñ–æ—Ä–º–∏—Ç—å –≤–æ–∑–≤—Ä–∞—Ç</div>
                        </div>
                    </div>
                </div>

                <!-- üìò –ë–£–•–ì–ê–õ–¢–ï–†–ò–Ø -->
                <div class="menu-section">
                    <div class="menu-section-title">üìò –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è</div>
                    <div class="menu-item" data-action="create-transaction">
                        <div class="menu-item-icon" style="background:#fff3e0">üìí</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–æ–¥–∫—É</div>
                            <div class="menu-item-subtitle">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≤–æ–¥–∫–∞</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="osv">
                        <div class="menu-item-icon" style="background:#fff3e0">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û–°–í</div>
                            <div class="menu-item-subtitle">–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="pko">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–ö–û</div>
                            <div class="menu-item-subtitle">–ü—Ä–∏—Ö–æ–¥–Ω—ã–π –æ—Ä–¥–µ—Ä</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="rko">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–ö–û</div>
                            <div class="menu-item-subtitle">–†–∞—Å—Ö–æ–¥–Ω—ã–π –æ—Ä–¥–µ—Ä</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="payment-order">
                        <div class="menu-item-icon" style="background:#e8f5e9">üí∞</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–ª–∞—Ç—ë–∂–Ω–æ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ</div>
                            <div class="menu-item-subtitle">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–ª–∞—Ç—ë–∂</div>
                        </div>
                    </div>
                    <div class="menu-item" data-submenu="accounting-reports">
                        <div class="menu-item-icon" style="background:#fff3e0">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û—Ç—á—ë—Ç—ã</div>
                            <div class="menu-item-subtitle">–ë–∞–ª–∞–Ω—Å—ã, —Å–ø—Ä–∞–≤–∫–∏</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <!-- –†–∞—Å–∫—Ä—ã—Ç—ã–µ –æ—Ç—á—ë—Ç—ã -->
                    <div class="reports-expanded" data-parent="accounting-reports" style="padding-left:58px;padding-top:5px;display:none">
                        <div class="menu-item" data-report="balance" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">‚öñÔ∏è</span>–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å</div>
                        <div class="menu-item" data-report="profit-loss" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìà</span>–û—Ç—á—ë—Ç –æ —Ñ–∏–Ω. —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö</div>
                        <div class="menu-item" data-report="target-use" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üéØ</span>–û—Ç—á—ë—Ç –æ —Ü–µ–ª–µ–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏</div>
                        <div class="menu-item" data-report="accounting-certificate" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìÑ</span>–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞</div>
                    </div>
                </div>

                <!-- üìô –ù–ê–õ–û–ì–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">üìô –ù–∞–ª–æ–≥–∏</div>
                    <div class="menu-item" data-report="kudir">
                        <div class="menu-item-icon" style="background:#fff3e0">üìñ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–£–î–∏–†</div>
                            <div class="menu-item-subtitle">–ö–Ω–∏–≥–∞ —É—á—ë—Ç–∞</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="usn-declaration">
                        <div class="menu-item-icon" style="background:#fff3e0">üìã</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù</div>
                            <div class="menu-item-subtitle">–ù–∞–ª–æ–≥–æ–≤–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="act-sverka">
                        <div class="menu-item-icon" style="background:#f5f5f5">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ê–∫—Ç —Å–≤–µ—Ä–∫–∏</div>
                            <div class="menu-item-subtitle">–°–≤–µ—Ä–∫–∞ —Å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏</div>
                        </div>
                    </div>
                    <div class="menu-item" data-submenu="zero-reporting">
                        <div class="menu-item-icon" style="background:#f5f5f5">‚àÖ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ù—É–ª–µ–≤–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å</div>
                            <div class="menu-item-subtitle">–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <!-- –†–∞—Å–∫—Ä—ã—Ç—ã–µ –æ—Ç—á—ë—Ç—ã -->
                    <div class="reports-expanded" data-parent="zero-reporting" style="padding-left:58px;padding-top:5px;display:none">
                        <div class="menu-item" data-action="generate-usn-zero" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìã</span>–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù</div>
                        <div class="menu-item" data-action="generate-balance-zero" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">‚öñÔ∏è</span>–ë–∞–ª–∞–Ω—Å</div>
                        <div class="menu-item" data-action="generate-szv-zero" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìä</span>–°–ó–í-–°–¢–ê–ñ</div>
                        <div class="menu-item" data-action="generate-rsv-zero" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìä</span>–†–°–í</div>
                        <div class="menu-item" data-action="generate-sredn-zero" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üë•</span>–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è</div>
                    </div>
                </div>

                <!-- üìó –£–ü–†–ê–í–õ–ï–ù–ß–ï–°–ö–ò–ô –£–ß–Å–¢ -->
                <div class="menu-section">
                    <div class="menu-section-title">üìó –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á—ë—Ç</div>
                    <div class="menu-item" data-submenu="analytics">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìà</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
                            <div class="menu-item-subtitle">–û—Ç—á—ë—Ç—ã, –≥—Ä–∞—Ñ–∏–∫–∏</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <!-- –†–∞—Å–∫—Ä—ã—Ç—ã–µ –æ—Ç—á—ë—Ç—ã -->
                    <div class="reports-expanded" data-parent="analytics" style="padding-left:58px;padding-top:5px;display:none">
                        <div class="menu-item" data-report="members-report-full" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìã</span>–†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤</div>
                        <div class="menu-item" data-report="payments-report-full" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üí≥</span>–û—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º</div>
                        <div class="menu-item" data-report="financial-report-full" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìà</span>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç</div>
                        <div class="menu-item" data-report="debt-report" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">‚ö†Ô∏è</span>–û—Ç—á—ë—Ç –æ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö</div>
                    </div>
                    <div class="menu-item" data-submenu="funds">
                        <div class="menu-item-icon" style="background:#e8f5e9">üí∞</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–§–æ–Ω–¥—ã</div>
                            <div class="menu-item-subtitle">–û—Ç—á—ë—Ç—ã –ø–æ —Ñ–æ–Ω–¥–∞–º</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <!-- –†–∞—Å–∫—Ä—ã—Ç—ã–µ –æ—Ç—á—ë—Ç—ã –ø–æ —Ñ–æ–Ω–¥–∞–º -->
                    <div class="reports-expanded" data-parent="funds" style="padding-left:58px;padding-top:5px;display:none">
                        <div class="menu-item" data-report="share-fund" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üí∞</span>–ü–∞–µ–≤–æ–π —Ñ–æ–Ω–¥</div>
                        <div class="menu-item" data-report="development-fund" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üöÄ</span>–§–æ–Ω–¥ —Ä–∞–∑–≤–∏—Ç–∏—è</div>
                        <div class="menu-item" data-report="business-fund" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üè¢</span>–§–æ–Ω–¥ —Ö–æ–∑. –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</div>
                        <div class="menu-item" data-report="funds-analytics" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìä</span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ñ–æ–Ω–¥–æ–≤</div>
                        <div class="menu-item" data-report="indivisible-fund" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üèõÔ∏è</span>–ù–µ–¥–µ–ª–∏–º—ã–π —Ñ–æ–Ω–¥</div>
                        <div class="menu-item" data-report="reserve-fund" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üõ°Ô∏è</span>–†–µ–∑–µ—Ä–≤–Ω—ã–π —Ñ–æ–Ω–¥</div>
                    </div>
                    <div class="menu-item" data-submenu="meetings">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–°–æ–±—Ä–∞–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <!-- –†–∞—Å–∫—Ä—ã—Ç—ã–µ –æ—Ç—á—ë—Ç—ã -->
                    <div class="reports-expanded" data-parent="meetings" style="padding-left:58px;padding-top:5px;display:none">
                        <div class="menu-item" data-action="create-meeting" style="padding:8px 12px;font-size:12px;cursor:pointer;background:#e8f5e9;border-radius:4px;margin-bottom:8px"><span style="margin-right:8px">‚ûï</span>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª</div>
                        <div class="menu-item" data-report="meeting-protocol-full" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìù</span>–ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–±—Ä–∞–Ω–∏—è</div>
                        <div class="menu-item" data-report="attendance-list-full" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">‚úçÔ∏è</span>–õ–∏—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                    </div>
                    <div class="menu-item" data-submenu="control">
                        <div class="menu-item-icon" style="background:#e8f5e9">‚è∞</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–æ–Ω—Ç—Ä–æ–ª—å</div>
                            <div class="menu-item-subtitle">–°—Ä–æ–∫–∏, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <!-- –†–∞—Å–∫—Ä—ã—Ç—ã–µ –æ—Ç—á—ë—Ç—ã -->
                    <div class="reports-expanded" data-parent="control" style="padding-left:58px;padding-top:5px;display:none">
                        <div class="menu-item" data-action="add-calendar-event" style="padding:8px 12px;font-size:12px;cursor:pointer;background:#e8f5e9;border-radius:4px;margin-bottom:8px"><span style="margin-right:8px">‚ûï</span>–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</div>
                        <div class="menu-item" data-report="calendar-full" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">üìÖ</span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</div>
                        <div class="menu-item" data-report="control-dashboard" style="padding:8px 12px;font-size:12px;cursor:pointer"><span style="margin-right:8px">‚è∞</span>–ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤</div>
                    </div>
                </div>

                <!-- üìÅ –î–û–ö–£–ú–ï–ù–¢–´ -->
                <div class="menu-section">
                    <div class="menu-section-title">üìÅ –î–æ–∫—É–º–µ–Ω—Ç—ã</div>
                    <div class="menu-item" data-action="create-document">
                        <div class="menu-item-icon" style="background:#f5f7fa">üìÅ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</div>
                            <div class="menu-item-subtitle">–ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="invoice">
                        <div class="menu-item-icon" style="background:#f5f7fa">üìÑ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–°—á—ë—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É</div>
                            <div class="menu-item-subtitle">–í—ã—Å—Ç–∞–≤–∏—Ç—å —Å—á—ë—Ç</div>
                        </div>
                    </div>
                </div>

                <!-- üìã –ó–ê–Ø–í–õ–ï–ù–ò–Ø -->
                <div class="menu-section">
                    <div class="menu-section-title">üìã –ó–∞—è–≤–ª–µ–Ω–∏—è</div>
                    <div class="menu-item" data-action="create-application">
                        <div class="menu-item-icon" style="background:#fce4ec">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ</div>
                            <div class="menu-item-subtitle">–ù–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="applications-registry">
                        <div class="menu-item-icon" style="background:#fce4ec">üìã</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–µ—Å—Ç—Ä –∑–∞—è–≤–ª–µ–Ω–∏–π</div>
                            <div class="menu-item-subtitle">–í—Å–µ –∑–∞—è–≤–ª–µ–Ω–∏—è</div>
                        </div>
                    </div>
                </div>

                <!-- ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                    <div class="menu-item" data-panel="profile">
                        <div class="menu-item-icon" style="background:#e0e0e0">üë§</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü—Ä–æ—Ñ–∏–ª—å</div>
                            <div class="menu-item-subtitle">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="toggleDarkMode()">
                        <div class="menu-item-icon" style="background:#e0e0e0">üåì</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–¢—ë–º–Ω–∞—è —Ç–µ–º–∞</div>
                            <div class="menu-item-subtitle">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="exportMembersToExcel()">
                        <div class="menu-item-icon" style="background:#e0e0e0">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</div>
                            <div class="menu-item-subtitle">–í—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
                        </div>
                    </div>
                    <div class="menu-item" data-panel="backup">
                        <div class="menu-item-icon" style="background:#e0e0e0">üíæ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                            <div class="menu-item-subtitle">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TOAST –ö–û–ù–¢–ï–ô–ù–ï–† -->
        <div class="toast-container" id="toastContainer"></div>

        <!-- INDOCTOR –ó–ê–ì–†–£–ó–ö–ò -->
        <div class="loader-overlay" id="loaderOverlay">
            <div class="loader"></div>
        </div>

        <!-- –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í -->
        <div class="reports-submenu" id="reportsSubmenu">
            <div class="submenu-header">
                <button class="submenu-back-btn" id="submenuBackBtn">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="submenu-title" id="submenuTitle">–û—Ç—á–µ—Ç—ã</div>
                <div style="width:80px"></div>
            </div>
            <div class="submenu-content" id="submenuContent"></div>
        </div>
        
        <!-- –°–ü–ò–°–û–ö –ß–ê–¢–û–í - –í–°–ï–ì–î–ê –ù–ê –ú–ï–°–¢–ï -->
        <div class="chats-panel" id="chatsPanel">
            <div class="chats-header">
                <button class="burger-btn" id="burgerBtn" data-tooltip="–ú–µ–Ω—é (Ctrl+M)">‚ò∞</button>
                <div class="cooperative-info">
                    <div class="cooperative-name">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
                    <div class="cooperative-stats">12 –ø–∞–π—â–∏–∫–æ–≤ ‚Ä¢ 9 –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                </div>
            </div>
            <div class="search-section">
                <div class="search-box">
                    <span>üîç</span>
                    <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–∞–π—â–∏–∫–æ–≤..." id="searchInput">
                </div>
                <div class="quick-filters">
                    <button class="filter-chip active">–í—Å–µ</button>
                    <button class="filter-chip">üî¥ –î–æ–ª–∂–Ω–∏–∫–∏</button>
                    <button class="filter-chip">üü¢ –ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                </div>
            </div>
            <div class="chats-list" id="chatsList"></div>
        </div>
        
        <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ -->
        <div class="main-chat">
            <div class="chat-header">
                <div class="chat-header-left">
                    <button class="header-action-btn" id="massSelectBtn" title="–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏" style="margin-right:10px">‚òëÔ∏è</button>
                    <div class="chat-header-avatar" id="currentAvatar">–ò–ò</div>
                    <div>
                        <div class="chat-header-name" id="currentName">–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</div>
                        <div class="chat-header-status">‚óè –ê–∫—Ç–∏–≤–µ–Ω</div>
                    </div>
                </div>
                <div class="chat-header-actions">
                    <button class="header-action-btn" title="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">üìû</button>
                    <button class="header-action-btn" title="Email">‚úâÔ∏è</button>
                    <button class="menu-more-btn" id="menuMoreBtn" title="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" data-tooltip="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–π—â–∏–∫–µ">‚ãÆ</button>
                </div>
            </div>
            <div class="messages-container" id="messagesContainer"></div>
            <div class="message-input-wrapper">
                <div class="message-input-area">
                    <button class="attach-btn">üìé</button>
                    <input type="text" class="message-input" placeholder="–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é..." id="messageInput">
                    <button class="voice-btn">üé§</button>
                    <button class="send-button" id="sendButton">‚û§</button>
                </div>
            </div>
        </div>
        
        <!-- –ë–û–õ–¨–®–ê–Ø –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–æ—Ç—á–µ—Ç—ã) -->
        <div class="large-report-panel" id="largeReportPanel">
            <div class="large-report-header">
                <div class="large-report-title" id="largeReportTitle">–û—Ç—á–µ—Ç</div>
                <button class="close-large-report-btn" id="closeLargeReportBtn">‚úï</button>
            </div>
            <div class="large-report-content" id="largeReportContent"></div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ) -->
        <div class="sidebar-right" id="sidebarRight">
            <div class="member-info-header">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–π—â–∏–∫–µ</h3>
                <button class="close-info-btn" id="closeInfoBtn">‚úï</button>
            </div>
            <div class="member-info-content" id="memberInfoContent"></div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏) -->
        <div class="operation-details-panel" id="operationDetailsPanel">
            <div class="details-header">
                <h3 id="detailsTitle">–î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                <button class="close-details-btn" id="closeDetailsBtn">‚úï</button>
            </div>
            <div class="details-content" id="detailsContent"></div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∫–æ–Ω—Ç–µ–Ω—Ç –ª–µ–≤–æ–≥–æ –º–µ–Ω—é) -->
        <div class="menu-content-panel" id="menuContentPanel">
            <div class="menu-panel-header">
                <h3 id="menuPanelTitle">–†–∞–∑–¥–µ–ª</h3>
                <button class="close-panel-btn" id="closePanelBtn">‚úï</button>
            </div>
            <div class="menu-panel-content" id="menuPanelContent"></div>
        </div>
        
        <!-- FAB –ö–ù–û–ü–ö–ê -->
        <div class="fab-container" id="fabContainer">
            <div class="fab-menu" id="fabMenu">
                <div class="fab-item" data-action="application">
                    <div class="fab-item-btn" style="background:#f44336">ÔøΩÔøΩ</div>
                    <span class="fab-item-label">–ó–∞—è–≤–ª–µ–Ω–∏–µ</span>
                </div>
                <div class="fab-item" data-action="document">
                    <div class="fab-item-btn" style="background:#9c27b0">üìÅ</div>
                    <span class="fab-item-label">–î–æ–∫—É–º–µ–Ω—Ç</span>
                </div>
                <div class="fab-item" data-action="transaction">
                    <div class="fab-item-btn" style="background:#ff9800">üìí</div>
                    <span class="fab-item-label">–ü—Ä–æ–≤–æ–¥–∫–∞</span>
                </div>
                <div class="fab-item" data-action="payment">
                    <div class="fab-item-btn" style="background:#2196f3">üí≥</div>
                    <span class="fab-item-label">–í–∑–Ω–æ—Å</span>
                </div>
                <div class="fab-item" data-action="member">
                    <div class="fab-item-btn" style="background:#4caf50">üë§</div>
                    <span class="fab-item-label">–ü–∞–π—â–∏–∫</span>
                </div>
            </div>
            <button class="fab-main" id="fabMain">+</button>
        </div>
    </div>

    <!-- –ü–ê–ù–ï–õ–¨ –ú–ê–°–°–û–í–´–• –û–ü–ï–†–ê–¶–ò–ô -->
    <div class="mass-actions-panel" id="massActionsPanel">
        <span class="mass-count" id="massCount">0 –≤—ã–±—Ä–∞–Ω–æ</span>
        <button onclick="massExport()">üìä –≠–∫—Å–ø–æ—Ä—Ç</button>
        <button onclick="massMessage()">‚úâÔ∏è –°–æ–æ–±—â–µ–Ω–∏–µ</button>
        <button onclick="clearMassSelection()">‚úï –°–±—Ä–æ—Å</button>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <!-- –°–Ω–∞—á–∞–ª–∞ Yandex Disk (–¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –ü–ï–†–ï–î messenger-app-v2.js) -->
    <script src="yandex-disk-integration-v2.js?v=2026021823"></script>
    
    <!-- –ü–æ—Ç–æ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="app.js?v=2026021823"></script>
    <script src="application_functions.js?v=2026021823"></script>
    <script src="reports.js?v=2026021823"></script>
    <script src="settings.js?v=2026021823"></script>
    <script src="messenger-app-v2.js?v=2026021823"></script>
    <script src="pdf_export.js?v=2026021823"></script>
    
    <!-- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞ –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫–∞ -->
    <script>
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'YANDEX_TOKEN') {
                if (window.handleYandexToken) {
                    window.handleYandexToken(event.data.token);
                }
            }
        });
        
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('access_token');
        if (token) {
            if (window.handleYandexToken) {
                window.handleYandexToken(token);
            }
            window.history.replaceState({}, document.title, window.location.pathname);
        }
    </script>
    
    <!-- PANEL MANAGER & TELEGRAM INIT -->
    <script>
        // ============================================
        // TELEGRAM WEBAPP INIT
        // ============================================
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É Telegram
        function applyTelegramTheme() {
            document.documentElement.style.setProperty('--tg-theme-bg-color', tg.backgroundColor || '#ffffff');
            document.documentElement.style.setProperty('--tg-theme-text-color', tg.textColor || '#000000');
            document.documentElement.style.setProperty('--tg-theme-hint-color', tg.hintColor || '#999999');
            document.documentElement.style.setProperty('--tg-theme-button-color', tg.buttonColor || '#2481cc');
            document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.buttonTextColor || '#ffffff');
            document.documentElement.style.setProperty('--tg-theme-secondary-bg-color', tg.secondaryBackgroundColor || '#f0f2f5');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞ —Ö–µ–¥–µ—Ä–∞
            tg.setHeaderColor(tg.themeParams.bg_color || '#ffffff');
            tg.setBottomBarColor(tg.themeParams.secondary_bg_color || '#f0f2f5');
        }

        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        applyTelegramTheme();

        // –°–ª—É—à–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
        tg.onEvent('themeChanged', () => {
            applyTelegramTheme();
        });

        // ============================================
        // –Ø–ù–î–ï–ö–°.–î–ò–°–ö - –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ============================================
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞
        async function initYandexDiskAuto() {
            try {
                console.log('[Yandex] –ù–∞—á–∞–ª–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏...');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω
                const token = localStorage.getItem('yandexDiskToken');
                
                if (token) {
                    console.log('[Yandex] –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...');
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞
                    if (typeof loadAllDataFromYandex === 'function') {
                        const result = await loadAllDataFromYandex();
                        if (result) {
                            console.log('[Yandex] –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º UI
                            if (typeof updateYandexDiskIndicator === 'function') {
                                updateYandexDiskIndicator();
                            }
                            
                            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
                            if (typeof startAutoSaveYandex === 'function') {
                                startAutoSaveYandex();
                            }
                        }
                    }
                } else {
                    console.log('[Yandex] –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω. –û–∂–∏–¥–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...');
                }
                
            } catch (error) {
                console.error('[Yandex] –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error.message);
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                initYandexDiskAuto();
            }, 500);
        });

        // ============================================
        // –û–ë–†–ê–ë–û–¢–ö–ê –¢–û–ö–ï–ù–ê –ü–û–°–õ–ï –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
        // ============================================
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∏–∑ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞ (–ø–æ—Å–ª–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞)
        function handleYandexCallback() {
            const urlParams = new URLSearchParams(window.location.search);
            const hash = window.location.hash;
            
            let token = null;
            
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ hash
            if (hash && hash.includes('access_token')) {
                const hashParams = new URLSearchParams(hash.substring(1));
                token = hashParams.get('access_token');
            }
            
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ search
            if (!token && urlParams.get('access_token')) {
                token = urlParams.get('access_token');
            }
            
            if (token) {
                console.log('[Yandex] –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω –∏–∑ URL');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω
                localStorage.setItem('yandexDiskToken', token);
                
                // –û—á–∏—â–∞–µ–º URL
                window.history.replaceState({}, document.title, window.location.pathname);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                if (typeof showToast === 'function') {
                    showToast({
                        type: 'success',
                        message: '‚úì –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω!',
                        duration: 5000
                    });
                }
                
                // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
                if (window.TelegramMiniApp) {
                    window.TelegramMiniApp.hapticFeedback('success');
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                setTimeout(() => {
                    initYandexDiskAuto();
                }, 1000);
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç callback –æ–∫–Ω–∞
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'YANDEX_TOKEN') {
                const token = event.data.token;
                if (token) {
                    console.log('[Yandex] –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω –∏–∑ postMessage');
                    
                    localStorage.setItem('yandexDiskToken', token);
                    
                    if (typeof showToast === 'function') {
                        showToast({
                            type: 'success',
                            message: '‚úì –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω!',
                            duration: 5000
                        });
                    }
                    
                    if (window.TelegramMiniApp) {
                        window.TelegramMiniApp.hapticFeedback('success');
                    }
                    
                    setTimeout(() => {
                        initYandexDiskAuto();
                    }, 1000);
                }
            }
        });

        // –í—ã–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(() => {
                handleYandexCallback();
            }, 500);
        });

        // ============================================
        // –Ø–ù–î–ï–ö–°.–î–ò–°–ö –§–£–ù–ö–¶–ò–ò
        // ============================================

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫—É
        function handleYandexDiskClick() {
            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –¥–ª—è Telegram
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('light');
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const token = localStorage.getItem('yandexDiskToken');
            const disabled = localStorage.getItem('yandexDiskDisabled') === 'true';

            if (disabled || !token) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                showYandexDiskModal();
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                showYandexDiskMenu();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        function showYandexDiskModal() {
            const content = `
                <div style="padding:40px;text-align:center;max-width:500px;margin:0 auto">
                    <div style="font-size:64px;margin-bottom:20px">‚òÅÔ∏è</div>
                    <h2 style="margin-bottom:10px;font-size:22px;font-weight:600">–Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫</h2>
                    <p style="color:#666;margin-bottom:30px;line-height:1.5">
                        –î–ª—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫—É.
                        –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –ø–∞–ø–∫—É "–ö–û–û–ü–ï–†–ê–ù–¢".
                    </p>
                    <div style="display:flex;flex-direction:column;gap:12px;margin-bottom:20px">
                        <button onclick="connectYandexDiskFromIndex()"
                                style="min-height:44px;padding:12px 24px;background:#fc0;color:#000;border:none;border-radius:12px;cursor:pointer;font-size:15px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:10px">
                            <span style="font-size:20px">‚òÅÔ∏è</span>
                            –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å
                        </button>
                        <button onclick="useLocalStorageFromIndex()"
                                style="min-height:44px;padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:12px;cursor:pointer;font-size:15px">
                            –†–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫–∞
                        </button>
                    </div>
                    <p style="font-size:12px;color:#999;margin-top:20px">
                        üîí –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                    </p>
                </div>
            `;
            showModalYandex(content);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        function showYandexDiskMenu() {
            const content = `
                <div style="padding:30px;max-width:500px;margin:0 auto">
                    <div style="display:flex;align-items:center;gap:15px;margin-bottom:25px">
                        <div style="font-size:48px">‚òÅÔ∏è</div>
                        <div>
                            <h2 style="margin:0;font-size:20px;font-weight:600">–Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫</h2>
                            <p style="margin:5px 0 0;color:#666;font-size:14px">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</p>
                        </div>
                    </div>
                    <div style="background:#f5f7fa;border-radius:12px;padding:20px;margin-bottom:20px">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px">
                            <span style="font-size:14px;color:#666">–°—Ç–∞—Ç—É—Å</span>
                            <span style="display:flex;align-items:center;gap:8px">
                                <span class="yandex-indicator" style="width:10px;height:10px;display:inline-block"></span>
                                <span style="font-weight:600;color:#4caf50">–ü–æ–¥–∫–ª—é—á—ë–Ω</span>
                            </span>
                        </div>
                        <div style="display:flex;justify-content:space-between;align-items:center">
                            <span style="font-size:14px;color:#666">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</span>
                            <span style="font-size:14px;font-weight:500;color:#4caf50">–í–∫–ª—é—á–µ–Ω–æ (30 —Å–µ–∫)</span>
                        </div>
                    </div>
                    <div style="display:flex;flex-direction:column;gap:10px">
                        <button onclick="forceSyncFromIndex()" style="min-height:44px;padding:12px;background:#0088cc;color:#fff;border:none;border-radius:12px;cursor:pointer;font-size:15px;font-weight:600">
                            üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å
                        </button>
                        <button onclick="createBackupFromIndex()" style="min-height:44px;padding:12px;background:#4caf50;color:#fff;border:none;border-radius:12px;cursor:pointer;font-size:15px;font-weight:600">
                            üíæ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
                        </button>
                        <button onclick="logoutYandexFromIndex()" style="min-height:44px;padding:12px;background:#ffebee;color:#c62828;border:none;border-radius:12px;cursor:pointer;font-size:15px">
                            üö™ –í—ã–π—Ç–∏ –∏–∑ –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫–∞
                        </button>
                        <button onclick="closeModalYandex()" style="min-height:44px;padding:12px;background:#f5f7fa;color:#333;border:none;border-radius:12px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            showModalYandex(content);
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        window.connectYandexDiskFromIndex = async function() {
            if (typeof window.connectYandexDisk === 'function') {
                await window.connectYandexDisk();
            }
            closeModalYandex();
        };

        window.useLocalStorageFromIndex = function() {
            localStorage.setItem('yandexDiskDisabled', 'true');
            updateYandexDiskIndicator();
            closeModalYandex();
        };

        window.forceSyncFromIndex = async function() {
            if (typeof window.forceSyncYandex === 'function') {
                await window.forceSyncYandex();
            }
            closeModalYandex();
        };

        window.createBackupFromIndex = async function() {
            if (typeof window.createBackupYandex === 'function') {
                await window.createBackupYandex();
            }
            closeModalYandex();
        };

        window.logoutYandexFromIndex = function() {
            if (typeof window.logoutYandexDisk === 'function') {
                window.logoutYandexDisk();
                updateYandexDiskIndicator();
            }
            closeModalYandex();
        };

        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞
        function updateYandexDiskIndicator() {
            const indicator = document.getElementById('yandexIndicator');
            const text = document.getElementById('yandexDiskText');
            if (!indicator || !text) return;

            const token = localStorage.getItem('yandexDiskToken');
            const folderId = localStorage.getItem('yandexCooperativFolderId');
            const disabled = localStorage.getItem('yandexDiskDisabled') === 'true';

            if (disabled || !token || !folderId) {
                indicator.className = 'yandex-indicator disconnected';
                text.textContent = '–Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫ (–æ—Ç–∫–ª—é—á—ë–Ω)';
            } else {
                indicator.className = 'yandex-indicator';
                text.textContent = '–Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫';
            }
        }

        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function showModalYandex(content) {
            const existing = document.querySelector('.yandex-modal-overlay');
            if (existing) existing.remove();

            const overlay = document.createElement('div');
            overlay.className = 'yandex-modal-overlay';
            overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:10000;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.2s ease;';

            const modal = document.createElement('div');
            modal.style.cssText = 'background:#fff;border-radius:16px;max-width:90%;max-height:90%;overflow-y:auto;animation:slideUp 0.3s ease;';
            modal.innerHTML = content;

            overlay.appendChild(modal);
            document.body.appendChild(overlay);

            overlay.addEventListener('click', e => {
                if (e.target === overlay) closeModalYandex();
            });

            window.currentYandexModal = overlay;
        }

        function closeModalYandex() {
            if (window.currentYandexModal) {
                window.currentYandexModal.style.animation = 'fadeOut 0.2s ease';
                setTimeout(() => {
                    window.currentYandexModal.remove();
                    window.currentYandexModal = null;
                }, 200);
            }
        }

        // CSS –∞–Ω–∏–º–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
            @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
            @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        `;
        document.head.appendChild(style);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        setTimeout(updateYandexDiskIndicator, 1000);

        // ============================================
        // PANEL MANAGER
        // ============================================
        const PanelManager = {
            currentPanel: null,
            overlay: null,  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∑–∂–µ
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            init() {
                this.overlay = document.getElementById('panelOverlay');
                if (this.overlay) {
                    this.overlay.addEventListener('click', () => {
                        this.closeAll();
                    });
                }
            },

            open(panelId) {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if (!this.overlay) this.init();
                
                // –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–∞–Ω–µ–ª–∏
                this.closeAll();

                // –û—Ç–∫—Ä—ã—Ç—å –Ω—É–∂–Ω—É—é
                const panel = document.getElementById(panelId);
                if (panel) {
                    panel.classList.add('visible');
                    if (this.overlay) {
                        this.overlay.classList.add('active');
                    }
                    this.currentPanel = panelId;

                    // Haptic feedback
                    if (tg.HapticFeedback) {
                        tg.HapticFeedback.impactOccurred('light');
                    }
                }
            },

            close(panelId) {
                const panel = document.getElementById(panelId);
                if (panel) {
                    panel.classList.remove('visible');

                    // –ï—Å–ª–∏ —ç—Ç–æ –±—ã–ª–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–∞–Ω–µ–ª—å, —Å–∫—Ä—ã—Ç—å overlay
                    if (!document.querySelector('.panel.visible')) {
                        if (this.overlay) {
                            this.overlay.classList.remove('active');
                        }
                    }

                    this.currentPanel = null;
                }
            },

            closeAll() {
                document.querySelectorAll('.panel.visible').forEach(panel => {
                    panel.classList.remove('visible');
                });
                if (this.overlay) {
                    this.overlay.classList.remove('active');
                }
                this.currentPanel = null;
            }
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º PanelManager
        PanelManager.init();
        
        // ============================================
        // SWIPE GESTURES
        // ============================================
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });
        
        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, { passive: true });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ ‚Üí –∑–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å
            if (diff < -swipeThreshold && PanelManager.currentPanel) {
                PanelManager.closeAll();
                if (tg.HapticFeedback) {
                    tg.HapticFeedback.impactOccurred('medium');
                }
            }
        }
        
        // ============================================
        // –§–£–ù–ö–¶–ò–ò –û–ë–†–ê–ë–û–¢–ö–ò –ú–ï–ù–Æ (–ì–õ–û–ë–ê–õ–¨–ù–´–ï)
        // ============================================
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Ç—á—ë—Ç–∞ –ø–æ –∏–º–µ–Ω–∏
        window.openReportByName = function(reportName) {
            console.log('üìä –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Ç—á—ë—Ç–∞:', reportName);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤
            switch(reportName) {
                case 'members-registry-full':
                    showMembersRegistryReport();
                    break;
                    
                case 'calendar-full':
                    showCalendarReport();
                    break;
                    
                case 'payments-report-full':
                    showPaymentsReport();
                    break;
                    
                case 'balance':
                    showBalanceReport();
                    break;
                    
                case 'osv':
                    showOSVReport();
                    break;
                    
                case 'kudir':
                    showKUDiRReport();
                    break;
                    
                case 'profit-loss':
                    showProfitLossReport();
                    break;
                    
                default:
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤
                    if (typeof window.showToast === 'function') {
                        window.showToast({
                            type: 'info',
                            message: '–û—Ç—á—ë—Ç "' + reportName + '" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ',
                            duration: 3000
                        });
                    } else {
                        alert('–û—Ç—á—ë—Ç: ' + reportName + ' (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)');
                    }
            }
        };
        
        // ============================================
        // –û–¢–ß–Å–¢: –†–ï–ï–°–¢–† –ü–ê–ô–©–ò–ö–û–í
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤
        window.showMembersRegistryReport = function() {
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            
            let tableHTML = '';
            
            if (members.length === 0) {
                tableHTML = '<div style="padding:40px;text-align:center;color:#999">üì≠ –°–ø–∏—Å–æ–∫ –ø–∞–π—â–∏–∫–æ–≤ –ø—É—Å—Ç</div>';
            } else {
                tableHTML = `
                    <table style="width:100%;border-collapse:collapse;font-size:14px">
                        <thead>
                            <tr style="background:#f5f7fa">
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">‚Ññ</th>
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">–§–ò–û</th>
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">Email</th>
                                <th style="padding:12px;text-align:right;border-bottom:2px solid #ddd">–í–∑–Ω–æ—Å (‚ÇΩ)</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #ddd">–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                members.forEach((member, index) => {
                    tableHTML += `
                        <tr style="border-bottom:1px solid #eee">
                            <td style="padding:12px;color:#999">${index + 1}</td>
                            <td style="padding:12px;font-weight:500">${member.name || '‚Äî'}</td>
                            <td style="padding:12px;color:#666">${member.phone || '‚Äî'}</td>
                            <td style="padding:12px;color:#666">${member.email || '‚Äî'}</td>
                            <td style="padding:12px;text-align:right;font-weight:600;color:#0088cc">${(member.entranceFee || 0).toLocaleString()}</td>
                            <td style="padding:12px;text-align:center">
                                <button onclick="editMember(${member.id})" 
                                        style="padding:6px 12px;background:#2196f3;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:12px;margin-right:4px"
                                        title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                    ‚úèÔ∏è
                                </button>
                                <button onclick="deleteMember(${member.id})" 
                                        style="padding:6px 12px;background:#f44336;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:12px"
                                        title="–£–¥–∞–ª–∏—Ç—å">
                                    üóëÔ∏è
                                </button>
                            </td>
                        </tr>
                    `;
                });
                
                tableHTML += `
                        </tbody>
                        <tfoot>
                            <tr style="background:#f5f7fa;font-weight:600">
                                <td colspan="4" style="padding:12px;text-align:right">–ò—Ç–æ–≥–æ:</td>
                                <td style="padding:12px;text-align:right;color:#0088cc">${members.reduce((sum, m) => sum + (m.entranceFee || 0), 0).toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;text-align:center">${members.length} —á–µ–ª.</td>
                            </tr>
                        </tfoot>
                    </table>
                `;
            }
            
            const content = `
                <div style="padding:30px;max-width:900px;margin:0 auto">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                        <h2 style="font-size:20px;font-weight:600">üìã –†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤</h2>
                        <button onclick="window.showCreateMemberModal()" 
                                style="padding:10px 20px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                    </div>
                    
                    ${tableHTML}
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()" 
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // ============================================
        // –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ü–ê–ô–©–ò–ö–ê
        // ============================================
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–π—â–∏–∫–∞
        window.editMember = function(memberId) {
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const member = members.find(m => m.id == memberId);
            
            if (!member) {
                alert('–ü–∞–π—â–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }
            
            const content = `
                <div style="padding:30px;max-width:600px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–π—â–∏–∫–∞</h2>
                    
                    <form id="editMemberForm" onsubmit="return handleEditMember(event, ${memberId})">
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–§–ò–û *</label>
                            <input type="text" name="name" required value="${member.name || ''}"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                            <input type="tel" name="phone" value="${member.phone || ''}"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">Email</label>
                            <input type="email" name="email" value="${member.email || ''}"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>
                        
                        <div style="margin-bottom:20px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å (‚ÇΩ)</label>
                            <input type="number" name="entranceFee" value="${member.entranceFee || 0}"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>
                        
                        <div style="display:flex;gap:10px;justify-content:flex-end">
                            <button type="button" onclick="closeModalYandex()" 
                                    style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="submit" 
                                    style="padding:12px 24px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:15px;font-weight:600">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        window.handleEditMember = function(event, memberId) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const index = members.findIndex(m => m.id == memberId);
            
            if (index === -1) {
                alert('–ü–∞–π—â–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return false;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            members[index].name = formData.get('name');
            members[index].phone = formData.get('phone');
            members[index].email = formData.get('email');
            members[index].entranceFee = parseFloat(formData.get('entranceFee')) || 0;
            members[index].updatedAt = new Date().toISOString();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º
            localStorage.setItem('members', JSON.stringify(members));
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModalYandex();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (typeof window.showToast === 'function') {
                window.showToast({
                    type: 'success',
                    message: `‚úÖ –ü–∞–π—â–∏–∫ "${members[index].name}" –æ–±–Ω–æ–≤–ª—ë–Ω!`,
                    duration: 3000
                });
            }
            
            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('success');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–µ—Å—Ç—Ä
            setTimeout(() => {
                window.showMembersRegistryReport();
            }, 500);
            
            return false;
        };
        
        // –£–¥–∞–ª–∏—Ç—å –ø–∞–π—â–∏–∫–∞
        window.deleteMember = function(memberId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–∞–π—â–∏–∫–∞? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                return;
            }
            
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const filtered = members.filter(m => m.id != memberId);
            
            if (filtered.length === members.length) {
                alert('–ü–∞–π—â–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º
            localStorage.setItem('members', JSON.stringify(filtered));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (typeof window.showToast === 'function') {
                window.showToast({
                    type: 'success',
                    message: '‚úÖ –ü–∞–π—â–∏–∫ —É–¥–∞–ª—ë–Ω',
                    duration: 3000
                });
            }
            
            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('success');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–µ—Å—Ç—Ä
            setTimeout(() => {
                window.showMembersRegistryReport();
            }, 500);
        };
        
        // ============================================
        // –û–¢–ß–Å–¢: –ö–ê–õ–ï–ù–î–ê–†–¨ –°–û–ë–´–¢–ò–ô
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π
        window.showCalendarReport = function() {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
            const today = new Date();
            const currentMonth = today.toLocaleString('ru', { month: 'long', year: 'numeric' });
            
            // –ü—Ä–∏–º–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π
            const events = [
                { date: '01.03.2026', title: '–û–±—â–µ–µ —Å–æ–±—Ä–∞–Ω–∏–µ –ø–∞–π—â–∏–∫–æ–≤', type: 'meeting' },
                { date: '05.03.2026', title: '–°—Ä–æ–∫ —É–ø–ª–∞—Ç—ã —á–ª–µ–Ω—Å–∫–∏—Ö –≤–∑–Ω–æ—Å–æ–≤', type: 'payment' },
                { date: '10.03.2026', title: '–ó–∞—Å–µ–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–ª–µ–Ω–∏—è', type: 'meeting' },
                { date: '15.03.2026', title: '–°—Ä–æ–∫ –ø–æ–¥–∞—á–∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏', type: 'report' },
                { date: '20.03.2026', title: '–í—ã–ø–ª–∞—Ç–∞ –¥–∏–≤–∏–¥–µ–Ω–¥–æ–≤', type: 'payment' },
                { date: '28.03.2026', title: '–°—Ä–æ–∫ —É–ø–ª–∞—Ç—ã –£–°–ù', type: 'tax' },
                { date: '31.03.2026', title: '–ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç', type: 'report' }
            ];
            
            const typeColors = {
                meeting: '#0088cc',
                payment: '#4caf50',
                report: '#ff9800',
                tax: '#f44336'
            };
            
            const typeLabels = {
                meeting: 'üìã –°–æ–±—Ä–∞–Ω–∏–µ',
                payment: 'üí≥ –ü–ª–∞—Ç—ë–∂',
                report: 'üìä –û—Ç—á—ë—Ç',
                tax: 'üí∞ –ù–∞–ª–æ–≥'
            };
            
            let eventsHTML = '';
            
            events.forEach(event => {
                eventsHTML += `
                    <div style="display:flex;align-items:center;padding:12px;border-bottom:1px solid #eee">
                        <div style="width:60px;text-align:center;font-weight:600;color:#0088cc">${event.date.split('.')[0]}</div>
                        <div style="flex:1;padding-left:12px">
                            <div style="font-weight:500">${event.title}</div>
                            <div style="font-size:12px;color:#999;margin-top:4px">
                                <span style="display:inline-block;padding:2px 8px;background:${typeColors[event.type]}20;color:${typeColors[event.type]};border-radius:4px;font-size:11px">
                                    ${typeLabels[event.type]}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            const content = `
                <div style="padding:30px;max-width:700px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</h2>
                    
                    <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px">
                        <div style="font-size:16px;font-weight:600;text-align:center">üìÜ ${currentMonth}</div>
                    </div>
                    
                    <div style="border:1px solid #eee;border-radius:8px;overflow:hidden">
                        ${eventsHTML}
                    </div>
                    
                    <div style="margin-top:20px;display:flex;gap:10px;flex-wrap:wrap">
                        <div style="display:flex;align-items:center;gap:6px">
                            <span style="width:12px;height:12px;background:#0088cc20;border-radius:2px"></span>
                            <span style="font-size:12px">–°–æ–±—Ä–∞–Ω–∏–µ</span>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px">
                            <span style="width:12px;height:12px;background:#4caf5020;border-radius:2px"></span>
                            <span style="font-size:12px">–ü–ª–∞—Ç—ë–∂</span>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px">
                            <span style="width:12px;height:12px;background:#ff980020;border-radius:2px"></span>
                            <span style="font-size:12px">–û—Ç—á—ë—Ç</span>
                        </div>
                        <div style="display:flex;align-items:center;gap:6px">
                            <span style="width:12px;height:12px;background:#f4433620;border-radius:2px"></span>
                            <span style="font-size:12px">–ù–∞–ª–æ–≥</span>
                        </div>
                    </div>
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()" 
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // ============================================
        // –û–¢–ß–Å–¢: –û–¢–ß–Å–¢ –ü–û –í–ó–ù–û–°–ê–ú
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º
        window.showPaymentsReport = function() {
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Ç–∏–ø–∞–º
            const byType = {
                entrance: { label: '–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ', count: 0, sum: 0 },
                membership: { label: '–ß–ª–µ–Ω—Å–∫–∏–µ', count: 0, sum: 0 },
                share: { label: '–ü–∞–µ–≤—ã–µ', count: 0, sum: 0 },
                additional: { label: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ', count: 0, sum: 0 }
            };
            
            let totalSum = 0;
            
            payments.forEach(payment => {
                if (byType[payment.type]) {
                    byType[payment.type].count++;
                    byType[payment.type].sum += payment.amount;
                    totalSum += payment.amount;
                }
            });
            
            let rowsHTML = '';
            
            Object.keys(byType).forEach(key => {
                const item = byType[key];
                rowsHTML += `
                    <tr style="border-bottom:1px solid #eee">
                        <td style="padding:12px">${item.label}</td>
                        <td style="padding:12px;text-align:center">${item.count}</td>
                        <td style="padding:12px;text-align:right;font-weight:600;color:#0088cc">${item.sum.toLocaleString()} ‚ÇΩ</td>
                    </tr>
                `;
            });
            
            const content = `
                <div style="padding:30px;max-width:700px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">üí≥ –û—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º</h2>
                    
                    <table style="width:100%;border-collapse:collapse;font-size:14px;margin-bottom:20px">
                        <thead>
                            <tr style="background:#f5f7fa">
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">–¢–∏–ø –≤–∑–Ω–æ—Å–æ–≤</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #ddd">–ö–æ–ª-–≤–æ</th>
                                <th style="padding:12px;text-align:right;border-bottom:2px solid #ddd">–°—É–º–º–∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${rowsHTML}
                        </tbody>
                        <tfoot>
                            <tr style="background:#f5f7fa;font-weight:600">
                                <td style="padding:12px">–ò—Ç–æ–≥–æ:</td>
                                <td style="padding:12px;text-align:center">${payments.length}</td>
                                <td style="padding:12px;text-align:right;color:#0088cc">${totalSum.toLocaleString()} ‚ÇΩ</td>
                            </tr>
                        </tfoot>
                    </table>
                    
                    <div style="margin-top:20px">
                        <button onclick="showPaymentsList()" 
                                style="padding:10px 20px;background:#2196f3;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px">
                            üìã –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –≤–∑–Ω–æ—Å—ã
                        </button>
                    </div>
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()" 
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–∑–Ω–æ—Å–æ–≤
        window.showPaymentsList = function() {
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            
            let rowsHTML = '';
            
            if (payments.length === 0) {
                rowsHTML = '<tr><td colspan="7" style="padding:40px;text-align:center;color:#999">üì≠ –í–∑–Ω–æ—Å–æ–≤ –Ω–µ—Ç</td></tr>';
            } else {
                payments.forEach(payment => {
                    const typeLabels = {
                        entrance: '–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π',
                        membership: '–ß–ª–µ–Ω—Å–∫–∏–π',
                        share: '–ü–∞–µ–≤–æ–π',
                        additional: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π'
                    };
                    
                    rowsHTML += `
                        <tr style="border-bottom:1px solid #eee">
                            <td style="padding:12px">${payment.memberName || '‚Äî'}</td>
                            <td style="padding:12px">${typeLabels[payment.type] || payment.type}</td>
                            <td style="padding:12px;text-align:right;font-weight:600;color:#0088cc">${payment.amount.toLocaleString()} ‚ÇΩ</td>
                            <td style="padding:12px;text-align:center">${payment.date || '‚Äî'}</td>
                            <td style="padding:12px">${payment.description || '‚Äî'}</td>
                            <td style="padding:12px;text-align:center">
                                <button onclick="editPayment(${payment.id})" 
                                        style="padding:6px 12px;background:#2196f3;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:12px;margin-right:4px"
                                        title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                    ‚úèÔ∏è
                                </button>
                                <button onclick="deletePayment(${payment.id})" 
                                        style="padding:6px 12px;background:#f44336;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:12px"
                                        title="–£–¥–∞–ª–∏—Ç—å">
                                    üóëÔ∏è
                                </button>
                            </td>
                        </tr>
                    `;
                });
            }
            
            const content = `
                <div style="padding:30px;max-width:1000px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">üìã –í—Å–µ –≤–∑–Ω–æ—Å—ã</h2>
                    
                    <table style="width:100%;border-collapse:collapse;font-size:13px">
                        <thead>
                            <tr style="background:#f5f7fa">
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">–ü–∞–π—â–∏–∫</th>
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">–¢–∏–ø</th>
                                <th style="padding:12px;text-align:right;border-bottom:2px solid #ddd">–°—É–º–º–∞</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #ddd">–î–∞—Ç–∞</th>
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #ddd">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #ddd">–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${rowsHTML}
                        </tbody>
                    </table>
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()" 
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∑–Ω–æ—Å
        window.editPayment = function(paymentId) {
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            const payment = payments.find(p => p.id == paymentId);
            
            if (!payment) {
                alert('–í–∑–Ω–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }
            
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            
            let memberOptions = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞</option>';
            members.forEach(member => {
                const selected = member.id == payment.memberId ? 'selected' : '';
                memberOptions += `<option value="${member.id}" ${selected}>${member.name}</option>`;
            });
            
            const content = `
                <div style="padding:30px;max-width:600px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∑–Ω–æ—Å</h2>
                    
                    <form id="editPaymentForm" onsubmit="return handleEditPayment(event, ${paymentId})">
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–ü–∞–π—â–∏–∫ *</label>
                            <select name="memberId" required style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                                ${memberOptions}
                            </select>
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–¢–∏–ø –≤–∑–Ω–æ—Å–∞ *</label>
                            <select name="type" required style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                                <option value="entrance" ${payment.type === 'entrance' ? 'selected' : ''}>–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π</option>
                                <option value="membership" ${payment.type === 'membership' ? 'selected' : ''}>–ß–ª–µ–Ω—Å–∫–∏–π</option>
                                <option value="share" ${payment.type === 'share' ? 'selected' : ''}>–ü–∞–µ–≤–æ–π</option>
                                <option value="additional" ${payment.type === 'additional' ? 'selected' : ''}>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–°—É–º–º–∞ (‚ÇΩ) *</label>
                            <input type="number" name="amount" required min="1" step="0.01" value="${payment.amount}"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–î–∞—Ç–∞</label>
                            <input type="date" name="date" value="${payment.date || ''}"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>
                        
                        <div style="margin-bottom:20px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</label>
                            <textarea name="description" rows="3" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">${payment.description || ''}</textarea>
                        </div>
                        
                        <div style="display:flex;gap:10px;justify-content:flex-end">
                            <button type="button" onclick="closeModalYandex()" 
                                    style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="submit" 
                                    style="padding:12px 24px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:15px;font-weight:600">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∑–Ω–æ—Å–∞
        window.handleEditPayment = function(event, paymentId) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            const index = payments.findIndex(p => p.id == paymentId);
            
            if (index === -1) {
                alert('–í–∑–Ω–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return false;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞ÔøΩÔøΩÔøΩÔøΩ–Ω—ã–µ
            payments[index].memberId = formData.get('memberId');
            payments[index].type = formData.get('type');
            payments[index].amount = parseFloat(formData.get('amount'));
            payments[index].date = formData.get('date');
            payments[index].description = formData.get('description');
            payments[index].updatedAt = new Date().toISOString();
            
            // –ù–∞—Ö–æ–¥–∏–º –∏–º—è –ø–∞–π—â–∏–∫–∞
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const member = members.find(m => m.id == payments[index].memberId);
            payments[index].memberName = member ? member.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º
            localStorage.setItem('payments', JSON.stringify(payments));
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModalYandex();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (typeof window.showToast === 'function') {
                window.showToast({
                    type: 'success',
                    message: `‚úÖ –í–∑–Ω–æ—Å "${payments[index].memberName}" –æ–±–Ω–æ–≤–ª—ë–Ω!`,
                    duration: 3000
                });
            }
            
            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('success');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
            setTimeout(() => {
                window.showPaymentsList();
            }, 500);
            
            return false;
        };
        
        // –£–¥–∞–ª–∏—Ç—å –≤–∑–Ω–æ—Å
        window.deletePayment = function(paymentId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –≤–∑–Ω–æ—Å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                return;
            }
            
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            const filtered = payments.filter(p => p.id != paymentId);
            
            if (filtered.length === payments.length) {
                alert('–í–∑–Ω–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º
            localStorage.setItem('payments', JSON.stringify(filtered));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (typeof window.showToast === 'function') {
                window.showToast({
                    type: 'success',
                    message: '‚úÖ –í–∑–Ω–æ—Å —É–¥–∞–ª—ë–Ω',
                    duration: 3000
                });
            }
            
            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('success');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
            setTimeout(() => {
                window.showPaymentsList();
            }, 500);
        };
        
        // ============================================
        // –û–¢–ß–Å–¢: –ë–£–•–ì–ê–õ–¢–ï–†–°–ö–ò–ô –ë–ê–õ–ê–ù–° (–§–û–†–ú–ê ‚Ññ1)
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å
        window.showBalanceReport = function() {
            // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            const balanceData = {
                assets: {
                    nonCurrent: { name: '–í–Ω–µ–æ–±–æ—Ä–æ—Ç–Ω—ã–µ –∞–∫—Ç–∏–≤—ã', value: 150000 },
                    current: { name: '–û–±–æ—Ä–æ—Ç–Ω—ã–µ –∞–∫—Ç–∏–≤—ã', value: 350000 }
                },
                liabilities: {
                    capital: { name: '–ö–∞–ø–∏—Ç–∞–ª –∏ —Ä–µ–∑–µ—Ä–≤—ã', value: 400000 },
                    longTerm: { name: '–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞', value: 50000 },
                    shortTerm: { name: '–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞', value: 50000 }
                }
            };
            
            const totalAssets = balanceData.assets.nonCurrent.value + balanceData.assets.current.value;
            const totalLiabilities = balanceData.liabilities.capital.value + 
                                    balanceData.liabilities.longTerm.value + 
                                    balanceData.liabilities.shortTerm.value;
            
            const content = `
                <div style="padding:30px;max-width:800px;margin:0 auto">
                    <h2 style="margin-bottom:10px;font-size:20px;font-weight:600;text-align:center">‚öñÔ∏è –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å</h2>
                    <p style="text-align:center;color:#999;margin-bottom:20px">–§–æ—Ä–º–∞ ‚Ññ1 (–û–ö–£–î 0710001)</p>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px">
                        <!-- –ê–ö–¢–ò–í -->
                        <div style="border:1px solid #ddd;border-radius:8px;overflow:hidden">
                            <div style="background:#0088cc;color:#fff;padding:12px;text-align:center;font-weight:600">–ê–ö–¢–ò–í</div>
                            
                            <div style="padding:12px;border-bottom:1px solid #eee;background:#f9f9f9">
                                <div style="display:flex;justify-content:space-between">
                                    <span>${balanceData.assets.nonCurrent.name}</span>
                                    <span style="font-weight:600">${balanceData.assets.nonCurrent.value.toLocaleString()}</span>
                                </div>
                            </div>
                            
                            <div style="padding:12px;border-bottom:1px solid #eee">
                                <div style="display:flex;justify-content:space-between">
                                    <span>${balanceData.assets.current.name}</span>
                                    <span style="font-weight:600">${balanceData.assets.current.value.toLocaleString()}</span>
                                </div>
                            </div>
                            
                            <div style="padding:12px;background:#0088cc10;font-weight:600">
                                <div style="display:flex;justify-content:space-between">
                                    <span>–ë–ê–õ–ê–ù–°</span>
                                    <span style="color:#0088cc">${totalAssets.toLocaleString()} ‚ÇΩ</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- –ü–ê–°–°–ò–í -->
                        <div style="border:1px solid #ddd;border-radius:8px;overflow:hidden">
                            <div style="background:#4caf50;color:#fff;padding:12px;text-align:center;font-weight:600">–ü–ê–°–°–ò–í</div>
                            
                            <div style="padding:12px;border-bottom:1px solid #eee;background:#f9f9f9">
                                <div style="display:flex;justify-content:space-between">
                                    <span>${balanceData.liabilities.capital.name}</span>
                                    <span style="font-weight:600">${balanceData.liabilities.capital.value.toLocaleString()}</span>
                                </div>
                            </div>
                            
                            <div style="padding:12px;border-bottom:1px solid #eee">
                                <div style="display:flex;justify-content:space-between">
                                    <span>${balanceData.liabilities.longTerm.name}</span>
                                    <span style="font-weight:600">${balanceData.liabilities.longTerm.value.toLocaleString()}</span>
                                </div>
                            </div>
                            
                            <div style="padding:12px;border-bottom:1px solid #eee">
                                <div style="display:flex;justify-content:space-between">
                                    <span>${balanceData.liabilities.shortTerm.name}</span>
                                    <span style="font-weight:600">${balanceData.liabilities.shortTerm.value.toLocaleString()}</span>
                                </div>
                            </div>
                            
                            <div style="padding:12px;background:#4caf5010;font-weight:600">
                                <div style="display:flex;justify-content:space-between">
                                    <span>–ë–ê–õ–ê–ù–°</span>
                                    <span style="color:#4caf50">${totalLiabilities.toLocaleString()} ‚ÇΩ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align:center;padding:15px;background:#f5f7fa;border-radius:8px">
                        <div style="font-size:14px;color:#666">–ê–∫—Ç–∏–≤—ã = –ü–∞—Å—Å–∏–≤—ã</div>
                        <div style="font-size:24px;font-weight:700;color:#0088cc;margin-top:8px">
                            ${totalAssets === totalLiabilities ? '‚úÖ' : '‚ö†Ô∏è'} ${totalAssets.toLocaleString()} ‚ÇΩ = ${totalLiabilities.toLocaleString()} ‚ÇΩ
                        </div>
                    </div>
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()" 
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // ============================================
        // –û–¢–ß–Å–¢: –û–°–í (–û–ë–û–†–û–¢–ù–û-–°–ê–õ–¨–î–û–í–ê–Ø –í–ï–î–û–ú–û–°–¢–¨)
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –û–°–í
        window.showOSVReport = function() {
            // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            const osvData = [
                { account: '50', name: '–ö–∞—Å—Å–∞', debitStart: 15000, creditStart: 0, debitTurn: 120000, creditTurn: 115000, debitEnd: 20000, creditEnd: 0 },
                { account: '51', name: '–†–∞—Å—á—ë—Ç–Ω—ã–µ —Å—á–µ—Ç–∞', debitStart: 250000, creditStart: 0, debitTurn: 1250000, creditTurn: 1180000, debitEnd: 320000, creditEnd: 0 },
                { account: '66', name: '–†–∞—Å—á—ë—Ç—ã –ø–æ –∑–∞–π–º–∞–º', debitStart: 0, creditStart: 100000, debitTurn: 50000, creditTurn: 80000, debitEnd: 0, creditEnd: 130000 },
                { account: '80', name: '–£—Å—Ç–∞–≤–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª', debitStart: 0, creditStart: 400000, debitTurn: 0, creditTurn: 0, debitEnd: 0, creditEnd: 400000 },
                { account: '84', name: '–ù–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å', debitStart: 0, creditStart: 50000, debitTurn: 0, creditTurn: 35000, debitEnd: 0, creditEnd: 85000 }
            ];
            
            let rowsHTML = '';
            
            osvData.forEach(row => {
                rowsHTML += `
                    <tr style="border-bottom:1px solid #eee">
                        <td style="padding:10px;font-weight:600">${row.account}</td>
                        <td style="padding:10px">${row.name}</td>
                        <td style="padding:10px;text-align:right">${row.debitStart.toLocaleString()}</td>
                        <td style="padding:10px;text-align:right">${row.creditStart.toLocaleString()}</td>
                        <td style="padding:10px;text-align:right">${row.debitTurn.toLocaleString()}</td>
                        <td style="padding:10px;text-align:right">${row.creditTurn.toLocaleString()}</td>
                        <td style="padding:10px;text-align:right">${row.debitEnd.toLocaleString()}</td>
                        <td style="padding:10px;text-align:right">${row.creditEnd.toLocaleString()}</td>
                    </tr>
                `;
            });
            
            const totals = osvData.reduce((acc, row) => ({
                debitStart: acc.debitStart + row.debitStart,
                creditStart: acc.creditStart + row.creditStart,
                debitTurn: acc.debitTurn + row.debitTurn,
                creditTurn: acc.creditTurn + row.creditTurn,
                debitEnd: acc.debitEnd + row.debitEnd,
                creditEnd: acc.creditEnd + row.creditEnd
            }), { debitStart: 0, creditStart: 0, debitTurn: 0, creditTurn: 0, debitEnd: 0, creditEnd: 0 });
            
            const content = `
                <div style="padding:30px;max-width:1000px;margin:0 auto;overflow-x:auto">
                    <h2 style="margin-bottom:10px;font-size:20px;font-weight:600;text-align:center">üìä –û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å</h2>
                    <p style="text-align:center;color:#999;margin-bottom:20px">–ø–æ —Å—á–µ—Ç–∞–º –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–æ–≥–æ —É—á—ë—Ç–∞</p>
                    
                    <table style="width:100%;border-collapse:collapse;font-size:12px">
                        <thead>
                            <tr style="background:#f5f7fa">
                                <th style="padding:10px;border:1px solid #ddd;text-align:center" rowspan="2">–°—á—ë—Ç</th>
                                <th style="padding:10px;border:1px solid #ddd;text-align:left" rowspan="2">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                                <th style="padding:10px;border:1px solid #ddd;text-align:center" colspan="2">–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –Ω–∞—á–∞–ª–æ</th>
                                <th style="padding:10px;border:1px solid #ddd;text-align:center" colspan="2">–û–±–æ—Ä–æ—Ç—ã</th>
                                <th style="padding:10px;border:1px solid #ddd;text-align:center" colspan="2">–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω–µ—Ü</th>
                            </tr>
                            <tr style="background:#f5f7fa">
                                <th style="padding:8px;border:1px solid #ddd;text-align:right">–î—Ç</th>
                                <th style="padding:8px;border:1px solid #ddd;text-align:right">–ö—Ç</th>
                                <th style="padding:8px;border:1px solid #ddd;text-align:right">–î—Ç</th>
                                <th style="padding:8px;border:1px solid #ddd;text-align:right">–ö—Ç</th>
                                <th style="padding:8px;border:1px solid #ddd;text-align:right">–î—Ç</th>
                                <th style="padding:8px;border:1px solid #ddd;text-align:right">–ö—Ç</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${rowsHTML}
                        </tbody>
                        <tfoot>
                            <tr style="background:#f5f7fa;font-weight:600">
                                <td style="padding:10px;border:1px solid #ddd;text-align:center" colspan="2">–ò–¢–û–ì–û:</td>
                                <td style="padding:10px;border:1px solid #ddd;text-align:right">${totals.debitStart.toLocaleString()}</td>
                                <td style="padding:10px;border:1px solid #ddd;text-align:right">${totals.creditStart.toLocaleString()}</td>
                                <td style="padding:10px;border:1px solid #ddd;text-align:right">${totals.debitTurn.toLocaleString()}</td>
                                <td style="padding:10px;border:1px solid #ddd;text-align:right">${totals.creditTurn.toLocaleString()}</td>
                                <td style="padding:10px;border:1px solid #ddd;text-align:right">${totals.debitEnd.toLocaleString()}</td>
                                <td style="padding:10px;border:1px solid #ddd;text-align:right">${totals.creditEnd.toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()"
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;

            showModalYandex(content);
        };
        
        // ============================================
        // –û–¢–ß–Å–¢: –ö–£–î–∏–† –£–°–ù (–ö–ù–ò–ì–ê –£–ß–Å–¢–ê –î–û–•–û–î–û–í –ò –†–ê–°–•–û–î–û–í)
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ö–£–î–∏–†
        window.showKUDiRReport = function() {
            const currentYear = new Date().getFullYear();
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–æ–≤–æ–¥–æ–∫ –∏ –ø–ª–∞—Ç–µ–∂–µ–π
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥
            const yearTransactions = transactions.filter(t => t.date.startsWith(currentYear));
            const yearPayments = payments.filter(p => p.date.startsWith(currentYear));
            
            // –î–æ—Ö–æ–¥—ã (–≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ, –ø–∞–µ–≤—ã–µ, —á–ª–µ–Ω—Å–∫–∏–µ –≤–∑–Ω–æ—Å—ã)
            const incomes = yearPayments.filter(p => ['entrance', 'share', 'membership'].includes(p.type));
            const totalIncomes = incomes.reduce((sum, p) => sum + p.amount, 0);
            
            // –†–∞—Å—Ö–æ–¥—ã (–∏–∑ –ø—Ä–æ–≤–æ–¥–æ–∫ –ø–æ —Å—á–µ—Ç–∞–º 20, 26, 44)
            const expenseAccounts = ['20', '26', '44'];
            const expenses = yearTransactions.filter(t => expenseAccounts.includes(t.creditAccount));
            const totalExpenses = expenses.reduce((sum, t) => sum + t.amount, 0);
            
            // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const financialResult = totalIncomes - totalExpenses;
            
            let incomeRowsHTML = '';
            if (incomes.length === 0) {
                incomeRowsHTML = '<tr><td colspan="4" style="padding:12px;text-align:center;color:#999">–î–æ—Ö–æ–¥–æ–≤ –Ω–µ—Ç</td></tr>';
            } else {
                incomes.forEach((inc, idx) => {
                    incomeRowsHTML += `
                        <tr style="border-bottom:1px solid #eee">
                            <td style="padding:10px;text-align:center">${idx + 1}</td>
                            <td style="padding:10px">${inc.date || '‚Äî'}</td>
                            <td style="padding:10px">${inc.memberName || '‚Äî'}</td>
                            <td style="padding:10px;text-align:right;font-weight:600;color:#4caf50">${inc.amount.toLocaleString()} ‚ÇΩ</td>
                        </tr>
                    `;
                });
            }
            
            const content = `
                <div style="padding:30px;max-width:900px;margin:0 auto">
                    <h2 style="margin-bottom:10px;font-size:20px;font-weight:600;text-align:center">üìä –ö–£–î–∏–† –£–°–ù</h2>
                    <p style="text-align:center;color:#999;margin-bottom:20px">–ö–Ω–∏–≥–∞ —É—á—ë—Ç–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ ${currentYear} –≥–æ–¥</p>
                    
                    <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
                            <div style="text-align:center">
                                <div style="font-size:14px;color:#666">–î–æ—Ö–æ–¥—ã</div>
                                <div style="font-size:24px;font-weight:700;color:#4caf50">${totalIncomes.toLocaleString()} ‚ÇΩ</div>
                            </div>
                            <div style="text-align:center">
                                <div style="font-size:14px;color:#666">–†–∞—Å—Ö–æ–¥—ã</div>
                                <div style="font-size:24px;font-weight:700;color:#f44336">${totalExpenses.toLocaleString()} ‚ÇΩ</div>
                            </div>
                        </div>
                        <div style="text-align:center;margin-top:15px;padding-top:15px;border-top:2px solid #ddd">
                            <div style="font-size:16px;font-weight:600">–ù–∞–ª–æ–≥–æ–≤–∞—è –±–∞–∑–∞</div>
                            <div style="font-size:28px;font-weight:700;color:${financialResult >= 0 ? '#0088cc' : '#f44336'}">
                                ${financialResult >= 0 ? '+' : ''}${financialResult.toLocaleString()} ‚ÇΩ
                            </div>
                        </div>
                    </div>
                    
                    <h3 style="margin-bottom:15px;font-size:16px;font-weight:600">üìà –î–æ—Ö–æ–¥—ã –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</h3>
                    
                    <table style="width:100%;border-collapse:collapse;font-size:13px;margin-bottom:20px">
                        <thead>
                            <tr style="background:#f5f7fa">
                                <th style="padding:10px;border:1px solid #ddd;text-align:center" rowspan="2">‚Ññ</th>
                                <th style="padding:10px;border:1px solid #ddd;text-align:center" rowspan="2">–î–∞—Ç–∞</th>
                                <th style="padding:10px;border:1px solid #ddd;text-align:left" rowspan="2">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</th>
                                <th style="padding:10px;border:1px solid #ddd;text-align:right" rowspan="2">–°—É–º–º–∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${incomeRowsHTML}
                        </tbody>
                        <tfoot>
                            <tr style="background:#f5f7fa;font-weight:600">
                                <td style="padding:10px;border:1px solid #ddd;text-align:right" colspan="3">–ò—Ç–æ–≥–æ –¥–æ—Ö–æ–¥–æ–≤:</td>
                                <td style="padding:10px;border:1px solid #ddd;text-align:right;color:#4caf50">${totalIncomes.toLocaleString()} ‚ÇΩ</td>
                            </tr>
                        </tfoot>
                    </table>
                    
                    <div style="background:#fff3cd;padding:15px;border-radius:8px;margin-bottom:20px;border-left:4px solid #ffc107">
                        <div style="font-size:14px;color:#856404">
                            <strong>‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ö–£–î–∏–† –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Å—Ç–∏ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á—ë—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—á–µ—Ç–æ–≤ 20, 26, 44 –¥–ª—è —É—á—ë—Ç–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤.
                        </div>
                    </div>
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()" 
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;

            showModalYandex(content);
        };
        
        // ============================================
        // –û–¢–ß–Å–¢: –§–û–†–ú–ê ‚Ññ2 (–û–¢–ß–Å–¢ –û –§–ò–ù–ê–ù–°–û–í–´–• –†–ï–ó–£–õ–¨–¢–ê–¢–ê–•)
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –§–æ—Ä–º—É ‚Ññ2
        window.showProfitLossReport = function() {
            const currentYear = new Date().getFullYear();
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥
            const yearPayments = payments.filter(p => p.date.startsWith(currentYear));
            
            // –î–æ—Ö–æ–¥—ã
            const incomes = yearPayments.filter(p => ['entrance', 'share', 'membership'].includes(p.type));
            const totalIncomes = incomes.reduce((sum, p) => sum + p.amount, 0);
            
            // –†–∞—Å—Ö–æ–¥—ã (—É—Å–ª–æ–≤–Ω–æ —Å—á–∏—Ç–∞–µ–º –ø–æ –ø—Ä–æ–≤–æ–¥–∫–∞–º)
            const expenseAccounts = ['20', '26', '44', '91'];
            const yearTransactions = transactions.filter(t => t.date.startsWith(currentYear));
            const expenses = yearTransactions.filter(t => expenseAccounts.includes(t.creditAccount));
            const totalExpenses = expenses.reduce((sum, t) => sum + t.amount, 0);
            
            // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            const grossProfit = totalIncomes - totalExpenses;
            const netProfit = grossProfit; // –£–ø—Ä–æ—â—ë–Ω–Ω–æ (–±–µ–∑ –Ω–∞–ª–æ–≥–æ–≤)
            
            const content = `
                <div style="padding:30px;max-width:800px;margin:0 auto">
                    <h2 style="margin-bottom:10px;font-size:20px;font-weight:600;text-align:center">üìà –û—Ç—á—ë—Ç –æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö</h2>
                    <p style="text-align:center;color:#999;margin-bottom:20px">–§–æ—Ä–º–∞ ‚Ññ2 (–û–ö–£–î 0710002) –∑–∞ ${currentYear} –≥–æ–¥</p>
                    
                    <table style="width:100%;border-collapse:collapse;font-size:13px">
                        <thead>
                            <tr style="background:#f5f7fa">
                                <th style="padding:12px;border:1px solid #ddd;text-align:left" width="60%">–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>
                                <th style="padding:12px;border:1px solid #ddd;text-align:right" width="20%">–ó–∞ ${currentYear} –≥–æ–¥</th>
                                <th style="padding:12px;border:1px solid #ddd;text-align:right" width="20%">–ö–æ–¥</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background:#e3f2fd;font-weight:600">
                                <td style="padding:12px;border:1px solid #ddd">–î–æ—Ö–æ–¥—ã –æ—Ç —É—á–∞—Å—Ç–∏—è –≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–µ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right;color:#4caf50">${totalIncomes.toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">2110</td>
                            </tr>
                            <tr>
                                <td style="padding:12px;border:1px solid #ddd;padding-left:24px">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∑–Ω–æ—Å—ã</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">${incomes.filter(p => p.type === 'entrance').reduce((sum, p) => sum + p.amount, 0).toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">‚Äî</td>
                            </tr>
                            <tr>
                                <td style="padding:12px;border:1px solid #ddd;padding-left:24px">–ü–∞–µ–≤—ã–µ –≤–∑–Ω–æ—Å—ã</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">${incomes.filter(p => p.type === 'share').reduce((sum, p) => sum + p.amount, 0).toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">‚Äî</td>
                            </tr>
                            <tr>
                                <td style="padding:12px;border:1px solid #ddd;padding-left:24px">–ß–ª–µ–Ω—Å–∫–∏–µ –≤–∑–Ω–æ—Å—ã</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">${incomes.filter(p => p.type === 'membership').reduce((sum, p) => sum + p.amount, 0).toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">‚Äî</td>
                            </tr>
                            
                            <tr style="background:#ffebee;font-weight:600">
                                <td style="padding:12px;border:1px solid #ddd">–†–∞—Å—Ö–æ–¥—ã –ø–æ –æ–±—ã—á–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right;color:#f44336">${totalExpenses.toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">2120</td>
                            </tr>
                            
                            <tr style="background:#f5f7fa;font-weight:600">
                                <td style="padding:12px;border:1px solid #ddd">–í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫)</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right;color:${grossProfit >= 0 ? '#4caf50' : '#f44336'}">${grossProfit >= 0 ? '+' : ''}${grossProfit.toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">2100</td>
                            </tr>
                            
                            <tr>
                                <td style="padding:12px;border:1px solid #ddd">–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">0 ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">2340</td>
                            </tr>
                            <tr>
                                <td style="padding:12px;border:1px solid #ddd">–ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">0 ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">2350</td>
                            </tr>
                            
                            <tr style="background:#e3f2fd;font-weight:700;font-size:14px">
                                <td style="padding:12px;border:1px solid #ddd">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫)</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right;color:${netProfit >= 0 ? '#0088cc' : '#f44336'}">${netProfit >= 0 ? '+' : ''}${netProfit.toLocaleString()} ‚ÇΩ</td>
                                <td style="padding:12px;border:1px solid #ddd;text-align:right">2400</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div style="margin-top:20px;padding:15px;background:#fff3cd;border-radius:8px;border-left:4px solid #ffc107">
                        <div style="font-size:13px;color:#856404">
                            <strong>‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –û—Ç—á—ë—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞. –î–ª—è —Å–¥–∞—á–∏ –≤ –Ω–∞–ª–æ–≥–æ–≤—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é —Ñ–æ—Ä–º—É –≤ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ.
                        </div>
                    </div>
                    
                    <div style="margin-top:20px;text-align:center">
                        <button onclick="closeModalYandex()" 
                                style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            showModalYandex(content);
        };

        window.handleMenuAction = function(actionName) {
            console.log('‚öôÔ∏è –î–µ–π—Å—Ç–≤–∏–µ –º–µ–Ω—é:', actionName);

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
            switch(actionName) {
                case 'create-member':
                    showCreateMemberModal();
                    break;

                case 'create-payment':
                    showCreatePaymentModal();
                    break;

                case 'create-transaction':
                    showCreateTransactionModal();
                    break;

                case 'pko':
                    showPKOModal();
                    break;

                case 'rko':
                    showRKOModal();
                    break;

                default:
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
                    if (typeof window.showToast === 'function') {
                        window.showToast({
                            type: 'info',
                            message: '–î–µ–π—Å—Ç–≤–∏–µ "' + actionName + '" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ',
                            duration: 3000
                        });
                    } else {
                        alert('–î–µ–π—Å—Ç–≤–∏–µ: ' + actionName + ' (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)');
                    }
            }
        };

        // ============================================
        // –ë–£–•–ì–ê–õ–¢–ï–†–ò–Ø: –°–ü–†–ê–í–û–ß–ù–ò–ö –°–ß–ï–¢–û–í
        // ============================================

        // –ü–ª–∞–Ω —Å—á–µ—Ç–æ–≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞
        window.chartOfAccounts = [
            { code: '50', name: '–ö–∞—Å—Å–∞', type: 'active' },
            { code: '51', name: '–†–∞—Å—á—ë—Ç–Ω—ã–µ —Å—á–µ—Ç–∞', type: 'active' },
            { code: '66', name: '–†–∞—Å—á—ë—Ç—ã –ø–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–º –∑–∞–π–º–∞–º', type: 'passive' },
            { code: '67', name: '–†–∞—Å—á—ë—Ç—ã –ø–æ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º –∑–∞–π–º–∞–º', type: 'passive' },
            { code: '70', name: '–†–∞—Å—á—ë—Ç—ã —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º –ø–æ –æ–ø–ª–∞—Ç–µ —Ç—Ä—É–¥–∞', type: 'passive' },
            { code: '71', name: '–†–∞—Å—á—ë—Ç—ã —Å –ø–æ–¥–æ—Ç—á—ë—Ç–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏', type: 'active' },
            { code: '75', name: '–†–∞—Å—á—ë—Ç—ã —Å —É—á—Ä–µ–¥–∏—Ç–µ–ª—è–º–∏', type: 'active-passive' },
            { code: '76', name: '–†–∞—Å—á—ë—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–µ–±–∏—Ç–æ—Ä–∞–º–∏ –∏ –∫—Ä–µ–¥–∏—Ç–æ—Ä–∞–º–∏', type: 'active-passive' },
            { code: '80', name: '–£—Å—Ç–∞–≤–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª', type: 'passive' },
            { code: '82', name: '–†–µ–∑–µ—Ä–≤–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª', type: 'passive' },
            { code: '84', name: '–ù–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å (–Ω–µ–ø–æ–∫—Ä—ã—Ç—ã–π —É–±—ã—Ç–æ–∫)', type: 'passive' },
            { code: '90', name: '–ü—Ä–æ–¥–∞–∂–∏', type: 'active-passive' },
            { code: '91', name: '–ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã', type: 'active-passive' },
            { code: '99', name: '–ü—Ä–∏–±—ã–ª–∏ –∏ —É–±—ã—Ç–∫–∏', type: 'passive' }
        ];

        // ============================================
        // –ë–£–•–ì–ê–õ–¢–ï–†–ò–Ø: –ü–†–û–í–û–î–ö–ò
        // ============================================

        // –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≤–æ–¥–∫—É
        window.showCreateTransactionModal = function() {
            const accounts = window.chartOfAccounts;

            let accountOptions = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á—ë—Ç</option>';
            accounts.forEach(acc => {
                accountOptions += `<option value="${acc.code}">${acc.code} - ${acc.name}</option>`;
            });

            const content = `
                <div style="padding:30px;max-width:600px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">üìí –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≤–æ–¥–∫—É</h2>

                    <form id="createTransactionForm" onsubmit="return handleCreateTransaction(event)">
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–°—á—ë—Ç –î—Ç *</label>
                            <select name="debitAccount" required style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                                ${accountOptions}
                            </select>
                        </div>

                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–°—á—ë—Ç –ö—Ç *</label>
                            <select name="creditAccount" required style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                                ${accountOptions}
                            </select>
                        </div>

                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–°—É–º–º–∞ (‚ÇΩ) *</label>
                            <input type="number" name="amount" required min="0.01" step="0.01"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                   placeholder="1000.00">
                        </div>

                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–î–∞—Ç–∞</label>
                            <input type="date" name="date"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>

                        <div style="margin-bottom:20px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
                            <textarea name="description" rows="3" required
                                      style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                      placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –í–Ω–µ—Å–µ–Ω–∏–µ –ø–∞—è –ò–≤–∞–Ω–æ–≤—ã–º –ò.–ò."></textarea>
                        </div>

                        <div style="display:flex;gap:10px;justify-content:flex-end">
                            <button type="button" onclick="closeModalYandex()"
                                    style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="submit"
                                    style="padding:12px 24px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:15px;font-weight:600">
                                üìí –ü—Ä–æ–≤–µ—Å—Ç–∏
                            </button>
                        </div>
                    </form>
                </div>
            `;

            showModalYandex(content);
        };

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–≤–æ–¥–∫–∏
        window.handleCreateTransaction = function(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);

            const transaction = {
                debitAccount: formData.get('debitAccount'),
                creditAccount: formData.get('creditAccount'),
                amount: parseFloat(formData.get('amount')),
                date: formData.get('date') || new Date().toISOString().split('T')[0],
                description: formData.get('description')
            };

            // –ü—Ä–æ–≤–µ—Ä–∫–∞: –î—Ç != –ö—Ç
            if (transaction.debitAccount === transaction.creditAccount) {
                alert('–°—á–µ—Ç–∞ –î—Ç –∏ –ö—Ç –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏!');
                return false;
            }

            console.log('üìí –ù–æ–≤–∞—è –ø—Ä–æ–≤–æ–¥–∫–∞:', transaction);

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            transaction.id = Date.now();
            transaction.createdAt = new Date().toISOString();
            transactions.push(transaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));

            console.log('‚úÖ –ü—Ä–æ–≤–æ–¥–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞. –í—Å–µ–≥–æ –ø—Ä–æ–≤–æ–¥–æ–∫:', transactions.length);

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModalYandex();

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (typeof window.showToast === 'function') {
                window.showToast({
                    type: 'success',
                    message: `‚úÖ –ü—Ä–æ–≤–æ–¥–∫–∞ –î${transaction.debitAccount} –ö${transaction.creditAccount} –Ω–∞ —Å—É–º–º—É ${transaction.amount}‚ÇΩ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞!`,
                    duration: 3000
                });
            }

            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('success');
            }

            return false;
        };
        
        // ============================================
        // –ü–ö–û (–ü–†–ò–•–û–î–ù–´–ô –ö–ê–°–°–û–í–´–ô –û–†–î–ï–†)
        // ============================================
        
        window.showPKOModal = function() {
            alert('–ü–ö–û (–ü—Ä–∏—Ö–æ–¥–Ω—ã–π –∫–∞—Å—Å–æ–≤—ã–π –æ—Ä–¥–µ—Ä) - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
        };
        
        // ============================================
        // –†–ö–û (–†–ê–°–•–û–î–ù–´–ô –ö–ê–°–°–û–í–´–ô –û–†–î–ï–†)
        // ============================================
        
        window.showRKOModal = function() {
            alert('–†–ö–û (–†–∞—Å—Ö–æ–¥–Ω—ã–π –∫–∞—Å—Å–æ–≤—ã–π –æ—Ä–¥–µ—Ä) - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
        };
        
        // ============================================
        // –§–û–†–ú–ê: –î–û–ë–ê–í–ò–¢–¨ –ü–ê–ô–©–ò–ö–ê
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞–π—â–∏–∫–∞
        window.showCreateMemberModal = function() {
            const content = `
                <div style="padding:30px;max-width:600px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–∞–π—â–∏–∫–∞</h2>
                    
                    <form id="createMemberForm" onsubmit="return handleCreateMember(event)">
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–§–ò–û *</label>
                            <input type="text" name="name" required 
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                   placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                            <input type="tel" name="phone" 
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                   placeholder="+7 (999) 123-45-67">
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">Email</label>
                            <input type="email" name="email" 
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                   placeholder="ivanov@example.com">
                        </div>
                        
                        <div style="margin-bottom:20px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å (‚ÇΩ)</label>
                            <input type="number" name="entranceFee" min="0" 
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                   placeholder="5000">
                        </div>
                        
                        <div style="display:flex;gap:10px;justify-content:flex-end">
                            <button type="button" onclick="closeModalYandex()" 
                                    style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="submit" 
                                    style="padding:12px 24px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:15px;font-weight:600">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            showModalYandex(content);
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        window.handleCreateMember = function(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const newMember = {
                name: formData.get('name'),
                phone: formData.get('phone'),
                email: formData.get('email'),
                entranceFee: parseFloat(formData.get('entranceFee')) || 0
            };
            
            console.log('üìù –ù–æ–≤—ã–π –ø–∞–π—â–∏–∫:', newMember);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            newMember.id = Date.now();  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
            newMember.createdAt = new Date().toISOString();
            members.push(newMember);
            localStorage.setItem('members', JSON.stringify(members));
            
            console.log('‚úÖ –ü–∞–π—â–∏–∫ —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –í—Å–µ–≥–æ –ø–∞–π—â–∏–∫–æ–≤:', members.length);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModalYandex();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (typeof window.showToast === 'function') {
                window.showToast({
                    type: 'success',
                    message: `‚úÖ –ü–∞–π—â–∏–∫ "${newMember.name}" –¥–æ–±–∞–≤–ª–µ–Ω!`,
                    duration: 3000
                });
            } else {
                alert(`‚úÖ –ü–∞–π—â–∏–∫ "${newMember.name}" –¥–æ–±–∞–≤–ª–µ–Ω!`);
            }
            
            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('success');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –≤ messenger
            if (typeof window.renderChats === 'function') {
                window.renderChats();
            }
            
            return false;
        };
        
        // ============================================
        // –§–û–†–ú–ê: –î–û–ë–ê–í–ò–¢–¨ –í–ó–ù–û–°
        // ============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∑–Ω–æ—Å–∞
        window.showCreatePaymentModal = function() {
            const content = `
                <div style="padding:30px;max-width:600px;margin:0 auto">
                    <h2 style="margin-bottom:20px;font-size:20px;font-weight:600">üí≥ –î–æ–±–∞–≤–∏—Ç—å –≤–∑–Ω–æ—Å</h2>
                    
                    <form id="createPaymentForm" onsubmit="return handleCreatePayment(event)">
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–ü–∞–π—â–∏–∫ *</label>
                            <select name="memberId" required 
                                    style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–¢–∏–ø –≤–∑–Ω–æ—Å–∞ *</label>
                            <select name="type" required 
                                    style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                <option value="entrance">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π</option>
                                <option value="membership">–ß–ª–µ–Ω—Å–∫–∏–π</option>
                                <option value="share">–ü–∞–µ–≤–æ–π</option>
                                <option value="additional">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–°—É–º–º–∞ (‚ÇΩ) *</label>
                            <input type="number" name="amount" required min="1" step="0.01"
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                   placeholder="5000">
                        </div>
                        
                        <div style="margin-bottom:15px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–î–∞—Ç–∞</label>
                            <input type="date" name="date" 
                                   style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px">
                        </div>
                        
                        <div style="margin-bottom:20px">
                            <label style="display:block;margin-bottom:5px;font-weight:500">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</label>
                            <textarea name="description" rows="3"
                                      style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:15px"
                                      placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å"></textarea>
                        </div>
                        
                        <div style="display:flex;gap:10px;justify-content:flex-end">
                            <button type="button" onclick="closeModalYandex()" 
                                    style="padding:12px 24px;background:#f5f7fa;color:#333;border:none;border-radius:6px;cursor:pointer;font-size:15px">
                                –û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="submit" 
                                    style="padding:12px 24px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:15px;font-weight:600">
                                üí≥ –í–Ω–µ—Å—Ç–∏
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            showModalYandex(content);
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–∞–π—â–∏–∫–æ–≤
            setTimeout(() => {
                const select = document.querySelector('select[name="memberId"]');
                if (select) {
                    const members = JSON.parse(localStorage.getItem('members') || '[]');
                    members.forEach(member => {
                        const option = document.createElement('option');
                        option.value = member.id;
                        option.textContent = member.name;
                        select.appendChild(option);
                    });
                }
            }, 100);
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –≤–∑–Ω–æ—Å–∞
        window.handleCreatePayment = function(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const newPayment = {
                memberId: formData.get('memberId'),
                type: formData.get('type'),
                amount: parseFloat(formData.get('amount')),
                date: formData.get('date') || new Date().toISOString().split('T')[0],
                description: formData.get('description'),
                status: 'paid'
            };
            
            // –ù–∞—Ö–æ–¥–∏–º –∏–º—è –ø–∞–π—â–∏–∫–∞
            const members = JSON.parse(localStorage.getItem('members') || '[]');
            const member = members.find(m => m.id == newPayment.memberId);
            newPayment.memberName = member ? member.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            
            console.log('üí≥ –ù–æ–≤—ã–π –≤–∑–Ω–æ—Å:', newPayment);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            const payments = JSON.parse(localStorage.getItem('payments') || '[]');
            newPayment.id = Date.now();
            newPayment.createdAt = new Date().toISOString();
            payments.push(newPayment);
            localStorage.setItem('payments', JSON.stringify(payments));
            
            console.log('‚úÖ –í–∑–Ω–æ—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –í—Å–µ–≥–æ –≤–∑–Ω–æ—Å–æ–≤:', payments.length);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModalYandex();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (typeof window.showToast === 'function') {
                window.showToast({
                    type: 'success',
                    message: `‚úÖ –í–∑–Ω–æ—Å "${newPayment.memberName}" –Ω–∞ —Å—É–º–º—É ${newPayment.amount}‚ÇΩ –≤–Ω–µ—Å—ë–Ω!`,
                    duration: 3000
                });
            } else {
                alert(`‚úÖ –í–∑–Ω–æ—Å "${newPayment.memberName}" –Ω–∞ —Å—É–º–º—É ${newPayment.amount}‚ÇΩ –≤–Ω–µ—Å—ë–Ω!`);
            }
            
            // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
            if (window.TelegramMiniApp) {
                window.TelegramMiniApp.hapticFeedback('success');
            }
            
            return false;
        };

        // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PanelManager
        document.addEventListener('DOMContentLoaded', () => {
            // –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ª–µ–≤–æ–≥–æ –º–µ–Ω—é
            const menuCloseBtn = document.getElementById('menuCloseBtn');
            if (menuCloseBtn) {
                menuCloseBtn.addEventListener('click', () => {
                    PanelManager.close('sidebarMenu');
                });
            }

            // –ë—É—Ä–≥–µ—Ä –º–µ–Ω—é
            const burgerBtn = document.getElementById('burgerBtn');
            if (burgerBtn) {
                burgerBtn.addEventListener('click', () => {
                    PanelManager.open('sidebarMenu');
                });
            }
            
            // ============================================
            // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–ù–û–ü–û–ö –ú–ï–ù–Æ
            // ============================================
            const menuItems = document.querySelectorAll('.menu-item[data-panel], .menu-item[data-report], .menu-item[data-action]');
            
            console.log('‚úÖ –ù–∞–π–¥–µ–Ω–æ –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é:', menuItems.length);
            
            menuItems.forEach(item => {
                item.style.cursor = 'pointer'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –º–æ–∂–Ω–æ –∫–ª–∏–∫–Ω—É—Ç—å
                
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const panel = this.dataset.panel;
                    const report = this.dataset.report;
                    const action = this.dataset.action;
                    
                    console.log('üñ±Ô∏è –ö–ª–∏–∫ –ø–æ –º–µ–Ω—é:', { panel, report, action });

                    // –¢–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫
                    if (tg.HapticFeedback) {
                        tg.HapticFeedback.impactOccurred('light');
                    }

                    if (panel) {
                        // –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–∏
                        PanelManager.open(panel);
                        console.log('‚úÖ –û—Ç–∫—Ä—ã—Ç–∞ –ø–∞–Ω–µ–ª—å:', panel);
                    } else if (report) {
                        // –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Ç—á—ë—Ç–∞
                        window.openReportByName(report);
                    } else if (action) {
                        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
                        window.handleMenuAction(action);
                    }

                    // –ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é
                    PanelManager.close('sidebarMenu');
                });
            });
            
            Logger.info('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã');
        });
        
        console.log('üöÄ Telegram Mini App –∑–∞–ø—É—â–µ–Ω');
    </script>
</body>
</html>
