<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä v4</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        html, body { height: 100%; margin: 0; overflow: hidden; background: #f0f2f5; }
        .container { display: flex; height: 100%; position: relative; }

        /* –õ–ï–í–û–ï –ú–ï–ù–Æ (–Ω–∞–≤–∏–≥–∞—Ü–∏—è) - 400px */
        .sidebar-menu {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            z-index: 100;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .sidebar-menu.visible { transform: translateX(0); }

        .menu-header {
            padding: 20px 15px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .menu-title { font-size: 18px; font-weight: bold; }
        .menu-close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .menu-close-btn:hover { background: rgba(255,255,255,0.3); }

        .menu-content { flex: 1; overflow-y: auto; }
        .menu-section { padding: 15px 0; border-bottom: 1px solid #f0f0f0; }
        .menu-section-title {
            padding: 0 20px 10px;
            font-size: 12px;
            font-weight: bold;
            color: #999;
            text-transform: uppercase;
        }
        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .menu-item:hover { background: #f5f7fa; }
        .menu-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin-right: 12px;
        }
        .menu-item-info { flex: 1; }
        .menu-item-name { font-weight: 500; font-size: 14px; }
        .menu-item-subtitle { font-size: 12px; color: #999; }
        .menu-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: bold;
            background: #e0e0e0;
            margin-left: 8px;
        }
        .menu-badge.alert { background: #ffebee; color: #c62828; }

        /* –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í - 400px */
        .reports-submenu {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            z-index: 99;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .reports-submenu.visible { transform: translateX(0); }

        .submenu-header {
            padding: 20px 15px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .submenu-title { font-size: 16px; font-weight: 600; }
        .submenu-back-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .submenu-back-btn:hover { background: rgba(255,255,255,0.3); }

        .submenu-content { flex: 1; overflow-y: auto; padding: 15px; }
        .submenu-section { margin-bottom: 20px; }
        .submenu-section-title {
            font-size: 12px;
            font-weight: bold;
            color: #999;
            text-transform: uppercase;
            margin-bottom: 12px;
            padding-left: 10px;
        }
        .report-card {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f5f7fa;
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .report-card:hover {
            background: #e3f2fd;
            transform: translateX(4px);
        }
        .report-card-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .report-card-info { flex: 1; }
        .report-card-title { font-weight: 600; font-size: 14px; margin-bottom: 3px; }
        .report-card-desc { font-size: 12px; color: #666; }

        /* –°–ü–ò–°–û–ö –ß–ê–¢–û–í - 400px */
        .chats-panel {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            z-index: 50;
        }
        .chats-panel.hidden { transform: translateX(-400px); position: absolute; }

        .chats-header {
            padding: 15px;
            background: #fff;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .burger-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .burger-btn:hover { background: #e0e0e0; }

        .cooperative-info { flex: 1; }
        .cooperative-name { font-weight: 600; font-size: 14px; }
        .cooperative-stats { font-size: 12px; color: #666; }

        .search-section { padding: 12px 15px; background: #f5f7fa; border-bottom: 1px solid #e0e0e0; flex-shrink: 0; }
        .search-box {
            display: flex;
            align-items: center;
            background: #fff;
            border-radius: 20px;
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
        }
        .search-box input { flex: 1; border: none; outline: none; font-size: 14px; }
        .quick-filters { display: flex; gap: 6px; margin-top: 10px; flex-wrap: wrap; }
        .filter-chip {
            padding: 4px 10px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            background: #fff;
            font-size: 12px;
            cursor: pointer;
        }
        .filter-chip.active { background: #0088cc; color: #fff; border-color: #0088cc; }

        .chats-list { flex: 1; overflow-y: auto; }
        .chat-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f0f2f5;
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
        }
        .chat-item:hover { background: #f5f7fa; }
        .chat-item.active { background: #e3f2fd; }

        .chat-item .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            margin-right: 12px;
            font-size: 18px;
            flex-shrink: 0;
        }
        .chat-item .chat-info {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-width: 0;
        }
        .chat-item .chat-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }
        .chat-item .chat-name {
            font-weight: 600;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .chat-item .chat-time {
            font-size: 11px;
            color: #999;
            flex-shrink: 0;
            margin-left: 8px;
        }
        .chat-item .chat-middle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }
        .chat-item .status { font-size: 11px; }
        .chat-item .status::before { content: '‚óè'; margin-right: 4px; }
        .chat-item .status.active { color: #4caf50; }
        .chat-item .status.debt { color: #f44336; }
        .chat-item .status.pending { color: #ff9800; }
        .chat-item .balance { font-size: 12px; font-weight: 600; }
        .chat-item .balance.positive { color: #4caf50; }
        .chat-item .balance.negative { color: #f44336; }
        .chat-item .last-message {
            font-size: 13px;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .chat-item .last-message .icon { margin-right: 6px; font-size: 12px; }

        /* –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ */
        .main-chat { flex: 1; display: flex; flex-direction: column; background: #f0f2f5; min-height: 0; position: relative; }

        .chat-header {
            padding: 15px 20px;
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .chat-header-left { display: flex; align-items: center; flex: 1; }
        .chat-header-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            margin-right: 12px;
        }
        .chat-header-name { font-weight: 600; font-size: 16px; }
        .chat-header-status { font-size: 12px; color: #4caf50; margin-top: 2px; }
        .chat-header-actions { display: flex; gap: 8px; }
        .header-action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 16px;
        }
        .header-action-btn:hover { background: #0088cc; color: #fff; }
        .menu-more-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .menu-more-btn:hover { background: #0088cc; color: #fff; }

        .messages-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .message {
            max-width: 400px;
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: box-shadow 0.2s;
            animation: fadeIn 0.3s;
        }
        .message:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .message.received { background: #fff; align-self: flex-start; border-top-left-radius: 4px; }
        .message.sent { background: #d9fdd3; align-self: flex-end; border-top-right-radius: 4px; }
        .message-type { font-size: 11px; color: #0088cc; font-weight: 600; margin-bottom: 4px; text-transform: uppercase; }
        .message-content { font-size: 14px; color: #333; margin-bottom: 6px; }
        .message-amount { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
        .message-time { font-size: 11px; color: #666; text-align: right; }

        .message-input-wrapper {
            background: #fff;
            border-top: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .message-input-area {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .attach-btn, .voice-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 18px;
        }
        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 24px;
            outline: none;
            font-size: 14px;
        }
        .message-input:focus { border-color: #0088cc; }
        .send-button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            cursor: pointer;
            font-size: 18px;
        }
        .send-button:hover { transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,136,204,0.4); }

        /* –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ) */
        .sidebar-right {
            width: 380px;
            min-width: 380px;
            background: #fff;
            border-left: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 100;
        }
        .sidebar-right.visible { transform: translateX(0); }

        .member-info-header {
            padding: 20px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .member-info-header h3 { font-size: 16px; }
        .close-info-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
        }

        .member-info-content { flex: 1; overflow-y: auto; padding: 20px; }
        .member-avatar-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            font-size: 32px;
            margin: 0 auto 15px;
        }
        .member-name-large {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        .member-status-large {
            text-align: center;
            font-size: 13px;
            color: #666;
            margin-bottom: 20px;
        }

        .balance-card {
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .balance-label { font-size: 13px; opacity: 0.9; margin-bottom: 8px; }
        .balance-amount { font-size: 28px; font-weight: 700; }

        .info-section { margin-bottom: 25px; }
        .info-section-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e0e0e0;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f5f7fa;
        }
        .info-label { font-size: 13px; color: #666; }
        .info-value { font-size: 13px; font-weight: 500; color: #333; }

        .info-actions { display: flex; flex-direction: column; gap: 8px; margin-top: 20px; }
        .info-action-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }
        .info-action-btn.primary { background: linear-gradient(135deg, #0088cc, #0066aa); color: #fff; }
        .info-action-btn.secondary { background: #f5f7fa; color: #333; }
        .info-action-btn.danger { background: #ffebee; color: #c62828; }

        /* –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ / –æ—Ç—á–µ—Ç) */
        .operation-details-panel {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-left: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 99;
        }
        .operation-details-panel.visible { transform: translateX(0); }

        .details-header {
            padding: 20px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .details-header h3 { font-size: 16px; }
        .close-details-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
        }
        .details-content { padding: 20px; flex: 1; overflow-y: auto; }
        .detail-tabs { display: flex; border-bottom: 2px solid #e0e0e0; margin-bottom: 20px; }
        .detail-tab {
            padding: 10px 16px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: #666;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }
        .detail-tab.active { color: #0088cc; border-bottom-color: #0088cc; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .detail-item { margin-bottom: 16px; }
        .detail-label { font-size: 12px; color: #666; margin-bottom: 6px; font-weight: 500; }
        .detail-value { padding: 10px 12px; background: #f5f7fa; border-radius: 8px; font-size: 14px; }
        .detail-value.highlight { background: #e3f2fd; color: #0088cc; font-weight: 600; }
        .action-buttons { display: flex; flex-direction: column; gap: 8px; margin-top: 24px; }
        .action-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }
        .action-btn.primary { background: linear-gradient(135deg, #0088cc, #0066aa); color: #fff; }
        .action-btn.primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,136,204,0.4); }
        .action-btn.secondary { background: #f5f7fa; color: #333; }
        .action-btn.danger { background: #ffebee; color: #c62828; }

        /* –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∫–æ–Ω—Ç–µ–Ω—Ç –ª–µ–≤–æ–≥–æ –º–µ–Ω—é) */
        .menu-content-panel {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-left: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 98;
        }
        .menu-content-panel.visible { transform: translateX(0); }

        .menu-panel-header {
            padding: 20px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .menu-panel-header h3 { font-size: 16px; }
        .close-panel-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
        }
        .menu-panel-content { flex: 1; overflow-y: auto; padding: 20px; }

        /* –ë–û–õ–¨–®–ê–Ø –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–æ—Ç—á–µ—Ç—ã –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É) */
        .large-report-panel {
            position: absolute;
            left: 400px;
            right: 0;
            top: 0;
            height: 100%;
            background: #f5f7fa;
            z-index: 97;
            display: none;
            flex-direction: column;
        }
        .large-report-panel.visible { display: flex; }

        .large-report-header {
            padding: 20px 30px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .large-report-title { font-size: 18px; font-weight: 600; }
        .close-large-report-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
        }
        .large-report-content { flex: 1; overflow-y: auto; padding: 30px; }

        /* FAB –ö–ù–û–ü–ö–ê */
        .fab-container {
            position: fixed;
            right: 20px;
            bottom: 20px;
            z-index: 1000;
        }
        .fab-main {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            border: none;
            box-shadow: 0 4px 12px rgba(0,136,204,0.4);
            cursor: pointer;
            font-size: 24px;
            transition: all 0.3s;
        }
        .fab-main:hover { transform: scale(1.1); }
        .fab-main.close { animation: fabExpand 0.3s forwards; }
        @keyframes fabExpand { 0% { transform: scale(1); } 50% { transform: scale(0.9); } 100% { transform: scale(1) rotate(45deg); } }
        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column-reverse;
            gap: 12px;
        }
        .fab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
            transition: all 0.3s;
        }
        .fab-menu.expanded .fab-item { opacity: 1; transform: translateY(0); pointer-events: all; }
        .fab-item-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            color: #fff;
            cursor: pointer;
            font-size: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .fab-item-label {
            margin-top: 4px;
            font-size: 11px;
            color: #333;
            background: rgba(255,255,255,0.95);
            padding: 2px 8px;
            border-radius: 4px;
            white-space: nowrap;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1024px) {
            .sidebar-menu, .chats-panel, .reports-submenu { width: 350px; min-width: 350px; }
            .chats-panel.hidden { transform: translateX(-350px); }
            .sidebar-right, .operation-details-panel, .menu-content-panel { width: 350px; min-width: 350px; }
            .large-report-panel { left: 350px; }
            .message { max-width: 350px; }
        }

        @media (max-width: 768px) {
            .sidebar-menu, .chats-panel, .reports-submenu { width: 80%; min-width: 80%; }
            .chats-panel.hidden { transform: translateX(-80%); }
            .sidebar-right, .operation-details-panel, .menu-content-panel { width: 100%; min-width: 100%; }
            .large-report-panel { left: 0; }
            .fab-container { bottom: 80px; right: 15px; }
            .fab-main { width: 48px; height: 48px; font-size: 20px; }
            .message { max-width: 85%; }
        }

        @media (max-width: 480px) {
            .sidebar-menu, .chats-panel, .reports-submenu { width: 100%; min-width: 100%; }
            .chats-panel.hidden { transform: translateX(-100%); }
            .message { max-width: 85%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –õ–ï–í–û–ï –ú–ï–ù–Æ (–Ω–∞–≤–∏–≥–∞—Ü–∏—è) - 400px -->
        <div class="sidebar-menu" id="sidebarMenu">
            <div class="menu-header">
                <div class="menu-title">üè† –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
                <button class="menu-close-btn" id="menuCloseBtn">‚óÄ</button>
            </div>
            <div class="menu-content">
                <div class="menu-section">
                    <div class="menu-section-title">üìä –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
                    <div class="menu-item" onclick="openMenuPanel('favorites')">
                        <div class="menu-item-icon" style="background:#ffebee">‚ö†</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –≤–∑–Ω–æ—Å—ã</div>
                            <div class="menu-item-subtitle">–¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è</div>
                        </div>
                        <span class="menu-badge alert">3</span>
                    </div>
                    <div class="menu-item" onclick="openMenuPanel('applications')">
                        <div class="menu-item-icon" style="background:#fff3e0">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ó–∞—è–≤–ª–µ–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</div>
                        </div>
                        <span class="menu-badge alert">5</span>
                    </div>
                    <div class="menu-item" onclick="openMenuPanel('meetings')">
                        <div class="menu-item-icon" style="background:#e8f5e9">ü§ù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ó–∞—Å–µ–¥–∞–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–ó–∞–≤—Ç—Ä–∞ –≤ 10:00</div>
                        </div>
                    </div>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">üìö –£—á–µ—Ç –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å</div>
                    <div class="menu-item" onclick="openReportsSubmenu('accounting')">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìí</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç</div>
                            <div class="menu-item-subtitle">–û–°–í, –∞–Ω–∞–ª–∏–∑ —Å—á–µ—Ç–∞</div>
                        </div>
                        <span>‚Üí</span>
                    </div>
                    <div class="menu-item" onclick="openReportsSubmenu('tax')">
                        <div class="menu-item-icon" style="background:#fff3e0">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ù–∞–ª–æ–≥–æ–≤—ã–π —É—á–µ—Ç</div>
                            <div class="menu-item-subtitle">–î–µ–∫–ª–∞—Ä–∞—Ü–∏–∏, –ö–£–î–∏–†</div>
                        </div>
                        <span>‚Üí</span>
                    </div>
                    <div class="menu-item" onclick="openReportsSubmenu('management')">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìà</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á–µ—Ç</div>
                            <div class="menu-item-subtitle">P&L, Cash Flow</div>
                        </div>
                        <span>‚Üí</span>
                    </div>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">üìã –û–ø–µ—Ä–∞—Ü–∏–∏</div>
                    <div class="menu-item" onclick="openMenuPanel('documents')">
                        <div class="menu-item-icon" style="background:#f3e5f5">üìÅ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–æ–∫—É–º–µ–Ω—Ç—ã</div>
                            <div class="menu-item-subtitle">–§–∞–π–ª—ã, —à–∞–±–ª–æ–Ω—ã</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="openMenuPanel('statements')">
                        <div class="menu-item-icon" style="background:#fff3e0">üìÑ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ó–∞—è–≤–ª–µ–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–í—Ö–æ–¥—è—â–∏–µ</div>
                        </div>
                        <span class="menu-badge alert">5</span>
                    </div>
                    <div class="menu-item" onclick="openMenuPanel('reports')">
                        <div class="menu-item-icon" style="background:#fce4ec">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û—Ç—á–µ—Ç—ã</div>
                            <div class="menu-item-subtitle">–§–æ—Ä–º—ã, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
                        </div>
                    </div>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                    <div class="menu-item" onclick="openMenuPanel('profile')">
                        <div class="menu-item-icon" style="background:#e0e0e0">üë§</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü—Ä–æ—Ñ–∏–ª—å</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="openMenuPanel('security')">
                        <div class="menu-item-icon" style="background:#e0e0e0">üîê</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="openMenuPanel('backup')">
                        <div class="menu-item-icon" style="background:#e0e0e0">üíæ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í - 400px -->
        <div class="reports-submenu" id="reportsSubmenu">
            <div class="submenu-header">
                <button class="submenu-back-btn" onclick="closeReportsSubmenu()">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="submenu-title" id="submenuTitle">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç</div>
                <div style="width:80px"></div>
            </div>
            <div class="submenu-content" id="submenuContent"></div>
        </div>

        <!-- –°–ü–ò–°–û–ö –ß–ê–¢–û–í - 400px -->
        <div class="chats-panel" id="chatsPanel">
            <div class="chats-header">
                <button class="burger-btn" id="burgerBtn">‚ò∞</button>
                <div class="cooperative-info">
                    <div class="cooperative-name">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
                    <div class="cooperative-stats">12 –ø–∞–π—â–∏–∫–æ–≤ ‚Ä¢ 9 –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                </div>
            </div>

            <div class="search-section">
                <div class="search-box">
                    <span>üîç</span>
                    <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–∞–π—â–∏–∫–æ–≤..." id="searchInput">
                </div>
                <div class="quick-filters">
                    <button class="filter-chip active">–í—Å–µ</button>
                    <button class="filter-chip">üî¥ –î–æ–ª–∂–Ω–∏–∫–∏</button>
                    <button class="filter-chip">üü¢ –ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                </div>
            </div>

            <div class="chats-list" id="chatsList"></div>
        </div>

        <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ -->
        <div class="main-chat">
            <div class="chat-header">
                <div class="chat-header-left">
                    <div class="chat-header-avatar" id="currentAvatar">–ò–ò</div>
                    <div>
                        <div class="chat-header-name" id="currentName">–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</div>
                        <div class="chat-header-status">‚óè –ê–∫—Ç–∏–≤–µ–Ω</div>
                    </div>
                </div>
                <div class="chat-header-actions">
                    <button class="header-action-btn" title="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">üìû</button>
                    <button class="header-action-btn" title="Email">‚úâÔ∏è</button>
                    <button class="menu-more-btn" id="menuMoreBtn" title="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–π—â–∏–∫–µ">‚ãÆ</button>
                </div>
            </div>

            <div class="messages-container" id="messagesContainer"></div>

            <div class="message-input-wrapper">
                <div class="message-input-area">
                    <button class="attach-btn">üìé</button>
                    <input type="text" class="message-input" placeholder="–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é..." id="messageInput">
                    <button class="voice-btn">üé§</button>
                    <button class="send-button" id="sendButton">‚û§</button>
                </div>
            </div>
        </div>

        <!-- –ë–û–õ–¨–®–ê–Ø –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–æ—Ç—á–µ—Ç—ã) -->
        <div class="large-report-panel" id="largeReportPanel">
            <div class="large-report-header">
                <div class="large-report-title" id="largeReportTitle">–û—Ç—á–µ—Ç</div>
                <button class="close-large-report-btn" onclick="closeLargeReport()">‚úï</button>
            </div>
            <div class="large-report-content" id="largeReportContent"></div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ) -->
        <div class="sidebar-right" id="sidebarRight">
            <div class="member-info-header">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–π—â–∏–∫–µ</h3>
                <button class="close-info-btn" id="closeInfoBtn">‚úï</button>
            </div>
            <div class="member-info-content" id="memberInfoContent"></div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏) -->
        <div class="operation-details-panel" id="operationDetailsPanel">
            <div class="details-header">
                <h3 id="detailsTitle">–î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                <button class="close-details-btn" id="closeDetailsBtn">‚úï</button>
            </div>
            <div class="details-content" id="detailsContent"></div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∫–æ–Ω—Ç–µ–Ω—Ç –ª–µ–≤–æ–≥–æ –º–µ–Ω—é) -->
        <div class="menu-content-panel" id="menuContentPanel">
            <div class="menu-panel-header">
                <h3 id="menuPanelTitle">–†–∞–∑–¥–µ–ª</h3>
                <button class="close-panel-btn" id="closePanelBtn">‚úï</button>
            </div>
            <div class="menu-panel-content" id="menuPanelContent"></div>
        </div>

        <!-- FAB –ö–ù–û–ü–ö–ê -->
        <div class="fab-container">
            <div class="fab-menu" id="fabMenu">
                <button class="fab-item" onclick="alert('–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–ª–µ–Ω–∏—è')">
                    <button class="fab-item-btn" style="background:#f44336">üìù</button>
                    <span class="fab-item-label">–ó–∞—è–≤–ª–µ–Ω–∏–µ</span>
                </button>
                <button class="fab-item" onclick="alert('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞')">
                    <button class="fab-item-btn" style="background:#9c27b0">üìÅ</button>
                    <span class="fab-item-label">–î–æ–∫—É–º–µ–Ω—Ç</span>
                </button>
                <button class="fab-item" onclick="alert('–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∫–∏')">
                    <button class="fab-item-btn" style="background:#ff9800">üìí</button>
                    <span class="fab-item-label">–ü—Ä–æ–≤–æ–¥–∫–∞</span>
                </button>
                <button class="fab-item" onclick="alert('–í–Ω–µ—Å–µ–Ω–∏–µ –≤–∑–Ω–æ—Å–∞')">
                    <button class="fab-item-btn" style="background:#2196f3">üí≥</button>
                    <span class="fab-item-label">–í–∑–Ω–æ—Å</span>
                </button>
                <button class="fab-item" onclick="alert('–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π—â–∏–∫–∞')">
                    <button class="fab-item-btn" style="background:#4caf50">üë§</button>
                    <span class="fab-item-label">–ü–∞–π—â–∏–∫</span>
                </button>
            </div>
            <button class="fab-main" id="fabMain">+</button>
        </div>
    </div>

    <script>
        // –î–ï–ú–û –î–ê–ù–ù–´–ï
        const members = [
            {
                id: 1,
                name: "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
                avatar: "–ò–ò",
                color: "linear-gradient(135deg,#ff6b6b,#ee5a5a)",
                status: "debt",
                statusText: "–î–æ–ª–∂–Ω–∏–∫",
                balance: -2000,
                phone: "+7 (999) 123-45-67",
                email: "ivanov@example.com",
                address: "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1, –∫–≤. 1",
                joinDate: "15.01.2023",
                passport: "4500 123456",
                birthDate: "10.05.1980",
                lastTransaction: "–ü—Ä–æ—Å—Ä–æ—á–µ–Ω —á–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å (2 –º–µ—Å)",
                lastTime: "10:30",
                operations: [
                    { id: 1, type: "–í–Ω–µ—Å–µ–Ω–∏–µ –ø–∞—è", amount: 5000, date: "2024-01-15", description: "–ï–∂–µ–≥–æ–¥–Ω—ã–π –ø–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", status: "paid" },
                    { id: 2, type: "–ß–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å", amount: 1000, date: "2024-02-01", description: "–ß–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å –∑–∞ —Ñ–µ–≤—Ä–∞–ª—å", status: "overdue" },
                    { id: 3, type: "–ß–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å", amount: 1000, date: "2024-01-01", description: "–ß–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å –∑–∞ —è–Ω–≤–∞—Ä—å", status: "overdue" }
                ]
            },
            {
                id: 2,
                name: "–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –°–µ—Ä–≥–µ–µ–≤–Ω–∞",
                avatar: "–ü–ú",
                color: "linear-gradient(135deg,#51cf66,#40c057)",
                status: "active",
                statusText: "–ê–∫—Ç–∏–≤–µ–Ω",
                balance: 25000,
                phone: "+7 (999) 234-56-78",
                email: "petrova@example.com",
                address: "–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø—Ä. –ù–µ–≤—Å–∫–∏–π, –¥. 10",
                joinDate: "20.02.2023",
                passport: "4501 234567",
                birthDate: "15.08.1985",
                lastTransaction: "–í–Ω–µ—Å—ë–Ω –ø–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å 10 000 ‚ÇΩ",
                lastTime: "–í—á–µ—Ä–∞",
                operations: [
                    { id: 4, type: "–í–Ω–µ—Å–µ–Ω–∏–µ –ø–∞—è", amount: 10000, date: "2024-01-14", description: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", status: "paid" },
                    { id: 5, type: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å", amount: 5000, date: "2023-12-10", description: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å", status: "paid" },
                    { id: 6, type: "–í—ã–ø–ª–∞—Ç–∞ –¥–∏–≤–∏–¥–µ–Ω–¥–æ–≤", amount: 3500, date: "2024-01-05", description: "–î–∏–≤–∏–¥–µ–Ω–¥—ã –∑–∞ 4 –∫–≤–∞—Ä—Ç–∞–ª 2023", status: "paid" }
                ]
            },
            {
                id: 3,
                name: "–°–∏–¥–æ—Ä–æ–≤ –î–º–∏—Ç—Ä–∏–π –ü–µ—Ç—Ä–æ–≤–∏—á",
                avatar: "–°–î",
                color: "linear-gradient(135deg,#fcc419,#fab005)",
                status: "pending",
                statusText: "–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏",
                balance: 5000,
                phone: "+7 (999) 345-67-89",
                email: "sidorov@example.com",
                address: "–≥. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 5",
                joinDate: "-",
                passport: "4502 345678",
                birthDate: "22.03.1990",
                lastTransaction: "–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –ø–æ–¥–∞–Ω–æ",
                lastTime: "–ü—Ç",
                operations: [
                    { id: 7, type: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å", amount: 5000, date: "2024-01-13", description: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å –ø—Ä–∏ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–∏", status: "pending" }
                ]
            },
            {
                id: 4,
                name: "–ö–æ–∑–ª–æ–≤–∞ –ï–ª–µ–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞",
                avatar: "–ö–ï",
                color: "linear-gradient(135deg,#74c0fc,#4dabf7)",
                status: "active",
                statusText: "–ê–∫—Ç–∏–≤–µ–Ω",
                balance: 18000,
                phone: "+7 (999) 456-78-90",
                email: "kozlova@example.com",
                address: "–≥. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –ú–∞–ª—ã—à–µ–≤–∞, –¥. 20",
                joinDate: "10.03.2023",
                passport: "4503 456789",
                birthDate: "05.12.1988",
                lastTransaction: "–ü–æ–ª—É—á–µ–Ω—ã –¥–∏–≤–∏–¥–µ–Ω–¥—ã 3 500 ‚ÇΩ",
                lastTime: "–ß—Ç",
                operations: [
                    { id: 8, type: "–ü–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", amount: 15000, date: "2024-01-12", description: "–ü–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", status: "paid" },
                    { id: 9, type: "–í—ã–ø–ª–∞—Ç–∞ –¥–∏–≤–∏–¥–µ–Ω–¥–æ–≤", amount: 3500, date: "2024-01-05", description: "–î–∏–≤–∏–¥–µ–Ω–¥—ã –∑–∞ 4 –∫–≤–∞—Ä—Ç–∞–ª", status: "paid" }
                ]
            },
            {
                id: 5,
                name: "–í–æ–ª–∫–æ–≤ –°–µ—Ä–≥–µ–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á",
                avatar: "–í–°",
                color: "linear-gradient(135deg,#b197fc,#9775fa)",
                status: "active",
                statusText: "–ê–∫—Ç–∏–≤–µ–Ω",
                balance: 12000,
                phone: "+7 (999) 567-89-01",
                email: "volkov@example.com",
                address: "–≥. –ö–∞–∑–∞–Ω—å, —É–ª. –ë–∞—É–º–∞–Ω–∞, –¥. 15",
                joinDate: "05.04.2023",
                passport: "4504 567890",
                birthDate: "18.07.1982",
                lastTransaction: "–ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –≤—ã—Ö–æ–¥ –∏–∑ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞",
                lastTime: "–°—Ä",
                operations: [
                    { id: 10, type: "–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã—Ö–æ–¥", amount: 0, date: "2024-01-11", description: "–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ –≤—ã—Ö–æ–¥–µ –∏–∑ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞", status: "pending" },
                    { id: 11, type: "–í–æ–∑–≤—Ä–∞—Ç –ø–∞—è", amount: 12000, date: "2024-01-10", description: "–í–æ–∑–≤—Ä–∞—Ç –ø–∞–µ–≤–æ–≥–æ –≤–∑–Ω–æ—Å–∞", status: "pending" }
                ]
            }
        ];

        // –û–¢–ß–ï–¢–´ - –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–º–µ–Ω—é
        const reportsSubmenuData = {
            accounting: {
                title: 'üìí –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç',
                sections: [
                    {
                        title: '–û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã',
                        reports: [
                            { icon: 'üìä', color: '#e3f2fd', title: '–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å', desc: '–û–±–æ—Ä–æ—Ç—ã –∏ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å—á–µ—Ç–∞–º', action: 'openOSV' },
                            { icon: 'üìà', color: '#e3f2fd', title: '–ê–Ω–∞–ª–∏–∑ —Å—á–µ—Ç–∞', desc: '–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Å—á–µ—Ç—É', action: 'openAccountAnalysis' },
                            { icon: 'üìã', color: '#e3f2fd', title: '–ö–∞—Ä—Ç–æ—á–∫–∞ —Å—á–µ—Ç–∞', desc: '–í—Å–µ –ø—Ä–æ–≤–æ–¥–∫–∏ –ø–æ —Å—á–µ—Ç—É', action: 'openAccountCard' }
                        ]
                    },
                    {
                        title: '–†–µ–≥–∏—Å—Ç—Ä—ã',
                        reports: [
                            { icon: 'üìñ', color: '#fff3e0', title: '–ñ—É—Ä–Ω–∞–ª-–æ—Ä–¥–µ—Ä', desc: '–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è –ø—Ä–æ–≤–æ–¥–æ–∫', action: 'openJournal' },
                            { icon: 'üìí', color: '#fff3e0', title: '–ì–ª–∞–≤–Ω–∞—è –∫–Ω–∏–≥–∞', desc: '–°–≤–æ–¥–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä', action: 'openMainBook' }
                        ]
                    },
                    {
                        title: '–ë–∞–ª–∞–Ω—Å',
                        reports: [
                            { icon: '‚öñÔ∏è', color: '#e8f5e9', title: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å', desc: '–§–æ—Ä–º–∞ ‚Ññ1', action: 'openBalance' }
                        ]
                    }
                ]
            },
            tax: {
                title: 'üìä –ù–∞–ª–æ–≥–æ–≤—ã–π —É—á–µ—Ç',
                sections: [
                    {
                        title: '–î–µ–∫–ª–∞—Ä–∞—Ü–∏–∏',
                        reports: [
                            { icon: 'üìã', color: '#fff3e0', title: '–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –ø–æ –£–°–ù', desc: '–ù–∞–ª–æ–≥–æ–≤–∞—è –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è', action: 'openUSN' },
                            { icon: 'üìä', color: '#fff3e0', title: '6-–ù–î–§–õ', desc: '–†–∞—Å—á–µ—Ç –Ω–∞–ª–æ–≥–∞ –Ω–∞ –¥–æ—Ö–æ–¥—ã', action: 'open6NDFL' },
                            { icon: 'üìÑ', color: '#fff3e0', title: '2-–ù–î–§–õ', desc: '–°–ø—Ä–∞–≤–∫–∏ –æ –¥–æ—Ö–æ–¥–∞—Ö', action: 'open2NDFL' }
                        ]
                    },
                    {
                        title: '–†–µ–≥–∏—Å—Ç—Ä—ã',
                        reports: [
                            { icon: 'üìñ', color: '#e3f2fd', title: '–ö–£–î–∏–†', desc: '–ö–Ω–∏–≥–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤', action: 'openKUDiR' },
                            { icon: 'üí∞', color: '#e3f2fd', title: '–†–∞—Å—á–µ—Ç –≤–∑–Ω–æ—Å–æ–≤', desc: '–°—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤–∑–Ω–æ—Å—ã', action: 'openInsurance' }
                        ]
                    }
                ]
            },
            management: {
                title: 'üìà –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á–µ—Ç',
                sections: [
                    {
                        title: '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã',
                        reports: [
                            { icon: 'üìä', color: '#e8f5e9', title: 'P&L', desc: '–û—Ç—á–µ—Ç –æ –ø—Ä–∏–±—ã–ª—è—Ö –∏ —É–±—ã—Ç–∫–∞—Ö', action: 'openPL' },
                            { icon: 'üíµ', color: '#e8f5e9', title: 'Cash Flow', desc: '–î–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤', action: 'openCashFlow' },
                            { icon: '‚öñÔ∏è', color: '#e8f5e9', title: '–ë–∞–ª–∞–Ω—Å', desc: '–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å', action: 'openManagementBalance' }
                        ]
                    },
                    {
                        title: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞',
                        reports: [
                            { icon: 'üìà', color: '#e3f2fd', title: '–î–µ–±–∏—Ç–æ—Ä—Å–∫–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å', desc: '–ê–Ω–∞–ª–∏–∑ –¥–æ–ª–≥–æ–≤ –ø–∞–π—â–∏–∫–æ–≤', action: 'openDebtors' },
                            { icon: 'üìâ', color: '#e3f2fd', title: '–ö—Ä–µ–¥–∏—Ç–æ—Ä—Å–∫–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å', desc: '–ù–∞—à–∏ –¥–æ–ª–≥–∏', action: 'openCreditors' }
                        ]
                    },
                    {
                        title: '–†–µ–µ—Å—Ç—Ä—ã',
                        reports: [
                            { icon: 'üìã', color: '#fce4ec', title: '–†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤', desc: '–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –±–∞–ª–∞–Ω—Å–∞–º–∏', action: 'openMembersRegistry' }
                        ]
                    }
                ]
            }
        };

        // –ö–û–ù–¢–ï–ù–¢ –î–õ–Ø –ü–ê–ù–ï–õ–ï–ô –õ–ï–í–û–ì–û –ú–ï–ù–Æ
        const menuPanelContent = {
            favorites: {
                title: 'üìä –ò–∑–±—Ä–∞–Ω–Ω–æ–µ',
                content: `
                    <div style="margin-bottom:20px">
                        <div style="padding:15px;background:#ffebee;border-radius:8px;margin-bottom:15px;cursor:pointer" onclick="alert('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–º')">
                            <div style="font-size:16px;font-weight:600;margin-bottom:5px">‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –≤–∑–Ω–æ—Å—ã</div>
                            <div style="font-size:13px;color:#666">3 –ø–∞–π—â–∏–∫–∞ –∏–º–µ—é—Ç –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å</div>
                            <div style="margin-top:10px"><span style="background:#c62828;color:#fff;padding:4px 8px;border-radius:4px;font-size:11px">–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è</span></div>
                        </div>
                        <div style="padding:15px;background:#fff3e0;border-radius:8px;margin-bottom:15px;cursor:pointer" onclick="alert('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –∑–∞—è–≤–ª–µ–Ω–∏—è–º')">
                            <div style="font-size:16px;font-weight:600;margin-bottom:5px">üìù –ó–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</div>
                            <div style="font-size:13px;color:#666">5 –∑–∞—è–≤–ª–µ–Ω–∏–π –æ–∂–∏–¥–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏</div>
                            <div style="margin-top:10px"><span style="background:#ef6c00;color:#fff;padding:4px 8px;border-radius:4px;font-size:11px">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</span></div>
                        </div>
                        <div style="padding:15px;background:#e8f5e9;border-radius:8px;cursor:pointer" onclick="alert('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –∑–∞—Å–µ–¥–∞–Ω–∏—è–º')">
                            <div style="font-size:16px;font-weight:600;margin-bottom:5px">ü§ù –ë–ª–∏–∂–∞–π—à–µ–µ –∑–∞—Å–µ–¥–∞–Ω–∏–µ</div>
                            <div style="font-size:13px;color:#666">–ó–∞–≤—Ç—Ä–∞ –≤ 10:00 ‚Ä¢ –ë–æ–ª—å—à–æ–π –∑–∞–ª</div>
                            <div style="margin-top:10px"><span style="background:#2e7d32;color:#fff;padding:4px 8px;border-radius:4px;font-size:11px">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</span></div>
                        </div>
                    </div>
                `
            },
            applications: {
                title: 'üìù –ó–∞—è–≤–ª–µ–Ω–∏—è',
                content: `
                    <div style="margin-bottom:15px"><strong>5 –∑–∞—è–≤–ª–µ–Ω–∏–π</strong> –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</div>
                    ${members.slice(0,3).map(m => `
                        <div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px;cursor:pointer" onclick="selectMember(${m.id})">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                                <span style="font-weight:600">${m.name}</span>
                                <span style="font-size:11px;color:#999">${m.lastTime}</span>
                            </div>
                            <div style="font-size:13px;color:#666;margin-bottom:5px">${m.lastTransaction}</div>
                            <span style="background:#0088cc;color:#fff;padding:4px 8px;border-radius:4px;font-size:11px">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</span>
                        </div>
                    `).join('')}
                `
            },
            meetings: {
                title: 'ü§ù –ó–∞—Å–µ–¥–∞–Ω–∏—è',
                content: `
                    <div style="padding:20px;background:#e8f5e9;border-radius:8px;margin-bottom:20px">
                        <div style="font-size:16px;font-weight:600;margin-bottom:10px">üìÖ –ë–ª–∏–∂–∞–π—à–µ–µ –∑–∞—Å–µ–¥–∞–Ω–∏–µ</div>
                        <div style="font-size:14px;margin-bottom:5px"><strong>–î–∞—Ç–∞:</strong> 17 —Ñ–µ–≤—Ä–∞–ª—è 2024</div>
                        <div style="font-size:14px;margin-bottom:5px"><strong>–í—Ä–µ–º—è:</strong> 10:00</div>
                        <div style="font-size:14px;margin-bottom:5px"><strong>–ú–µ—Å—Ç–æ:</strong> –ë–æ–ª—å—à–æ–π –∑–∞–ª</div>
                        <div style="font-size:14px"><strong>–ü–æ–≤–µ—Å—Ç–∫–∞:</strong> –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≥–æ–¥–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞</div>
                    </div>
                    <div style="font-size:14px;font-weight:600;margin-bottom:10px">–ü—Ä–æ—à–µ–¥—à–∏–µ –∑–∞—Å–µ–¥–∞–Ω–∏—è</div>
                    <div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px">
                        <div style="font-size:14px;font-weight:500">–ó–∞—Å–µ–¥–∞–Ω–∏–µ –æ—Ç 15 —è–Ω–≤–∞—Ä—è 2024</div>
                        <div style="font-size:12px;color:#666;margin-top:5px">–ü—Ä–æ—Ç–æ–∫–æ–ª ‚Ññ1 –ø–æ–¥–ø–∏—Å–∞–Ω</div>
                    </div>
                `
            },
            documents: {
                title: 'üìÅ –î–æ–∫—É–º–µ–Ω—Ç—ã',
                content: `
                    <div style="margin-bottom:15px">
                        <button style="padding:10px 20px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer;margin-right:10px">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                        <button style="padding:10px 20px;background:#f5f7fa;color:#333;border:1px solid #e0e0e0;border-radius:6px;cursor:pointer">üìÅ –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É</button>
                    </div>
                    <div style="font-size:14px;font-weight:600;margin-bottom:10px">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</div>
                    <div style="padding:12px;background:#f5f7fa;border-radius:6px;margin-bottom:8px;cursor:pointer">üìÑ –£—Å—Ç–∞–≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞.pdf</div>
                    <div style="padding:12px;background:#f5f7fa;border-radius:6px;margin-bottom:8px;cursor:pointer">üìÑ –ü—Ä–æ—Ç–æ–∫–æ–ª ‚Ññ1.docx</div>
                    <div style="padding:12px;background:#f5f7fa;border-radius:6px;margin-bottom:8px;cursor:pointer">üìä –ì–æ–¥–æ–≤–æ–π –æ—Ç—á–µ—Ç 2023.xlsx</div>
                `
            },
            statements: {
                title: 'üìÑ –í—Ö–æ–¥—è—â–∏–µ –∑–∞—è–≤–ª–µ–Ω–∏—è',
                content: `
                    <div style="margin-bottom:15px"><strong>5 –∑–∞—è–≤–ª–µ–Ω–∏–π</strong> —Ç—Ä–µ–±—É—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏</div>
                    ${members.slice(0,5).map((m,i) => `
                        <div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px;cursor:pointer" onclick="selectMember(${m.id})">
                            <div style="display:flex;justify-content:space-between;align-items:center">
                                <div>
                                    <div style="font-weight:600">${m.name}</div>
                                    <div style="font-size:12px;color:#666;margin-top:4px">${m.lastTransaction}</div>
                                </div>
                                <span style="background:#ff9800;color:#fff;padding:4px 8px;border-radius:4px;font-size:11px">–ù–æ–≤–æ–µ</span>
                            </div>
                        </div>
                    `).join('')}
                `
            },
            reports: {
                title: 'üìä –û—Ç—á–µ—Ç—ã',
                content: `
                    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px">
                        <div style="padding:20px;background:#e3f2fd;border-radius:8px;cursor:pointer" onclick="openPL()">
                            <div style="font-size:24px;margin-bottom:8px">üìà</div>
                            <div style="font-weight:600">P&L</div>
                            <div style="font-size:12px;color:#666">–ü—Ä–∏–±—ã–ª–∏ –∏ —É–±—ã—Ç–∫–∏</div>
                        </div>
                        <div style="padding:20px;background:#e8f5e9;border-radius:8px;cursor:pointer" onclick="openCashFlow()">
                            <div style="font-size:24px;margin-bottom:8px">üíµ</div>
                            <div style="font-weight:600">Cash Flow</div>
                            <div style="font-size:12px;color:#666">–î–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–≥</div>
                        </div>
                        <div style="padding:20px;background:#fff3e0;border-radius:8px;cursor:pointer" onclick="openOSV()">
                            <div style="font-size:24px;margin-bottom:8px">üìä</div>
                            <div style="font-weight:600">–û–°–í</div>
                            <div style="font-size:12px;color:#666">–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è</div>
                        </div>
                        <div style="padding:20px;background:#fce4ec;border-radius:8px;cursor:pointer" onclick="alert('–†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤')">
                            <div style="font-size:24px;margin-bottom:8px">üìã</div>
                            <div style="font-weight:600">–†–µ–µ—Å—Ç—Ä</div>
                            <div style="font-size:12px;color:#666">–ü–∞–π—â–∏–∫–∏ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div>
                        </div>
                    </div>
                `
            },
            profile: {
                title: 'üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
                content: `
                    <div style="text-align:center;margin-bottom:20px">
                        <div style="width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,#0088cc,#0066aa);color:#fff;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:bold;margin:0 auto 15px">–ê</div>
                        <div style="font-size:18px;font-weight:600">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                        <div style="font-size:13px;color:#666">admin@coop.ru</div>
                    </div>
                    <div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px">
                        <div style="font-size:13px;color:#666">–†–æ–ª—å</div>
                        <div style="font-weight:500">–ì–ª–∞–≤–Ω—ã–π –±—É—Ö–≥–∞–ª—Ç–µ—Ä</div>
                    </div>
                    <div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px">
                        <div style="font-size:13px;color:#666">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥</div>
                        <div style="font-weight:500">16 —Ñ–µ–≤—Ä–∞–ª—è 2024, 09:30</div>
                    </div>
                `
            },
            security: {
                title: 'üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                content: `
                    <div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:15px">
                        <div style="font-weight:600;margin-bottom:10px">–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</div>
                        <input type="password" placeholder="–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å" style="width:100%;padding:10px;border:1px solid #e0e0e0;border-radius:6px;margin-bottom:10px">
                        <input type="password" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" style="width:100%;padding:10px;border:1px solid #e0e0e0;border-radius:6px;margin-bottom:10px">
                        <input type="password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" style="width:100%;padding:10px;border:1px solid #e0e0e0;border-radius:6px;margin-bottom:10px">
                        <button style="width:100%;padding:12px;background:#0088cc;color:#fff;border:none;border-radius:6px;cursor:pointer">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                    </div>
                    <div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:15px">
                        <div style="font-weight:600;margin-bottom:10px">–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</div>
                        <div style="font-size:13px;color:#666;margin-bottom:10px">–ü–æ–≤—ã—Å—å—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç–∞</div>
                        <button style="padding:10px 20px;background:#4caf50;color:#fff;border:none;border-radius:6px;cursor:pointer">–í–∫–ª—é—á–∏—Ç—å 2FA</button>
                    </div>
                `
            },
            backup: {
                title: 'üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ',
                content: `
                    <div style="padding:20px;background:#e3f2fd;border-radius:8px;margin-bottom:20px">
                        <div style="font-size:16px;font-weight:600;margin-bottom:10px">–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</div>
                        <div style="font-size:14px;margin-bottom:5px"><strong>–î–∞—Ç–∞:</strong> 16 —Ñ–µ–≤—Ä–∞–ª—è 2024, 03:00</div>
                        <div style="font-size:14px"><strong>–†–∞–∑–º–µ—Ä:</strong> 24.5 –ú–ë</div>
                    </div>
                    <button style="width:100%;padding:15px;background:#0088cc;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;margin-bottom:10px">üíæ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é</button>
                    <button style="width:100%;padding:15px;background:#f5f7fa;color:#333;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500">üìÇ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –∫–æ–ø–∏–∏</button>
                `
            }
        };

        let currentMember = null;
        let fabExpanded = false;

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        function init() {
            renderChats();
            if (members.length > 0) selectMember(members[0]);
            setupEventListeners();
        }

        // –†–µ–Ω–¥–µ—Ä —á–∞—Ç–æ–≤ - 3 —Å—Ç—Ä–æ–∫–∏
        function renderChats() {
            const chatsList = document.getElementById('chatsList');
            chatsList.innerHTML = members.map(m => {
                const balanceClass = m.balance >= 0 ? 'positive' : 'negative';
                const balanceText = m.balance >= 0 ? `${m.balance.toLocaleString()} ‚ÇΩ` : `‚àí${Math.abs(m.balance).toLocaleString()} ‚ÇΩ`;
                const icon = m.status === 'debt' ? '‚ö†' : m.status === 'pending' ? 'üìù' : '‚úì';
                return `<div class="chat-item" data-id="${m.id}">
                    <div class="avatar" style="background:${m.color}">${m.avatar}</div>
                    <div class="chat-info">
                        <div class="chat-top">
                            <span class="chat-name">${m.name}</span>
                            <span class="chat-time">${m.lastTime}</span>
                        </div>
                        <div class="chat-middle">
                            <span class="status ${m.status}">${m.statusText}</span>
                            <span class="balance ${balanceClass}">${balanceText}</span>
                        </div>
                        <div class="last-message">
                            <span class="icon">${icon}</span>${m.lastTransaction}
                        </div>
                    </div>
                </div>`;
            }).join('');
            chatsList.querySelectorAll('.chat-item').forEach(item => {
                item.addEventListener('click', () => selectMember(members.find(m => m.id == item.dataset.id)));
            });
        }

        // –í—ã–±–æ—Ä –ø–∞–π—â–∏–∫–∞
        function selectMember(member) {
            currentMember = member;
            document.getElementById('currentName').textContent = member.name;
            document.getElementById('currentAvatar').textContent = member.avatar;
            document.getElementById('currentAvatar').style.background = member.color;
            document.querySelectorAll('.chat-item').forEach(i => i.classList.remove('active'));
            document.querySelector(`.chat-item[data-id="${member.id}"]`)?.classList.add('active');
            renderMessages(member.operations);
            document.getElementById('sidebarRight').classList.remove('visible');
            document.getElementById('operationDetailsPanel').classList.remove('visible');
            document.getElementById('menuContentPanel').classList.remove('visible');
        }

        // –†–µ–Ω–¥–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
        function renderMessages(operations) {
            const container = document.getElementById('messagesContainer');
            container.innerHTML = operations.map(op => {
                const statusIcon = op.status === 'paid' ? '‚úì' : op.status === 'overdue' ? '‚ö†' : '‚è≥';
                return `<div class="message received" onclick="showOperationDetails(${op.id})">
                    <div class="message-type">${op.type}</div>
                    <div class="message-content">${op.description}</div>
                    ${op.amount ? `<div class="message-amount">${op.amount.toLocaleString()} ‚ÇΩ</div>` : ''}
                    <div class="message-time">${op.date} ${statusIcon}</div>
                </div>`;
            }).join('');
            container.scrollTop = container.scrollHeight;
        }

        // –û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–º–µ–Ω—é –æ—Ç—á–µ—Ç–æ–≤
        function openReportsSubmenu(type) {
            const data = reportsSubmenuData[type];
            if (!data) return;

            document.getElementById('submenuTitle').textContent = data.title;
            const content = document.getElementById('submenuContent');
            content.innerHTML = data.sections.map(section => `
                <div class="submenu-section">
                    <div class="submenu-section-title">${section.title}</div>
                    ${section.reports.map(report => `
                        <div class="report-card" onclick="${report.action}()">
                            <div class="report-card-icon" style="background:${report.color}">${report.icon}</div>
                            <div class="report-card-info">
                                <div class="report-card-title">${report.title}</div>
                                <div class="report-card-desc">${report.desc}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');

            document.getElementById('reportsSubmenu').classList.add('visible');
        }

        function closeReportsSubmenu() {
            document.getElementById('reportsSubmenu').classList.remove('visible');
        }

        // –û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ª–µ–≤–æ–≥–æ –º–µ–Ω—é
        function openMenuPanel(panelType) {
            const panel = menuPanelContent[panelType];
            if (!panel) return;

            document.getElementById('menuPanelTitle').textContent = panel.title;
            document.getElementById('menuPanelContent').innerHTML = panel.content;
            document.getElementById('menuContentPanel').classList.add('visible');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ (–ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å)
        function showMemberInfo() {
            if (!currentMember) return;

            const m = currentMember;
            const statusClass = m.status === 'active' ? 'positive' : m.status === 'debt' ? 'negative' : '';
            const balanceClass = m.balance >= 0 ? '' : 'style="color:#ffcdd2"';

            const content = `
                <div class="member-avatar-large" style="background:${m.color}">${m.avatar}</div>
                <div class="member-name-large">${m.name}</div>
                <div class="member-status-large">‚óè <span class="${statusClass}">${m.statusText}</span></div>

                <div class="balance-card">
                    <div class="balance-label">–ë–∞–ª–∞–Ω—Å –ø–∞–π—â–∏–∫–∞</div>
                    <div class="balance-amount" ${balanceClass}>${m.balance >= 0 ? '+' : ''}${m.balance.toLocaleString()} ‚ÇΩ</div>
                </div>

                <div class="info-section">
                    <div class="info-section-title">üìã –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
                    <div class="info-row"><span class="info-label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</span><span class="info-value">${m.birthDate}</span></div>
                    <div class="info-row"><span class="info-label">–ü–∞—Å–ø–æ—Ä—Ç</span><span class="info-value">${m.passport}</span></div>
                    <div class="info-row"><span class="info-label">–ê–¥—Ä–µ—Å</span><span class="info-value">${m.address}</span></div>
                </div>

                <div class="info-section">
                    <div class="info-section-title">üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
                    <div class="info-row"><span class="info-label">–¢–µ–ª–µ—Ñ–æ–Ω</span><span class="info-value">${m.phone}</span></div>
                    <div class="info-row"><span class="info-label">Email</span><span class="info-value">${m.email}</span></div>
                </div>

                <div class="info-section">
                    <div class="info-section-title">üìä –ß–ª–µ–Ω—Å—Ç–≤–æ</div>
                    <div class="info-row"><span class="info-label">–î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</span><span class="info-value">${m.joinDate}</span></div>
                    <div class="info-row"><span class="info-label">–°—Ç–∞—Ç—É—Å</span><span class="info-value">${m.statusText}</span></div>
                    <div class="info-row"><span class="info-label">–ë–∞–ª–∞–Ω—Å</span><span class="info-value" ${balanceClass}>${m.balance >= 0 ? '+' : ''}${m.balance.toLocaleString()} ‚ÇΩ</span></div>
                </div>

                <div class="info-section">
                    <div class="info-section-title">üíº –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</div>
                    ${m.operations.slice(0, 3).map(op => `
                        <div class="info-row" style="cursor:pointer" onclick="showOperationDetails(${op.id})">
                            <span class="info-label">${op.type}</span>
                            <span class="info-value">${op.amount ? op.amount.toLocaleString() + ' ‚ÇΩ' : '‚Äî'}</span>
                        </div>
                    `).join('')}
                </div>

                <div class="info-actions">
                    <button class="info-action-btn primary">üìÑ –í—ã–ø–∏—Å–∫–∞ –ø–æ —Å—á–µ—Ç—É</button>
                    <button class="info-action-btn secondary">‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</button>
                    <button class="info-action-btn secondary">üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å</button>
                    <button class="info-action-btn danger">‚ö†Ô∏è –ò—Å–∫–ª—é—á–∏—Ç—å –ø–∞–π—â–∏–∫–∞</button>
                </div>
            `;

            document.getElementById('memberInfoContent').innerHTML = content;
            document.getElementById('sidebarRight').classList.add('visible');
        }

        // –î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
        function showOperationDetails(opId) {
            const op = currentMember.operations.find(o => o.id === opId);
            if (!op) return;

            const statusText = op.status === 'paid' ? '‚úì –û–ø–ª–∞—á–µ–Ω–æ' : op.status === 'overdue' ? '‚ö† –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ' : '‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è';
            const content = `
                <div class="detail-tabs">
                    <button class="detail-tab active" onclick="switchTab('main')">–û—Å–Ω–æ–≤–Ω–æ–µ</button>
                    <button class="detail-tab" onclick="switchTab('accounting')">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è</button>
                    <button class="detail-tab" onclick="switchTab('docs')">–î–æ–∫—É–º–µ–Ω—Ç—ã</button>
                </div>
                <div class="tab-content active" id="tab-main">
                    <div class="detail-item"><div class="detail-label">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</div><div class="detail-value highlight">${op.type}</div></div>
                    <div class="detail-item"><div class="detail-label">–°—É–º–º–∞</div><div class="detail-value highlight">${op.amount ? op.amount.toLocaleString() + ' ‚ÇΩ' : '‚Äî'}</div></div>
                    <div class="detail-item"><div class="detail-label">–î–∞—Ç–∞</div><div class="detail-value">${op.date}</div></div>
                    <div class="detail-item"><div class="detail-label">–û–ø–∏—Å–∞–Ω–∏–µ</div><div class="detail-value">${op.description}</div></div>
                    <div class="detail-item"><div class="detail-label">–°—Ç–∞—Ç—É—Å</div><div class="detail-value">${statusText}</div></div>
                    <div class="action-buttons">
                        <button class="action-btn primary">üìÑ –ü–µ—á–∞—Ç—å</button>
                        <button class="action-btn secondary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="action-btn danger">‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç</button>
                    </div>
                </div>
                <div class="tab-content" id="tab-accounting">
                    <div class="detail-item"><div class="detail-label">–ü—Ä–æ–≤–æ–¥–∫–∏</div><div class="detail-value">–î—Ç 50 - –ö—Ç 86-1: ${op.amount || 0} ‚ÇΩ</div></div>
                </div>
                <div class="tab-content" id="tab-docs">
                    <div class="detail-item"><div class="detail-label">–î–æ–∫—É–º–µ–Ω—Ç—ã</div><div class="detail-value">üìÑ –ó–∞—è–≤–ª–µ–Ω–∏–µ<br>üìÑ –ü–ö–û ‚Ññ${op.id}</div></div>
                </div>
            `;
            document.getElementById('detailsTitle').textContent = '–î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏';
            document.getElementById('detailsContent').innerHTML = content;
            document.getElementById('operationDetailsPanel').classList.add('visible');
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tab) {
            document.querySelectorAll('.detail-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(`tab-${tab}`).classList.add('active');
        }

        // –û—Ç–∫—Ä—ã—Ç—å –±–æ–ª—å—à–æ–π –æ—Ç—á–µ—Ç
        function openLargeReport(title, content) {
            document.getElementById('largeReportTitle').textContent = title;
            document.getElementById('largeReportContent').innerHTML = content;
            document.getElementById('largeReportPanel').classList.add('visible');
            document.getElementById('reportsSubmenu').classList.remove('visible');
        }

        function closeLargeReport() {
            document.getElementById('largeReportPanel').classList.remove('visible');
        }

        // –û–¢–ß–ï–¢–´ (—Ñ—É–Ω–∫—Ü–∏–∏)
        function openOSV() {
            const content = `
                <div style="display:flex;gap:8px;margin-top:20px;flex-wrap:wrap;margin-bottom:20px">
                    <button style="padding:8px 16px;border:1px solid #e0e0e0;border-radius:6px;background:#fff;cursor:pointer">üìä –¢–∞–±–ª–∏—Ü–∞</button>
                    <button style="padding:8px 16px;border:1px solid #e0e0e0;border-radius:6px;background:#fff;cursor:pointer">üìà –ì—Ä–∞—Ñ–∏–∫</button>
                    <button style="padding:8px 16px;border:1px solid #e0e0e0;border-radius:6px;background:#fff;cursor:pointer">üìÑ PDF</button>
                    <button style="padding:8px 16px;border:1px solid #e0e0e0;border-radius:6px;background:#fff;cursor:pointer">üìß Email</button>
                </div>
                <table style="width:100%;border-collapse:collapse;font-size:13px;background:#fff;border-radius:8px;overflow:hidden">
                    <thead><tr style="background:#f5f7fa"><th style="padding:12px;text-align:left">–°—á–µ—Ç</th><th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th><th>–í—Ö. –î—Ç</th><th>–í—Ö. –ö—Ç</th><th>–û–±–æ—Ä–æ—Ç –î—Ç</th><th>–û–±–æ—Ä–æ—Ç –ö—Ç</th></tr></thead>
                    <tbody>
                        <tr><td style="padding:12px">50</td><td>–ö–∞—Å—Å–∞</td><td>15 000</td><td>5 000</td><td>120 000</td><td>115 000</td></tr>
                        <tr style="background:#f9fafb"><td style="padding:12px">51</td><td>–†–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞</td><td>250 000</td><td>180 000</td><td>1 250 000</td><td>1 180 000</td></tr>
                        <tr><td style="padding:12px">86-1</td><td>–ü–∞–µ–≤–æ–π —Ñ–æ–Ω–¥</td><td>500 000</td><td>450 000</td><td>50 000</td><td>45 000</td></tr>
                        <tr style="background:#e3f2fd;font-weight:600"><td colspan="2" style="padding:12px">–ò–¢–û–ì–û</td><td>890 000</td><td>750 000</td><td>1 440 000</td><td>1 357 000</td></tr>
                    </tbody>
                </table>
            `;
            openLargeReport('–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å', content);
        }

        function openPL() {
            const content = `
                <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:15px;margin-bottom:20px">
                    <div style="padding:20px;background:#e8f5e9;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–î–æ—Ö–æ–¥—ã</div><div style="font-size:24px;font-weight:700">212 000 ‚ÇΩ</div><div style="font-size:12px;color:#4caf50;margin-top:8px">üìà +17.8%</div></div>
                    <div style="padding:20px;background:#ffebee;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–†–∞—Å—Ö–æ–¥—ã</div><div style="font-size:24px;font-weight:700">140 720 ‚ÇΩ</div><div style="font-size:12px;color:#4caf50;margin-top:8px">üìâ -1.5%</div></div>
                    <div style="padding:20px;background:#e3f2fd;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–ü—Ä–∏–±—ã–ª—å</div><div style="font-size:24px;font-weight:700">71 280 ‚ÇΩ</div><div style="font-size:12px;color:#4caf50;margin-top:8px">üìà +91.6%</div></div>
                    <div style="padding:20px;background:#fff3e0;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å</div><div style="font-size:24px;font-weight:700">33.6%</div><div style="font-size:12px;color:#4caf50;margin-top:8px">üìà +12.9 –ø.–ø.</div></div>
                </div>
                <div style="background:#fff;border-radius:8px;overflow:hidden">
                    <table style="width:100%;border-collapse:collapse;font-size:13px">
                        <thead><tr style="background:#f5f7fa"><th style="padding:12px;text-align:left">–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th><th>–Ø–Ω–≤ 2024</th><th>–î–µ–∫ 2023</th><th>–ò–∑–º.</th></tr></thead>
                        <tbody>
                            <tr style="background:#e8f5e9"><td colspan="4" style="padding:10px"><strong>üí∞ –î–û–•–û–î–´</strong></td></tr>
                            <tr><td style="padding:12px">–ß–ª–µ–Ω—Å–∫–∏–µ –≤–∑–Ω–æ—Å—ã</td><td>45 000</td><td>42 000</td><td style="color:#4caf50">+7.1%</td></tr>
                            <tr style="background:#f9fafb"><td style="padding:12px">–ü–∞–µ–≤—ã–µ –≤–∑–Ω–æ—Å—ã</td><td>120 000</td><td>85 000</td><td style="color:#4caf50">+41.2%</td></tr>
                            <tr><td style="padding:12px">–ü—Ä–æ—Ü–µ–Ω—Ç—ã –ø–æ –∑–∞–π–º–∞–º</td><td>35 000</td><td>38 000</td><td style="color:#f44336">-7.9%</td></tr>
                            <tr style="background:#e3f2fd;font-weight:600"><td style="padding:12px">–ò–¢–û–ì–û –î–û–•–û–î–´</td><td>212 000</td><td>180 000</td><td style="color:#4caf50">+17.8%</td></tr>
                            <tr style="background:#ffebee"><td colspan="4" style="padding:10px"><strong>üí∏ –†–ê–°–•–û–î–´</strong></td></tr>
                            <tr><td style="padding:12px">–û–ø–ª–∞—Ç–∞ —Ç—Ä—É–¥–∞</td><td>85 000</td><td>85 000</td><td>0%</td></tr>
                            <tr style="background:#f9fafb"><td style="padding:12px">–ù–∞–ª–æ–≥–∏</td><td>12 720</td><td>10 800</td><td style="color:#f44336">+17.8%</td></tr>
                            <tr style="background:#e3f2fd;font-weight:600"><td style="padding:12px">–ò–¢–û–ì–û –†–ê–°–•–û–î–´</td><td>140 720</td><td>142 800</td><td style="color:#4caf50">-1.5%</td></tr>
                            <tr style="background:#e8f5e9;font-weight:700;font-size:15px"><td style="padding:12px">üéØ –ü–†–ò–ë–´–õ–¨</td><td>71 280</td><td>37 200</td><td style="color:#4caf50">+91.6%</td></tr>
                        </tbody>
                    </table>
                </div>
            `;
            openLargeReport('P&L (–û—Ç—á–µ—Ç –æ –ø—Ä–∏–±—ã–ª—è—Ö –∏ —É–±—ã—Ç–∫–∞—Ö)', content);
        }

        function openCashFlow() {
            const content = `
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:20px">
                    <div style="padding:20px;background:#e8f5e9;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–í—Ö–æ–¥—è—â–∏–π –ø–æ—Ç–æ–∫</div><div style="font-size:24px;font-weight:700">222 000 ‚ÇΩ</div></div>
                    <div style="padding:20px;background:#ffebee;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–ò—Å—Ö–æ–¥—è—â–∏–π –ø–æ—Ç–æ–∫</div><div style="font-size:24px;font-weight:700">338 000 ‚ÇΩ</div></div>
                    <div style="padding:20px;background:#ffebee;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–°–∞–ª—å–¥–æ –∑–∞ –ø–µ—Ä–∏–æ–¥</div><div style="font-size:24px;font-weight:700;color:#f44336">‚àí116 000 ‚ÇΩ</div></div>
                    <div style="padding:20px;background:#e3f2fd;border-radius:12px"><div style="font-size:12px;color:#666;margin-bottom:8px">–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω–µ—Ü</div><div style="font-size:24px;font-weight:700">334 000 ‚ÇΩ</div></div>
                </div>
                <div style="background:#fff;border-radius:8px;overflow:hidden">
                    <table style="width:100%;border-collapse:collapse;font-size:13px">
                        <thead><tr style="background:#f5f7fa"><th style="padding:12px;text-align:left">–ü–æ—Ç–æ–∫</th><th>–í—Ö–æ–¥—è—â–∏–π</th><th>–ò—Å—Ö–æ–¥—è—â–∏–π</th><th>–°–∞–ª—å–¥–æ</th></tr></thead>
                        <tbody>
                            <tr style="background:#e8f5e9"><td colspan="4" style="padding:10px"><strong>üè¶ –û–ü–ï–†–ê–¶–ò–û–ù–ù–ê–Ø</strong></td></tr>
                            <tr><td style="padding:12px">–í–∑–Ω–æ—Å—ã –æ—Ç –ø–∞–π—â–∏–∫–æ–≤</td><td>165 000</td><td>‚Äî</td><td style="color:#4caf50">+165 000</td></tr>
                            <tr style="background:#f9fafb"><td style="padding:12px">–ü–æ–≥–∞—à–µ–Ω–∏–µ –∑–∞–π–º–æ–≤</td><td>45 000</td><td>‚Äî</td><td style="color:#4caf50">+45 000</td></tr>
                            <tr><td style="padding:12px">–í—ã–¥–∞—á–∞ –∑–∞–π–º–æ–≤</td><td>‚Äî</td><td>120 000</td><td style="color:#f44336">‚àí120 000</td></tr>
                            <tr style="background:#e3f2fd;font-weight:600"><td style="padding:12px">–ò—Ç–æ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π</td><td>222 000</td><td>233 000</td><td style="color:#f44336">‚àí11 000</td></tr>
                            <tr style="background:#e3f2fd;font-weight:700"><td style="padding:12px">üìä –ò–¢–û–ì–û</td><td>222 000</td><td>338 000</td><td style="color:#f44336">‚àí116 000</td></tr>
                        </tbody>
                    </table>
                </div>
            `;
            openLargeReport('Cash Flow (–î–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤)', content);
        }

        function openAccountAnalysis() { openLargeReport('–ê–Ω–∞–ª–∏–∑ —Å—á–µ—Ç–∞', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìà</div><div style="font-size:16px;color:#666">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á–µ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div><select style="padding:12px;margin-top:20px;border:1px solid #e0e0e0;border-radius:6px;font-size:14px"><option>50 - –ö–∞—Å—Å–∞</option><option>51 - –†–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞</option><option>86-1 - –ü–∞–µ–≤–æ–π —Ñ–æ–Ω–¥</option></select></div>'); }
        function openAccountCard() { openLargeReport('–ö–∞—Ä—Ç–æ—á–∫–∞ —Å—á–µ—Ç–∞', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìã</div><div style="font-size:16px;color:#666">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á–µ—Ç –∏ –ø–µ—Ä–∏–æ–¥</div></div>'); }
        function openJournal() { openLargeReport('–ñ—É—Ä–Ω–∞–ª-–æ—Ä–¥–µ—Ä', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìñ</div><div style="font-size:16px;color:#666">–ñ—É—Ä–Ω–∞–ª-–æ—Ä–¥–µ—Ä –∑–∞ –Ø–Ω–≤–∞—Ä—å 2024</div></div>'); }
        function openMainBook() { openLargeReport('–ì–ª–∞–≤–Ω–∞—è –∫–Ω–∏–≥–∞', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìí</div><div style="font-size:16px;color:#666">–ì–ª–∞–≤–Ω–∞—è –∫–Ω–∏–≥–∞ –∑–∞ 2024 –≥–æ–¥</div></div>'); }
        function openBalance() { openLargeReport('–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å (–§-1)', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚öñÔ∏è</div><div style="font-size:16px;color:#666">–ë–∞–ª–∞–Ω—Å –Ω–∞ 31.12.2023</div></div>'); }
        function openUSN() { openLargeReport('–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –ø–æ –£–°–ù', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìã</div><div style="font-size:16px;color:#666">–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –∑–∞ 2023 –≥–æ–¥</div></div>'); }
        function openKUDiR() { openLargeReport('–ö–£–î–∏–†', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìñ</div><div style="font-size:16px;color:#666">–ö–Ω–∏–≥–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ 2024 –≥–æ–¥</div></div>'); }
        function open6NDFL() { openLargeReport('6-–ù–î–§–õ', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìä</div><div style="font-size:16px;color:#666">–†–∞—Å—á–µ—Ç 6-–ù–î–§–õ –∑–∞ 2024 –≥–æ–¥</div></div>'); }
        function open2NDFL() { openLargeReport('2-–ù–î–§–õ', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìÑ</div><div style="font-size:16px;color:#666">–°–ø—Ä–∞–≤–∫–∏ 2-–ù–î–§–õ –∑–∞ 2023 –≥–æ–¥</div></div>'); }
        function openInsurance() { openLargeReport('–†–∞—Å—á–µ—Ç —Å—Ç—Ä–∞—Ö–æ–≤—ã—Ö –≤–∑–Ω–æ—Å–æ–≤', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üí∞</div><div style="font-size:16px;color:#666">–†–∞—Å—á–µ—Ç –∑–∞ 1 –∫–≤–∞—Ä—Ç–∞–ª 2024</div></div>'); }
        function openManagementBalance() { openLargeReport('–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚öñÔ∏è</div><div style="font-size:16px;color:#666">–ë–∞–ª–∞–Ω—Å –Ω–∞ 31.01.2024</div></div>'); }
        function openDebtors() { openLargeReport('–î–µ–±–∏—Ç–æ—Ä—Å–∫–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìà</div><div style="font-size:16px;color:#666">–ê–Ω–∞–ª–∏–∑ –¥–µ–±–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏</div></div>'); }
        function openCreditors() { openLargeReport('–ö—Ä–µ–¥–∏—Ç–æ—Ä—Å–∫–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìâ</div><div style="font-size:16px;color:#666">–ê–Ω–∞–ª–∏–∑ –∫—Ä–µ–¥–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏</div></div>'); }
        function openMembersRegistry() { openLargeReport('–†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤', '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìã</div><div style="font-size:16px;color:#666">–ü–æ–ª–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div></div>'); }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ë—É—Ä–≥–µ—Ä –º–µ–Ω—é - –æ—Ç–∫—Ä—ã—Ç—å –ª–µ–≤–æ–µ –º–µ–Ω—é
            document.getElementById('burgerBtn').addEventListener('click', () => {
                document.getElementById('sidebarMenu').classList.add('visible');
                document.getElementById('chatsPanel').classList.add('hidden');
            });

            // –ó–∞–∫—Ä—ã—Ç—å –ª–µ–≤–æ–µ –º–µ–Ω—é
            document.getElementById('menuCloseBtn').addEventListener('click', () => {
                document.getElementById('sidebarMenu').classList.remove('visible');
                document.getElementById('chatsPanel').classList.remove('hidden');
            });

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            document.getElementById('sendButton').addEventListener('click', sendMessage);
            document.getElementById('messageInput').addEventListener('keypress', e => { if(e.key==='Enter') sendMessage(); });

            // –ó–∞–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
            document.getElementById('closeDetailsBtn').addEventListener('click', () => {
                document.getElementById('operationDetailsPanel').classList.remove('visible');
            });

            // –ó–∞–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ
            document.getElementById('closeInfoBtn').addEventListener('click', () => {
                document.getElementById('sidebarRight').classList.remove('visible');
            });

            // –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ª–µ–≤–æ–≥–æ –º–µ–Ω—é
            document.getElementById('closePanelBtn').addEventListener('click', () => {
                document.getElementById('menuContentPanel').classList.remove('visible');
            });

            // –û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ (3 —Ç–æ—á–∫–∏)
            document.getElementById('menuMoreBtn').addEventListener('click', showMemberInfo);

            // FAB –∫–Ω–æ–ø–∫–∞ - –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –º–µ–Ω—é
            document.getElementById('fabMain').addEventListener('click', toggleFab);

            // –ü–æ–∏—Å–∫
            document.getElementById('searchInput').addEventListener('input', e => {
                const term = e.target.value.toLowerCase();
                document.querySelectorAll('.chat-item').forEach(item => {
                    const name = item.querySelector('.chat-name')?.textContent.toLowerCase() || '';
                    item.style.display = name.includes(term) ? 'flex' : 'none';
                });
            });

            // –§–∏–ª—å—Ç—Ä—ã
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.addEventListener('click', () => {
                    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                });
            });

            // –ö–ª–∏–∫ –≤–Ω–µ FAB –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é
            document.addEventListener('click', e => {
                if(fabExpanded && !e.target.closest('.fab-container')) toggleFab();
            });

            // –ö–ª–∏–∫ –≤–Ω–µ –ø–æ–¥–º–µ–Ω—é –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –µ–≥–æ
            document.addEventListener('click', e => {
                if(!e.target.closest('.reports-submenu') && !e.target.closest('.sidebar-menu')) {
                    closeReportsSubmenu();
                }
            });
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ FAB –º–µ–Ω—é (—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å/—Å–≤–µ—Ä–Ω—É—Ç—å)
        function toggleFab() {
            fabExpanded = !fabExpanded;
            document.getElementById('fabMain').classList.toggle('close');
            document.getElementById('fabMenu').classList.toggle('expanded');
        }

        function sendMessage() {
            const text = document.getElementById('messageInput').value.trim();
            if(!text || !currentMember) return;
            currentMember.operations.push({ id: Date.now(), type: "–°–æ–æ–±—â–µ–Ω–∏–µ", amount: 0, date: new Date().toISOString().split('T')[0], description: text, status: "paid" });
            renderMessages(currentMember.operations);
            document.getElementById('messageInput').value = '';
        }

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>
