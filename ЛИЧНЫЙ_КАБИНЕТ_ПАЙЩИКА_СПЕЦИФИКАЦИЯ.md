# 🏠 ЛИЧНЫЙ КАБИНЕТ ПАЙЩИКА: ПОЛНАЯ СПЕЦИФИКАЦИЯ

**Версия:** 2.0  
**Дата:** 20 февраля 2026  
**Статус:** ✅ Готово

---

## 📋 СОДЕРЖАНИЕ

1. [Концепция](#1-концепция)
2. [Архитектура](#2-архитектура)
3. [Структура данных](#3-структура-данных)
4. [Функционал](#4-функционал)
5. [Процессы](#5-процессы)
6. [Интерфейсы](#6-интерфейсы)
7. [Безопасность](#7-безопасность)
8. [План реализации](#8-план-реализации)

---

## 1. КОНЦЕПЦИЯ

### 1.1 Основная идея

Пайщик может быть членом **нескольких кооперативов** одновременно. Система предоставляет:

- ✅ **Единый вход** для всех кооперативов
- ✅ **Реестр всех кооперативов** в платформе КООПЕРАНТ
- ✅ **Поиск кооперативов** для вступления
- ✅ **Управление членством** в каждом кооперативе
- ✅ **Сверка данных** между пайщиком и кооперативом

### 1.2 Ключевые сущности

```
┌─────────────────────────────────────────────────────────┐
│                    ПАЙЩИК                               │
│  (физическое или юридическое лицо)                      │
│                                                         │
│  Яндекс.Диск: personal@yandex.ru                        │
│  ID: 79001234567 (телефон)                              │
│                                                         │
│  Членство в кооперативах:                               │
│  ├── 🟢 КПК «Первый» (активный)                         │
│  ├── 🟢 СПК «Агро» (активный)                           │
│  └── 🔴 ЖСК «Дом» (приостановлен)                       │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│                 КООПЕРАТИВ                              │
│  (потребительское общество)                             │
│                                                         │
│  Яндекс.Диск: coop1@yandex.ru                           │
│  ИНН: 1234567890                                        │
│  Название: КПК «Первый»                                 │
│                                                         │
│  Пайщики: 150 человек                                   │
│  Реестр: /КООПЕРАНТ/members.json                        │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│              РЕЕСТР КООПЕРАТИВОВ                        │
│  (централизованный каталог)                             │
│                                                         │
│  Хранение: Облако КООПЕРАНТ                             │
│  Доступ: Публичный (чтение)                             │
│                                                         │
│  Содержит:                                              │
│  - Все зарегистрированные кооперативы                   │
│  - Контактную информацию                                │
│  - Статус деятельности                                  │
│  - Ссылку на Яндекс.Диск кооператива                    │
└─────────────────────────────────────────────────────────┘
```

---

## 2. АРХИТЕКТУРА

### 2.1 Общая схема

```
┌──────────────────────────────────────────────────────────────────┐
│                     ПЛАТФОРМА КООПЕРАНТ                          │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                    РЕЕСТР КООПЕРАТИВОВ                     │ │
│  │                    (централизованный)                      │ │
│  │                                                            │ │
│  │  cooperatives.json (облачное хранилище КООПЕРАНТ)          │ │
│  │  ├── {id, name, inn, region, status, disk_url, ...}        │ │
│  │  └── Доступ: чтение (публично), запись (админ)             │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌─────────────────┐              ┌─────────────────────────┐   │
│  │  КООПЕРАТИВ 1   │              │    ПАЙЩИК               │   │
│  │  Яндекс.Диск    │              │  Яндекс.Диск            │   │
│  │                 │              │                         │   │
│  │  /КООПЕРАНТ/    │              │  /КООПЕРАНТ/            │   │
│  │    /members.json│◄────────────►│    /ПАЙЩИК/             │   │
│  │                 │  синхрон.    │      profile.json       │   │
│  │                 │              │    /КООПЕРАТИВ/         │   │
│  │                 │              │      /cooperatives/     │   │
│  │                 │              │        coop_001/        │   │
│  └─────────────────┘              │          data.json      │   │
│                                   └─────────────────────────┘   │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

### 2.2 Структура папок на Яндекс.Диске пайщика

```
/КООПЕРАНТ/
│
├── /ПАЙЩИК/                    ← Личные данные пайщика
│   ├── profile.json            │   ← Профиль (ФИО, контакты)
│   └── applications.json       │   ← Заявления (поданные в кооперативы)
│
└── /КООПЕРАТИВ/                ← Данные по кооперативам (членство)
    └── /cooperatives/
        ├── coop_001/           │   ← КПК "Первый"
        │   └── data.json       │   │   ← Данные членства
        ├── coop_002/           │   ← СПК "Агро"
        │   └── data.json       │   │   ← Данные членства
        └── coop_003/           │   ← ЖСК "Дом"
            └── data.json       │   ← Данные членства
```

### 2.3 Типы пайщиков

**Важно:** Кооператив сам может быть пайщиком в другом кооперативе!

| Тип | Описание | Пример |
|-----|----------|--------|
| **individual** | Физическое лицо | Иванов И.И. |
| **legal** | Юридическое лицо | ООО "Ромашка" |
| **cooperative** | Другой кооператив | КПК "Первый" |
│  │    members.json │◄────────────►│    memberships.json     │   │
│  │    payments.json│  синхрон.    │    cooperatives/        │   │
│  │    reports/     │              │      coop1/             │   │
│  │                 │              │      coop2/             │   │
│  └─────────────────┘              └─────────────────────────┘   │
│                                                                  │
│  ┌─────────────────┐              ┌─────────────────────────┐   │
│  │  КООПЕРАТИВ 2   │              │    ПАЙЩИК 2             │   │
│  │  Яндекс.Диск    │              │  Яндекс.Диск            │   │
│  │  /КООПЕРАНТ/    │              │  /КООПЕРАНТ/            │   │
│  └─────────────────┘              └─────────────────────────┘   │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

### 2.2 Уровни доступа

```
┌─────────────────────────────────────────────────────────────┐
│                    УРОВНИ ДОСТУПА                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1️⃣ ПУБЛИЧНЫЙ (без авторизации)                            │
│     • Поиск кооперативов                                    │
│     • Просмотр информации о кооперативе                     │
│     • Подача заявления на вступление                        │
│                                                             │
│  2️⃣ ПАЙЩИК (авторизация)                                   │
│     • Все мои кооперативы                                   │
│     • Данные по каждому кооперативу                         │
│     • Синхронизация с кооперативом                          │
│     • Заявления в кооператив                                │
│                                                             │
│  3️⃣ АДМИНИСТРАТОР КОПЕРАТИВА                               │
│     • Управление реестром пайщиков                          │
│     • Подтверждение заявлений                               │
│     • Синхронизация данных                                  │
│     • Отчётность                                            │
│                                                             │
│  4️⃣ СУПЕР-АДМИН (КООПЕРАНТ)                                │
│     • Управление реестром кооперативов                      │
│     • Регистрация новых кооперативов                        │
│     • Мониторинг системы                                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. СТРУКТУРА ДАННЫХ

### 3.1 Реестр кооперативов (cooperatives.json)

**Расположение:** Облачное хранилище КООПЕРАНТ

```json
{
  "cooperatives": [
    {
      "id": "coop_001",
      "name": "КПК \"Первый\"",
      "inn": "1234567890",
      "ogrn": "1234567890123",
      "region": "Москва",
      "address": "г. Москва, ул. Примерная, д. 1",
      "phone": "+7 (495) 123-45-67",
      "email": "info@koop1.ru",
      "website": "https://koop1.ru",
      "status": "active",
      "type": "credit",
      "registeredAt": "2020-01-15T10:00:00Z",
      "yandexDisk": {
        "email": "koop1@yandex.ru",
        "folderId": "abc123",
        "publicLink": "https://disk.yandex.ru/d/abc123"
      },
      "stats": {
        "membersCount": 150,
        "shareCapital": 5000000,
        "foundedYear": 2020
      },
      "description": "Кредитный потребительский кооператив",
      "logo": "https://disk.yandex.ru/.../logo.png"
    },
    {
      "id": "coop_002",
      "name": "СПК \"Агро\"",
      "inn": "9876543210",
      "status": "active",
      "type": "agricultural",
      "region": "Краснодарский край",
      "yandexDisk": {
        "email": "agro@yandex.ru",
        "folderId": "xyz789"
      },
      "stats": {
        "membersCount": 75,
        "shareCapital": 2500000,
        "foundedYear": 2018
      }
    }
  ],
  "lastUpdated": "2026-02-19T12:00:00Z",
  "totalCount": 2
}
```

### 3.2 Профиль пайщика (member_profile.json)

**Расположение:** Яндекс.Диск пайщика /КООПЕРАНТ/

```json
{
  "profile": {
    "id": "79001234567",
    "type": "individual",
    "name": "Иванов Иван Иванович",
    "birthDate": "1980-05-15",
    "phone": "+79001234567",
    "email": "ivanov@example.com",
    "passport": {
      "series": "1234",
      "number": "567890",
      "issuedBy": "УФМС России",
      "issuedDate": "2010-01-15",
      "code": "123-456"
    },
    "address": {
      "registration": "г. Москва, ул. Примерная, д. 1, кв. 1",
      "residence": "г. Москва, ул. Примерная, д. 1, кв. 1"
    },
    "registeredAt": "2026-02-19T10:00:00Z",
    "yandexDisk": {
      "email": "ivanov@yandex.ru",
      "token": "***"
    }
  },
  "memberships": [
    {
      "cooperativeId": "coop_001",
      "cooperativeName": "КПК \"Первый\"",
      "memberId": "79001234567",
      "status": "active",
      "joinDate": "2023-03-15",
      "shareAmount": 100000,
      "paidAmount": 100000,
      "debt": 0,
      "lastSync": "2026-02-19T12:00:00Z",
      "certificateNumber": "001-2023",
      "role": "member"
    },
    {
      "cooperativeId": "coop_002",
      "cooperativeName": "СПК \"Агро\"",
      "memberId": "79001234567",
      "status": "active",
      "joinDate": "2024-06-20",
      "shareAmount": 50000,
      "paidAmount": 50000,
      "debt": 0,
      "lastSync": "2026-02-19T11:30:00Z",
      "certificateNumber": "025-2024",
      "role": "member"
    }
  ],
  "applications": [
    {
      "id": "app_001",
      "cooperativeId": "coop_003",
      "cooperativeName": "ЖСК \"Дом\"",
      "type": "join",
      "status": "pending",
      "submittedAt": "2026-02-18T15:00:00Z",
      "documents": ["passport.pdf", "application.pdf"]
    }
  ]
}
```

### 3.3 Данные членства в кооперативе (cooperatives/[id]/data.json)

**Расположение:** Яндекс.Диск пайщика /КООПЕРАНТ/cooperatives/coop_001/

```json
{
  "cooperativeInfo": {
    "id": "coop_001",
    "name": "КПК \"Первый\"",
    "inn": "1234567890",
    "logo": "https://..."
  },
  "memberData": {
    "memberId": "79001234567",
    "name": "Иванов Иван Иванович",
    "status": "active",
    "joinDate": "2023-03-15",
    "certificateNumber": "001-2023",
    "contact": {
      "phone": "+79001234567",
      "email": "ivanov@example.com",
      "address": "г. Москва, ул. Примерная, д. 1, кв. 1"
    }
  },
  "payments": [
    {
      "id": "pay_001",
      "type": "share",
      "typeName": "Обязательный паевой взнос",
      "amount": 100000,
      "paid": 100000,
      "date": "2023-03-15",
      "documentNumber": "ПКО-001"
    },
    {
      "id": "pay_002",
      "type": "membership",
      "typeName": "Членский взнос 2026",
      "amount": 5000,
      "paid": 5000,
      "date": "2026-01-10",
      "documentNumber": "ПКО-015"
    }
  ],
  "transactions": [
    {
      "id": "tr_001",
      "date": "2023-03-15",
      "amount": 100000,
      "description": "Внесение паевого взноса",
      "documentNumber": "ПКО-001"
    }
  ],
  "documents": [
    {
      "id": "doc_001",
      "name": "Удостоверение пайщика",
      "type": "certificate",
      "fileUrl": "https://disk.yandex.ru/.../cert_001.pdf",
      "issuedAt": "2023-03-15"
    },
    {
      "id": "doc_002",
      "name": "Справка о взносах",
      "type": "reference",
      "fileUrl": "https://disk.yandex.ru/.../ref_001.pdf",
      "issuedAt": "2026-02-01"
    }
  ],
  "meetings": [
    {
      "id": "meet_001",
      "type": "general",
      "date": "2026-03-15T10:00:00Z",
      "topic": "Годовое общее собрание",
      "status": "scheduled",
      "invited": true
    }
  ],
  "syncStatus": {
    "lastSync": "2026-02-19T12:00:00Z",
    "status": "synced",
    "discrepancies": []
  }
}
```

---

## 4. ФУНКЦИОНАЛ

### 4.1 Публичные функции (без авторизации)

#### 4.1.1 Поиск кооперативов

```
┌─────────────────────────────────────────────────────────┐
│  🔍 Поиск кооперативов                                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  [Введите название, ИНН или регион ____________] 🔍    │
│                                                         │
│  Фильтры:                                               │
│  ☑️ Регион: [Все ▼]                                    │
│  ☑️ Тип: [Все ▼]                                       │
│    • Кредитные                                          │
│    • Сельскохозяйственные                               │
│    • Жилищные                                           │
│    • Гаражные                                           │
│  ☑️ Статус: [Активные ▼]                               │
│                                                         │
│  Найдено: 15 кооперативов                               │
│                                                         │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 🏢 КПК \"Первый\"                                  │ │
│  │    📍 Москва | 👥 150 пайщиков | 💰 5 млн ₽      │ │
│  │    📞 +7 (495) 123-45-67                          │ │
│  │    [Подробнее] [Подать заявление]                 │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 🌾 СПК \"Агро\"                                    │ │
│  │    📍 Краснодарский край | 👥 75 пайщиков        │ │
│  │    💰 2.5 млн ₽                                   │ │
│  │    [Подробнее] [Подать заявление]                 │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 4.1.2 Карточка кооператива

```
┌─────────────────────────────────────────────────────────┐
│  🏢 КПК \"Первый\"                                       │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  📊 Основная информация                                 │
│  ┌───────────────────────────────────────────────────┐ │
│  │ ИНН: 1234567890                                   │ │
│  │ ОГРН: 1234567890123                               │ │
│  │ Тип: Кредитный потребительский кооператив         │ │
│  │ Регион: Москва                                    │ │
│  │ Адрес: г. Москва, ул. Примерная, д. 1             │ │
│  │ Телефон: +7 (495) 123-45-67                       │ │
│  │ Email: info@koop1.ru                              │ │
│  │ Сайт: https://koop1.ru                            │ │
│  │ Статус: ✅ Действующий                            │ │
│  │ Зарегистрирован: 15.01.2020                       │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  📈 Показатели                                          │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 👥 Пайщиков: 150                                  │ │
│  │ 💰 Паевой фонд: 5 000 000 ₽                       │ │
│  │ 📅 Год основания: 2020                            │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  📄 Документы                                           │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 📋 Устав (выписка)                                │ │
│  │ 📑 Свидетельство о регистрации                    │ │
│  │ 📊 Бухгалтерский баланс (публичный)               │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  📨 Вступление                                          │
│  ┌───────────────────────────────────────────────────┐ │
│  │ Условия вступления:                               │ │
│  │ • Вступительный взнос: 1 000 ₽                    │ │
│  │ • Обязательный пай: от 10 000 ₽                   │ │
│  │ • Членский взнос: 5 000 ₽/год                     │ │
│  │                                                   │ │
│  │ [Подать заявление на вступление]                  │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  [← Назад]                                              │
└─────────────────────────────────────────────────────────┘
```

### 4.2 Личный кабинет пайщика (авторизация)

#### 4.2.1 Главная страница

```
┌─────────────────────────────────────────────────────────┐
│  👤 Личный кабинет пайщика                              │
│  Иванов Иван Иванович | 79001234567 | ⚙️              │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  📊 Мои кооперативы (3)                                │
│                                                         │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 🏢 КПК \"Первый\"                      ✅ Активно   │ │
│  │    💰 Взносы: 105 000 ₽ | 📋 №001-2023           │ │
│  │    🔄 Синхронизировано: 2 часа назад             │ │
│  │    [Открыть] [Документы] [Заявления]             │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 🌾 СПК \"Агро\"                        ✅ Активно   │ │
│  │    💰 Взносы: 55 000 ₽ | 📋 №025-2024            │ │
│  │    🔄 Синхронизировано: вчера                    │ │
│  │    [Открыть] [Документы] [Заявления]             │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 🏠 ЖСК \"Дом\"                         ⏳ Заявление │ │
│  │    📄 Заявление на рассмотрении                  │ │
│  │    📅 Подано: 18.02.2026                         │ │
│  │    [Проверить статус] [Отменить]                 │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  ┌───────────────────────────────────────────────────┐ │
│  │ ➕ Вступить в новый кооператив                    │ │
│  │    [Найти кооператив]                            │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 4.2.2 Детальная информация по кооперативу

```
┌─────────────────────────────────────────────────────────┐
│  ← Назад | 🏢 КПК \"Первый\"                              │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  📊 Статус членства                                     │
│  ┌───────────────────────────────────────────────────┐ │
│  │ ✅ Активный член кооператива                      │ │
│  │ 📋 Удостоверение: №001-2023                       │ │
│  │ 📅 Дата вступления: 15.03.2023                    │ │
│  │ Стаж: 2 года 11 месяцев                           │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  💰 Финансовая сводка                                   │
│  ┌───────────────────────────────────────────────────┐ │
│  │ Внесено:           105 000 ₽  ✅                 │ │
│  │ ├─ Обязательный пай: 100 000 ₽                  │ │
│  │ ├─ Добровольные:     5 000 ₽                    │ │
│  │ └─ Членские (2026):  5 000 ₽                    │ │
│  │                                                   │ │
│  │ Задолженность:     0 ₽  ✅                       │ │
│  │ Действ. стоимость пая: 120 000 ₽                │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  📈 История операций                                    │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 10.02.2026 | Членский взнос 2026                 │ │
│  │            | +5 000 ₽ | ПКО-015 | ✅             │ │
│  │                                                   │ │
│  │ 15.01.2026 | Членский взнос 2025                 │ │
│  │            | +5 000 ₽ | ПКО-142 | ✅             │ │
│  │                                                   │ │
│  │ 20.03.2023 | Добровольный пай                    │ │
│  │            | +5 000 ₽ | ПКО-025 | ✅             │ │
│  │                                                   │ │
│  │ 15.03.2023 | Обязательный пай                    │ │
│  │            | +100 000 ₽ | ПКО-001 | ✅           │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  📄 Документы                                           │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 📋 Удостоверение пайщика           [Скачать PDF] │ │
│  │ 📊 Справка о взносах 2025          [Скачать PDF] │ │
│  │ 📝 Протокол собрания №5            [Скачать PDF] │ │
│  │ + Добавить запрос справки         [Запросить]   │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  📅 Собрания                                            │
│  ┌───────────────────────────────────────────────────┐ │
│  │ 📋 Годовое общее собрание                         │ │
│  │ 📅 15.03.2026 в 10:00                             │ │
│  │ 📍 г. Москва, ул. Примерная, д. 1                 │ │
│  │ [Подтвердить участие] [Задать вопрос]             │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  ⚙️ Синхронизация                                       │
│  ┌───────────────────────────────────────────────────┐ │
│  │ Последняя синхронизация: 2 часа назад             │ │
│  │ Статус: ✅ Данные актуальны                       │ │
│  │ [Синхронизировать сейчас]                         │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 4.3 Подача заявления на вступление

```
┌─────────────────────────────────────────────────────────┐
│  📨 Заявление на вступление в кооператив                │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  Кооператив: 🏢 КПК \"Первый\"                            │
│                                                         │
│  📋 Данные заявителя                                    │
│  ┌───────────────────────────────────────────────────┐ │
│  │ ФИО: [Иванов Иван Иванович _____________________] │ │
│  │ Дата рождения: [15.05.1980] 📅                    │ │
│  │ Телефон: [+7 (900) 123-45-67]                     │ │
│  │ Email: [ivanov@example.com]                       │ │
│  │ Паспорт: [серия] [номер] [кем выдан] [дата]       │ │
│  │ Адрес регистрации: [____________________________] │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  💰 Параметры вступления                                │
│  ┌───────────────────────────────────────────────────┐ │
│  │ Вступительный взнос: 1 000 ₽                      │ │
│  │ Обязательный пай: [10 000 ₽] (мин. 10 000 ₽)      │ │
│  │ Добровольный пай: [0 ₽]                           │ │
│  │                                                   │ │
│  │ Способ оплаты:                                    │ │
│  │   ☑️ Наличный                                     │ │
│  │   ☐ Безналичный                                   │ │
│  │   ☐ Имущественный                                 │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  📎 Прикрепляемые документы                             │
│  ┌───────────────────────────────────────────────────┐ │
│  │ □ Паспорт (скан)                    [Загрузить]  │ │
│  │ □ ИНН (скан)                        [Загрузить]  │ │
│  │ □ Другие документы                  [Загрузить]  │ │
│  └───────────────────────────────────────────────────┘ │
│                                                         │
│  ☑️ Я согласен с уставом кооператива                    │
│  ☑️ Я согласен на обработку персональных данных         │
│                                                         │
│  [Отправить заявление] [Отмена]                         │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 5. ПРОЦЕССЫ

### 5.1 Регистрация пайщика в системе

```
┌─────────────────────────────────────────────────────────┐
│                 РЕГИСТРАЦИЯ ПАЙЩИКА                     │
└─────────────────────────────────────────────────────────┘

  1. Пайщик открывает member-cabinet.html
          │
          ▼
  2. Авторизация через Яндекс (OAuth)
          │
          ▼
  3. Создание профиля в /КООПЕРАНТ/member_profile.json
          │
          ▼
  4. Проверка: есть ли уже членство в кооперативах?
          │
     ┌────┴────┐
     │  ДА     │  НЕТ
     │         │
     ▼         ▼
  Показываем  Предлагаем
  кооперативы найти кооператив
```

### 5.2 Вступление в новый кооператив

```
┌─────────────────────────────────────────────────────────┐
│              ВСТУПЛЕНИЕ В КООПЕРАТИВ                    │
└─────────────────────────────────────────────────────────┘

  1. Пайщик ищет кооператив в реестре
          │
          ▼
  2. Просматривает информацию о кооперативе
          │
          ▼
  3. Заполняет заявление на вступление
          │
          ▼
  4. Заявление сохраняется в:
     • Яндекс.Диск пайщика: /applications/[id].json
     • Отправляется в кооператив
          │
          ▼
  5. Кооператив получает уведомление
          │
          ▼
  6. Бухгалтер/председатель рассматривает заявление
          │
     ┌────┴────┐
     │Одобрено │  Отклонено
     │         │
     ▼         ▼
  Создаётся   Статус:
  запись в    rejected
  members.json│
          │   │
          ▼   ▼
  Пайщик получает уведомление
  Статус обновляется в профиле
```

### 5.3 Синхронизация данных

```
┌─────────────────────────────────────────────────────────┐
│                 СИНХРОНИЗАЦИЯ ДАННЫХ                    │
└─────────────────────────────────────────────────────────┘

  1. Пайщик нажимает «Синхронизировать»
          │
          ▼
  2. Загрузка данных из кооператива:
     • /КООПЕРАНТ/members.json (реестр)
     • /КООПЕРАНТ/payments.json (взносы)
          │
          ▼
  3. Поиск пайщика по ID (телефон/ID)
          │
          ▼
  4. Сравнение данных (member-compare.js)
          │
     ┌────┴────────────┐
     │  Есть отличия   │  Нет отличий
     │                 │
     ▼                 ▼
  Показываем       Статус:
  расхождения      ✅ Синхронизировано
     │
     ▼
  Пайщик выбирает:
  • Запросить исправление
  • Принять версию кооператива
     │
     ▼
  Обновление данных
  в профиле пайщика
```

### 5.4 Сверка данных при расхождениях

```
┌─────────────────────────────────────────────────────────┐
│                    СВЕРКА ДАННЫХ                        │
└─────────────────────────────────────────────────────────┘

  Пример расхождений:
  
  ┌─────────────────────────────────────────────────────┐
  │ ⚠️ Обнаружены расхождения в данных                  │
  ├─────────────────────────────────────────────────────┤
  │ Поле          │ У вас         │ В кооперативе     │
  ├───────────────┼───────────────┼───────────────────┤
  │ Адрес         │ ул.Мира, 10   │ пр.Ленина, 5      │
  │ Телефон       │ +79001112222  │ +79003334444      │
  │ Email         │ old@mail.ru   │ new@mail.ru       │
  └─────────────────────────────────────────────────────┘
  
  Что делать?
  
  [Запросить исправление] → Заявление в кооператив
  [Принять версию кооператива] → Обновить профиль
  [Игнорировать] → Отложить на потом
```

---

## 6. ИНТЕРФЕЙСЫ

### 6.1 Список файлов

```
d:\!Минкооп_рф\! КООП\
├── member-cabinet.html          ← Личный кабинет пайщика
├── member-search.html           ← Поиск кооперативов
├── member-coop-detail.html      ← Детали кооператива
├── member-application.html      ← Подача заявления
│
├── js/
│   ├── member-app.js            ← Основная логика
│   ├── member-registry.js       ← Реестр кооперативов
│   ├── member-sync.js           ← Синхронизация
│   ├── member-compare.js        ← Сравнение данных
│   ├── member-applications.js   ← Заявления
│   └── member-search.js         ← Поиск
│
├── css/
│   └── member-styles.css        ← Стили кабинета
│
└── data/
    ├── cooperatives.json        ← Реестр кооперативов (пример)
    └── member-profile-template.json
```

### 6.2 Глобальные функции

```javascript
// member-app.js
window.MemberCabinet = {
    // Инициализация
    init: function() {},
    
    // Авторизация
    authenticate: function(yandexToken) {},
    loadProfile: function() {},
    saveProfile: function() {},
    
    // Кооперативы
    loadCooperatives: function() {},
    getMembership: function(coopId) {},
    updateMembership: function(coopId, data) {},
    
    // Синхронизация
    syncWithCooperative: function(coopId) {},
    compareData: function(localData, remoteData) {},
    resolveDiscrepancy: function(coopId, field, choice) {},
    
    // Заявления
    submitApplication: function(coopId, applicationData) {},
    getApplicationStatus: function(applicationId) {},
    cancelApplication: function(applicationId) {},
    
    // Документы
    requestDocument: function(coopId, docType) {},
    downloadDocument: function(docId) {}
};

// member-registry.js
window.CooperativeRegistry = {
    search: function(query, filters) {},
    getCooperative: function(id) {},
    getAllCooperatives: function() {},
    getCooperativesByRegion: function(region) {},
    getCooperativesByType: function(type) {}
};
```

---

## 7. БЕЗОПАСНОСТЬ

### 7.1 Аутентификация

```javascript
// OAuth через Яндекс
const Auth = {
    // Авторизация
    login: async function(yandexToken) {
        // Проверка токена
        const userInfo = await fetch('https://login.yandex.ru/info', {
            headers: { Authorization: `OAuth ${yandexToken}` }
        });
        
        // Создание сессии
        const session = {
            userId: userInfo.id,
            email: userInfo.default_email,
            token: yandexToken,
            expires: Date.now() + 30 * 24 * 60 * 60 * 1000
        };
        
        return session;
    },
    
    // Проверка сессии
    checkSession: function() {
        const session = localStorage.getItem('member_session');
        if (!session) return false;
        
        const data = JSON.parse(session);
        return data.expires > Date.now();
    }
};
```

### 7.2 Разграничение прав

| Ресурс | Публично | Пайщик | Кооператив | Админ |
|--------|----------|--------|------------|-------|
| Реестр кооперативов (чтение) | ✅ | ✅ | ✅ | ✅ |
| Реестр кооперативов (запись) | ❌ | ❌ | ❌ | ✅ |
| Профиль пайщика (свой) | ❌ | ✅ | ❌ | ❌ |
| Профиль пайщика (чужой) | ❌ | ❌ | ✅ | ✅ |
| Реестр пайщиков кооператива | ❌ | ❌ | ✅ | ✅ |
| Взносы (свои) | ❌ | ✅ | ✅ | ✅ |
| Взносы (чужие) | ❌ | ❌ | ✅ | ✅ |
| Подача заявления | ✅ | ✅ | ❌ | ❌ |
| Рассмотрение заявления | ❌ | ❌ | ✅ | ✅ |

### 7.3 Защита данных

```javascript
// Шифрование чувствительных данных
const DataProtection = {
    // Шифрование паспортных данных
    encryptPassport: function(passportData) {
        // Использование Web Crypto API
        // ...
    },
    
    // Маскирование при отображении
    maskPassport: function(series, number) {
        return `${series} ${number.substring(0, 2)}***`;
    },
    
    // Аудит доступа
    logAccess: function(userId, resource, action) {
        console.log(`[${new Date().toISOString()}] ${userId} ${action} ${resource}`);
    }
};
```

---

## 8. ПЛАН РЕАЛИЗАЦИИ

### Этап 1: Реестр кооперативов (3 дня)

- [ ] `cooperatives.json` — структура реестра
- [ ] `member-search.html` — поиск кооперативов
- [ ] `member-registry.js` — функции поиска
- [ ] `member-coop-detail.html` — карточка кооператива

### Этап 2: Личный кабинет (5 дней)

- [ ] `member-cabinet.html` — главная страница
- [ ] `member-app.js` — загрузка профиля
- [ ] Интеграция с Яндекс.Диском
- [ ] Отображение списка кооперативов

### Этап 3: Заявления (4 дня)

- [ ] `member-application.html` — форма заявления
- [ ] `member-applications.js` — подача/отслеживание
- [ ] Уведомления кооперативу
- [ ] Статусы рассмотрения

### Этап 4: Синхронизация (5 дней)

- [ ] `member-sync.js` — механизм синхронизации
- [ ] `member-compare.js` — сравнение данных
- [ ] UI для расхождений
- [ ] Разрешение конфликтов

### Этап 5: Интеграция (3 дня)

- [ ] Связь с `app.js` кооператива
- [ ] Тестирование end-to-end
- [ ] Документация
- [ ] Обучение пользователей

**Итого:** 20 рабочих дней (~4 недели)

---

## 📊 СВОДНАЯ ТАБЛИЦА ФУНКЦИЙ

| Функция | Публично | Пайщик | Кооператив | Приоритет |
|---------|----------|--------|------------|-----------|
| Поиск кооперативов | ✅ | ✅ | ✅ | 🔴 Высокий |
| Просмотр карточки | ✅ | ✅ | ✅ | 🔴 Высокий |
| Подача заявления | ✅ | ✅ | ❌ | 🔴 Высокий |
| Мои кооперативы | ❌ | ✅ | ❌ | 🔴 Высокий |
| Детали по кооперативу | ❌ | ✅ | ✅ | 🔴 Высокий |
| Синхронизация | ❌ | ✅ | ✅ | 🟠 Средний |
| Сверка данных | ❌ | ✅ | ✅ | 🟠 Средний |
| Заявления (статус) | ❌ | ✅ | ✅ | 🟠 Средний |
| Документы | ❌ | ✅ | ✅ | 🟡 Низкий |
| Уведомления | ❌ | ✅ | ✅ | 🟡 Низкий |

---

## ✅ КРИТЕРИИ ПРИЁМКИ

### Функциональные

- [ ] Пайщик может найти кооператив по названию/ИНН/региону
- [ ] Пайщик может подать заявление на вступление
- [ ] Пайщик видит все свои кооперативы
- [ ] Пайщик может синхронизировать данные с кооперативом
- [ ] Система показывает расхождения в данных
- [ ] Пайщик может запросить справку из кооператива

### Технические

- [ ] Интеграция с Яндекс.Диском работает
- [ ] Данные синхронизируются корректно
- [ ] OAuth авторизация работает
- [ ] Нет ошибок в консоли
- [ ] Адаптивность для мобильных

### Безопасность

- [ ] Доступ только к своим данным
- [ ] Токены хранятся безопасно
- [ ] Паспортные данные маскируются
- [ ] Аудит доступа работает

---

**Документ готов для обсуждения и утверждения.**
