<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä v12 - –ù–æ–≤–æ–µ –º–µ–Ω—é –æ—Ç—á–µ—Ç–æ–≤</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        html, body { height: 100%; margin: 0; overflow: hidden; background: #f0f2f5; }
        .container { display: flex; height: 100%; position: relative; }
        
        /* –õ–ï–í–û–ï –ú–ï–ù–Æ –ù–ê–í–ò–ì–ê–¶–ò–ò */
        .sidebar-menu {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            z-index: 200;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .sidebar-menu.visible { transform: translateX(0); }
        
        .menu-header {
            padding: 20px 15px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .menu-title { font-size: 18px; font-weight: bold; }
        .menu-close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
        }
        
        .menu-content { flex: 1; overflow-y: auto; }
        .menu-section { padding: 15px 0; border-bottom: 1px solid #f0f0f0; }
        .menu-section-title {
            padding: 0 20px 10px;
            font-size: 11px;
            font-weight: bold;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .menu-item {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .menu-item:hover { background: #f5f7fa; }
        .menu-item-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .menu-item-info { flex: 1; min-width: 0; }
        .menu-item-name { font-weight: 500; font-size: 13px; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .menu-item-subtitle { font-size: 11px; color: #999; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .menu-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            background: #e0e0e0;
            margin-left: 8px;
            flex-shrink: 0;
        }
        .menu-badge.alert { background: #ffebee; color: #c62828; }
        .menu-badge.success { background: #e8f5e9; color: #2e7d32; }
        .menu-arrow { color: #ccc; margin-left: 8px; font-size: 14px; }
        
        /* –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í */
        .reports-submenu {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            z-index: 50;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .reports-submenu.visible { transform: translateX(0); }
        
        .submenu-header {
            padding: 20px 15px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .submenu-title { font-size: 16px; font-weight: 600; }
        .submenu-back-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .submenu-content { flex: 1; overflow-y: auto; padding: 15px; }
        .submenu-section { margin-bottom: 20px; }
        .submenu-section-title {
            font-size: 11px;
            font-weight: bold;
            color: #999;
            text-transform: uppercase;
            margin-bottom: 12px;
            padding-left: 10px;
            letter-spacing: 0.5px;
        }
        .report-card {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f5f7fa;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .report-card:hover { background: #e3f2fd; transform: translateX(4px); }
        .report-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .report-card-info { flex: 1; min-width: 0; }
        .report-card-title { font-weight: 600; font-size: 13px; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .report-card-desc { font-size: 11px; color: #666; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        /* –°–ü–ò–°–û–ö –ß–ê–¢–û–í - –í–°–ï–ì–î–ê –ù–ê –ú–ï–°–¢–ï */
        .chats-panel {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            z-index: 50;
            position: relative;
        }
        
        .chats-header {
            padding: 15px;
            background: #fff;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .burger-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 20px;
        }
        .burger-btn:hover { background: #e0e0e0; }
        
        .cooperative-info { flex: 1; }
        .cooperative-name { font-weight: 600; font-size: 14px; }
        .cooperative-stats { font-size: 12px; color: #666; }
        
        .search-section {
            padding: 12px 15px;
            background: #f5f7fa;
            border-bottom: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .search-box {
            display: flex;
            align-items: center;
            background: #fff;
            border-radius: 20px;
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
        }
        .search-box input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 14px;
        }
        .quick-filters {
            display: flex;
            gap: 6px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .filter-chip {
            padding: 4px 10px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            background: #fff;
            font-size: 12px;
            cursor: pointer;
        }
        .filter-chip.active { background: #0088cc; color: #fff; border-color: #0088cc; }
        
        .chats-list { flex: 1; overflow-y: auto; }
        .chat-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f0f2f5;
            cursor: pointer;
        }
        .chat-item:hover { background: #f5f7fa; }
        .chat-item.active { background: #e3f2fd; }
        .chat-item .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            margin-right: 12px;
            font-size: 18px;
            flex-shrink: 0;
        }
        .chat-item .chat-info {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .chat-item .chat-top, .chat-item .chat-middle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }
        .chat-item .chat-name {
            font-weight: 600;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .chat-item .chat-time { font-size: 11px; color: #999; }
        .chat-item .status { font-size: 11px; }
        .chat-item .status::before { content: '‚óè'; margin-right: 4px; }
        .chat-item .status.active { color: #4caf50; }
        .chat-item .status.debt { color: #f44336; }
        .chat-item .status.pending { color: #ff9800; }
        .chat-item .balance { font-size: 12px; font-weight: 600; }
        .chat-item .balance.positive { color: #4caf50; }
        .chat-item .balance.negative { color: #f44336; }
        .chat-item .last-message {
            font-size: 13px;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ */
        .main-chat {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #f0f2f5;
            min-height: 0;
            position: relative;
        }
        .chat-header {
            padding: 15px 20px;
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .chat-header-left { display: flex; align-items: center; flex: 1; }
        .chat-header-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            margin-right: 12px;
        }
        .chat-header-name { font-weight: 600; font-size: 16px; }
        .chat-header-status { font-size: 12px; color: #4caf50; margin-top: 2px; }
        .chat-header-actions { display: flex; gap: 8px; }
        .header-action-btn, .menu-more-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 16px;
        }
        .messages-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .message {
            max-width: 600px;
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 12px;
            border-radius: 12px;
            cursor: pointer;
            background: #fff;
            align-self: flex-start;
            border-top-left-radius: 4px;
        }
        .message.sent {
            background: #d9fdd3;
            align-self: flex-end;
            border-top-right-radius: 4px;
        }
        .message-type { font-size: 11px; color: #0088cc; font-weight: 600; margin-bottom: 4px; text-transform: uppercase; }
        .message-content { font-size: 14px; color: #333; margin-bottom: 6px; }
        .message-amount { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
        .message-time { font-size: 11px; color: #666; text-align: right; }
        .message-input-wrapper {
            background: #fff;
            border-top: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        .message-input-area {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .attach-btn, .voice-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f7fa;
            cursor: pointer;
            font-size: 18px;
        }
        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 24px;
            outline: none;
            font-size: 14px;
        }
        .send-button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            cursor: pointer;
            font-size: 18px;
        }
        
        /* –ë–û–õ–¨–®–ê–Ø –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–æ—Ç—á–µ—Ç—ã) */
        .large-report-panel {
            position: absolute;
            left: 400px;
            right: 0;
            top: 0;
            height: 100%;
            background: #f5f7fa;
            z-index: 97;
            display: none;
            flex-direction: column;
        }
        .large-report-panel.visible { display: flex; }
        .large-report-header {
            padding: 20px 30px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .large-report-title { font-size: 18px; font-weight: 600; }
        .close-large-report-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
        }
        .large-report-content { flex: 1; overflow-y: auto; padding: 30px; }
        
        /* –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ, –¥–µ—Ç–∞–ª–∏) */
        .sidebar-right, .operation-details-panel, .menu-content-panel {
            width: 400px;
            min-width: 400px;
            background: #fff;
            border-left: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 100;
        }
        .sidebar-right.visible, .operation-details-panel.visible, .menu-content-panel.visible {
            transform: translateX(0);
        }
        .member-info-header, .details-header, .menu-panel-header {
            padding: 20px;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        .close-info-btn, .close-details-btn, .close-panel-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
        }
        .member-info-content, .details-content, .menu-panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        /* –î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ */
        .detail-tabs { display: flex; border-bottom: 2px solid #e0e0e0; margin-bottom: 20px; }
        .detail-tab {
            padding: 10px 16px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: #666;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }
        .detail-tab.active { color: #0088cc; border-bottom-color: #0088cc; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .detail-item { margin-bottom: 16px; }
        .detail-label { font-size: 12px; color: #666; margin-bottom: 6px; font-weight: 500; }
        .detail-value { padding: 10px 12px; background: #f5f7fa; border-radius: 8px; font-size: 14px; }
        .detail-value.highlight { background: #e3f2fd; color: #0088cc; font-weight: 600; }
        .action-buttons { display: flex; flex-direction: column; gap: 8px; margin-top: 24px; }
        .action-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .action-btn.primary { background: linear-gradient(135deg, #0088cc, #0066aa); color: #fff; }
        .action-btn.secondary { background: #f5f7fa; color: #333; }
        .action-btn.danger { background: #ffebee; color: #c62828; }
        
        /* –ò–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ */
        .member-avatar-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            font-size: 32px;
            margin: 0 auto 15px;
        }
        .member-name-large { text-align: center; font-size: 18px; font-weight: 600; margin-bottom: 5px; }
        .member-status-large { text-align: center; font-size: 13px; color: #666; margin-bottom: 20px; }
        .balance-card {
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .balance-label { font-size: 13px; opacity: 0.9; margin-bottom: 8px; }
        .balance-amount { font-size: 28px; font-weight: 700; }
        .info-section { margin-bottom: 25px; }
        .info-section-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e0e0e0;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f5f7fa;
        }
        .info-label { font-size: 13px; color: #666; }
        .info-value { font-size: 13px; font-weight: 500; color: #333; }
        .info-actions { display: flex; flex-direction: column; gap: 8px; margin-top: 20px; }
        .info-action-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .info-action-btn.primary { background: linear-gradient(135deg, #0088cc, #0066aa); color: #fff; }
        .info-action-btn.secondary { background: #f5f7fa; color: #333; }
        .info-action-btn.danger { background: #ffebee; color: #c62828; }
        
        /* FAB –ö–ù–û–ü–ö–ê */
        .fab-container {
            position: fixed;
            right: 20px;
            bottom: 90px;
            z-index: 1000;
            transition: opacity 0.3s, transform 0.3s;
        }
        .fab-container.hidden {
            opacity: 0;
            transform: scale(0);
            pointer-events: none;
        }
        .fab-main {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0088cc, #0066aa);
            color: #fff;
            border: none;
            box-shadow: 0 4px 12px rgba(0,136,204,0.4);
            cursor: pointer;
            font-size: 24px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .fab-main:hover { transform: scale(1.1); }
        .fab-main.close { transform: rotate(45deg); }
        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column-reverse;
            gap: 12px;
            pointer-events: none;
        }
        .fab-menu.expanded { pointer-events: all; }
        .fab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
            transition: all 0.3s;
            cursor: pointer;
        }
        .fab-menu.expanded .fab-item {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }
        .fab-item-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            color: #fff;
            font-size: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .fab-item-label {
            margin-top: 4px;
            font-size: 11px;
            color: #333;
            background: rgba(255,255,255,0.95);
            padding: 2px 8px;
            border-radius: 4px;
            white-space: nowrap;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1024px) {
            .sidebar-menu, .reports-submenu, .chats-panel { width: 350px; min-width: 350px; }
            .sidebar-right, .operation-details-panel, .menu-content-panel, .large-report-panel { width: 350px; min-width: 350px; left: 350px; }
            .message { max-width: 600px; }
        }
        @media (max-width: 768px) {
            .sidebar-menu, .reports-submenu, .chats-panel { width: 80%; min-width: 80%; }
            .sidebar-right, .operation-details-panel, .menu-content-panel, .large-report-panel { width: 100%; min-width: 100%; left: 0; }
            .fab-container { bottom: 100px; right: 15px; }
            .fab-main { width: 48px; height: 48px; }
            .message { max-width: 600px; }
        }
        @media (max-width: 480px) {
            .sidebar-menu, .reports-submenu, .chats-panel { width: 100%; min-width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –õ–ï–í–û–ï –ú–ï–ù–Æ –ù–ê–í–ò–ì–ê–¶–ò–ò -->
        <div class="sidebar-menu" id="sidebarMenu">
            <div class="menu-header">
                <div class="menu-title">üè† –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
                <button class="menu-close-btn" id="menuCloseBtn">‚óÄ</button>
            </div>
            <div class="menu-content">
                <!-- –ë–´–°–¢–†–´–ô –î–û–°–¢–£–ü -->
                <div class="menu-section">
                    <div class="menu-section-title">‚ö° –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</div>
                    <div class="menu-item" data-panel="favorites">
                        <div class="menu-item-icon" style="background:#fff3e0">‚≠ê</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
                            <div class="menu-item-subtitle">–ß–∞—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</div>
                        </div>
                    </div>
                    <div class="menu-item" data-panel="calendar">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìÖ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</div>
                            <div class="menu-item-subtitle">–ü–ª–∞–Ω—ã –∏ —Å—Ä–æ–∫–∏</div>
                        </div>
                    </div>
                </div>
                
                <!-- –ü–ê–ô–©–ò–ö–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">üë• –ü–∞–π—â–∏–∫–∏</div>
                    <div class="menu-item" data-panel="members-registry">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìã</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–µ—Å—Ç—Ä —á–ª–µ–Ω–æ–≤</div>
                            <div class="menu-item-subtitle">–°–ø–∏—Å–æ–∫ –ø–∞–π—â–∏–∫–æ–≤</div>
                        </div>
                        <span class="menu-badge success">12</span>
                    </div>
                    <div class="menu-item" data-panel="certificates">
                        <div class="menu-item-icon" style="background:#fce4ec">üìú</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–í—ã–¥–∞–Ω–Ω—ã–µ –±–ª–∞–Ω–∫–∏</div>
                        </div>
                    </div>
                </div>
                
                <!-- –ë–£–•–ì–ê–õ–¢–ï–†–°–ö–ò–ô –£–ß–Å–¢ -->
                <div class="menu-section">
                    <div class="menu-section-title">üìò –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á—ë—Ç</div>
                    <div class="menu-item" data-action="pko">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìÑ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–ö–û</div>
                            <div class="menu-item-subtitle">–ü—Ä–∏—Ö–æ–¥–Ω—ã–π –æ—Ä–¥–µ—Ä</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="rko">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìÑ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–ö–û</div>
                            <div class="menu-item-subtitle">–†–∞—Å—Ö–æ–¥–Ω—ã–π –æ—Ä–¥–µ—Ä</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="certificate">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìÑ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞</div>
                            <div class="menu-item-subtitle">–°–ø—Ä–∞–≤–∫–∞-—Ä–∞—Å—á—ë—Ç</div>
                        </div>
                    </div>
                    <div class="menu-item" data-submenu="accounting-reports">
                        <div class="menu-item-icon" style="background:#fff3e0">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û—Ç—á—ë—Ç—ã</div>
                            <div class="menu-item-subtitle">–û–°–í, –±–∞–ª–∞–Ω—Å—ã, —Ä–µ–≥–∏—Å—Ç—Ä—ã</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                </div>
                
                <!-- –ù–ê–õ–û–ì–û–í–´–ô –£–ß–Å–¢ -->
                <div class="menu-section">
                    <div class="menu-section-title">üìô –ù–∞–ª–æ–≥–æ–≤—ã–π —É—á—ë—Ç</div>
                    <div class="menu-item" data-action="kudir">
                        <div class="menu-item-icon" style="background:#fff3e0">üìñ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–£–î–∏–†</div>
                            <div class="menu-item-subtitle">–ö–Ω–∏–≥–∞ —É—á—ë—Ç–∞</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="usn">
                        <div class="menu-item-icon" style="background:#fff3e0">üìã</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù</div>
                            <div class="menu-item-subtitle">–ù–∞–ª–æ–≥–æ–≤–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="zero">
                        <div class="menu-item-icon" style="background:#f5f5f5">‚àÖ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ù—É–ª–µ–≤–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å</div>
                            <div class="menu-item-subtitle">–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</div>
                        </div>
                    </div>
                </div>
                
                <!-- –£–ü–†–ê–í–õ–ï–ù–ß–ï–°–ö–ò–ô –£–ß–Å–¢ -->
                <div class="menu-section">
                    <div class="menu-section-title">üìó –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á—ë—Ç</div>
                    <div class="menu-item" data-submenu="analytics">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìà</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
                            <div class="menu-item-subtitle">–û—Ç—á—ë—Ç—ã, –≥—Ä–∞—Ñ–∏–∫–∏</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="menu-item" data-submenu="meetings">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–°–æ–±—Ä–∞–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="menu-item" data-submenu="control">
                        <div class="menu-item-icon" style="background:#e8f5e9">‚è∞</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–æ–Ω—Ç—Ä–æ–ª—å</div>
                            <div class="menu-item-subtitle">–°—Ä–æ–∫–∏, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                </div>
                
                <!-- –ù–ê–°–¢–†–û–ô–ö–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                    <div class="menu-item" data-panel="profile">
                        <div class="menu-item-icon" style="background:#e0e0e0">üë§</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü—Ä–æ—Ñ–∏–ª—å</div>
                            <div class="menu-item-subtitle">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                        </div>
                    </div>
                    <div class="menu-item" data-panel="backup">
                        <div class="menu-item-icon" style="background:#e0e0e0">üíæ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                            <div class="menu-item-subtitle">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í -->
        <div class="reports-submenu" id="reportsSubmenu">
            <div class="submenu-header">
                <button class="submenu-back-btn" id="submenuBackBtn">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="submenu-title" id="submenuTitle">–û—Ç—á–µ—Ç—ã</div>
                <div style="width:80px"></div>
            </div>
            <div class="submenu-content" id="submenuContent"></div>
        </div>
        
        <!-- –°–ü–ò–°–û–ö –ß–ê–¢–û–í - –í–°–ï–ì–î–ê –ù–ê –ú–ï–°–¢–ï -->
        <div class="chats-panel" id="chatsPanel">
            <div class="chats-header">
                <button class="burger-btn" id="burgerBtn">‚ò∞</button>
                <div class="cooperative-info">
                    <div class="cooperative-name">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
                    <div class="cooperative-stats">12 –ø–∞–π—â–∏–∫–æ–≤ ‚Ä¢ 9 –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                </div>
            </div>
            <div class="search-section">
                <div class="search-box">
                    <span>üîç</span>
                    <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–∞–π—â–∏–∫–æ–≤..." id="searchInput">
                </div>
                <div class="quick-filters">
                    <button class="filter-chip active">–í—Å–µ</button>
                    <button class="filter-chip">üî¥ –î–æ–ª–∂–Ω–∏–∫–∏</button>
                    <button class="filter-chip">üü¢ –ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                </div>
            </div>
            <div class="chats-list" id="chatsList"></div>
        </div>
        
        <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ -->
        <div class="main-chat">
            <div class="chat-header">
                <div class="chat-header-left">
                    <div class="chat-header-avatar" id="currentAvatar">–ò–ò</div>
                    <div>
                        <div class="chat-header-name" id="currentName">–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</div>
                        <div class="chat-header-status">‚óè –ê–∫—Ç–∏–≤–µ–Ω</div>
                    </div>
                </div>
                <div class="chat-header-actions">
                    <button class="header-action-btn" title="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">üìû</button>
                    <button class="header-action-btn" title="Email">‚úâÔ∏è</button>
                    <button class="menu-more-btn" id="menuMoreBtn" title="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è">‚ãÆ</button>
                </div>
            </div>
            <div class="messages-container" id="messagesContainer"></div>
            <div class="message-input-wrapper">
                <div class="message-input-area">
                    <button class="attach-btn">üìé</button>
                    <input type="text" class="message-input" placeholder="–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é..." id="messageInput">
                    <button class="voice-btn">üé§</button>
                    <button class="send-button" id="sendButton">‚û§</button>
                </div>
            </div>
        </div>
        
        <!-- –ë–û–õ–¨–®–ê–Ø –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–æ—Ç—á–µ—Ç—ã) -->
        <div class="large-report-panel" id="largeReportPanel">
            <div class="large-report-header">
                <div class="large-report-title" id="largeReportTitle">–û—Ç—á–µ—Ç</div>
                <button class="close-large-report-btn" id="closeLargeReportBtn">‚úï</button>
            </div>
            <div class="large-report-content" id="largeReportContent"></div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ) -->
        <div class="sidebar-right" id="sidebarRight">
            <div class="member-info-header">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–π—â–∏–∫–µ</h3>
                <button class="close-info-btn" id="closeInfoBtn">‚úï</button>
            </div>
            <div class="member-info-content" id="memberInfoContent"></div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏) -->
        <div class="operation-details-panel" id="operationDetailsPanel">
            <div class="details-header">
                <h3 id="detailsTitle">–î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                <button class="close-details-btn" id="closeDetailsBtn">‚úï</button>
            </div>
            <div class="details-content" id="detailsContent"></div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–∫–æ–Ω—Ç–µ–Ω—Ç –ª–µ–≤–æ–≥–æ –º–µ–Ω—é) -->
        <div class="menu-content-panel" id="menuContentPanel">
            <div class="menu-panel-header">
                <h3 id="menuPanelTitle">–†–∞–∑–¥–µ–ª</h3>
                <button class="close-panel-btn" id="closePanelBtn">‚úï</button>
            </div>
            <div class="menu-panel-content" id="menuPanelContent"></div>
        </div>
        
        <!-- FAB –ö–ù–û–ü–ö–ê -->
        <div class="fab-container" id="fabContainer">
            <div class="fab-menu" id="fabMenu">
                <div class="fab-item" data-action="application">
                    <div class="fab-item-btn" style="background:#f44336">üìù</div>
                    <span class="fab-item-label">–ó–∞—è–≤–ª–µ–Ω–∏–µ</span>
                </div>
                <div class="fab-item" data-action="document">
                    <div class="fab-item-btn" style="background:#9c27b0">üìÅ</div>
                    <span class="fab-item-label">–î–æ–∫—É–º–µ–Ω—Ç</span>
                </div>
                <div class="fab-item" data-action="transaction">
                    <div class="fab-item-btn" style="background:#ff9800">üìí</div>
                    <span class="fab-item-label">–ü—Ä–æ–≤–æ–¥–∫–∞</span>
                </div>
                <div class="fab-item" data-action="payment">
                    <div class="fab-item-btn" style="background:#2196f3">üí≥</div>
                    <span class="fab-item-label">–í–∑–Ω–æ—Å</span>
                </div>
                <div class="fab-item" data-action="member">
                    <div class="fab-item-btn" style="background:#4caf50">üë§</div>
                    <span class="fab-item-label">–ü–∞–π—â–∏–∫</span>
                </div>
            </div>
            <button class="fab-main" id="fabMain">+</button>
        </div>
    </div>

    <script>
        // –î–ï–ú–û –î–ê–ù–ù–´–ï
        const members = [
            { id: 1, name: "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á", avatar: "–ò–ò", color: "linear-gradient(135deg,#ff6b6b,#ee5a5a)", status: "debt", statusText: "–î–æ–ª–∂–Ω–∏–∫", balance: -2000, phone: "+7 (999) 123-45-67", email: "ivanov@example.com", address: "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1", joinDate: "15.01.2023", lastTransaction: "–ü—Ä–æ—Å—Ä–æ—á–µ–Ω —á–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å (2 –º–µ—Å)", lastTime: "10:30", operations: [{ id: 1, type: "–í–Ω–µ—Å–µ–Ω–∏–µ –ø–∞—è", amount: 5000, date: "2024-01-15", description: "–ï–∂–µ–≥–æ–¥–Ω—ã–π –ø–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", status: "paid" }, { id: 2, type: "–ß–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å", amount: 1000, date: "2024-02-01", description: "–ß–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å –∑–∞ —Ñ–µ–≤—Ä–∞–ª—å", status: "overdue" }] },
            { id: 2, name: "–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –°–µ—Ä–≥–µ–µ–≤–Ω–∞", avatar: "–ü–ú", color: "linear-gradient(135deg,#51cf66,#40c057)", status: "active", statusText: "–ê–∫—Ç–∏–≤–µ–Ω", balance: 25000, phone: "+7 (999) 234-56-78", email: "petrova@example.com", address: "–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø—Ä. –ù–µ–≤—Å–∫–∏–π, –¥. 10", joinDate: "20.02.2023", lastTransaction: "–í–Ω–µ—Å—ë–Ω –ø–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å 10 000 ‚ÇΩ", lastTime: "–í—á–µ—Ä–∞", operations: [{ id: 4, type: "–í–Ω–µ—Å–µ–Ω–∏–µ –ø–∞—è", amount: 10000, date: "2024-01-14", description: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", status: "paid" }, { id: 5, type: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å", amount: 5000, date: "2023-12-10", description: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å", status: "paid" }] },
            { id: 3, name: "–°–∏–¥–æ—Ä–æ–≤ –î–º–∏—Ç—Ä–∏–π –ü–µ—Ç—Ä–æ–≤–∏—á", avatar: "–°–î", color: "linear-gradient(135deg,#fcc419,#fab005)", status: "pending", statusText: "–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏", balance: 5000, phone: "+7 (999) 345-67-89", email: "sidorov@example.com", address: "–≥. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 5", joinDate: "-", lastTransaction: "–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –ø–æ–¥–∞–Ω–æ", lastTime: "–ü—Ç", operations: [{ id: 7, type: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å", amount: 5000, date: "2024-01-13", description: "–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å", status: "pending" }] },
            { id: 4, name: "–ö–æ–∑–ª–æ–≤–∞ –ï–ª–µ–Ω–∞ –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞", avatar: "–ö–ï", color: "linear-gradient(135deg,#74c0fc,#4dabf7)", status: "active", statusText: "–ê–∫—Ç–∏–≤–µ–Ω", balance: 18000, phone: "+7 (999) 456-78-90", email: "kozlova@example.com", address: "–≥. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –ú–∞–ª—ã—à–µ–≤–∞, –¥. 20", joinDate: "10.03.2023", lastTransaction: "–ü–æ–ª—É—á–µ–Ω—ã –¥–∏–≤–∏–¥–µ–Ω–¥—ã 3 500 ‚ÇΩ", lastTime: "–ß—Ç", operations: [{ id: 8, type: "–ü–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", amount: 15000, date: "2024-01-12", description: "–ü–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å", status: "paid" }] },
            { id: 5, name: "–í–æ–ª–∫–æ–≤ –°–µ—Ä–≥–µ–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á", avatar: "–í–°", color: "linear-gradient(135deg,#b197fc,#9775fa)", status: "active", statusText: "–ê–∫—Ç–∏–≤–µ–Ω", balance: 12000, phone: "+7 (999) 567-89-01", email: "volkov@example.com", address: "–≥. –ö–∞–∑–∞–Ω—å, —É–ª. –ë–∞—É–º–∞–Ω–∞, –¥. 15", joinDate: "05.04.2023", lastTransaction: "–ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –≤—ã—Ö–æ–¥", lastTime: "–°—Ä", operations: [{ id: 10, type: "–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã—Ö–æ–¥", amount: 0, date: "2024-01-11", description: "–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ –≤—ã—Ö–æ–¥–µ", status: "pending" }] }
        ];

        // –î–ê–ù–ù–´–ï –î–õ–Ø –ü–û–î–ú–ï–ù–Æ –û–¢–ß–ï–¢–û–í - –ò–ó –ö–ê–¢–ê–õ–û–ì–ê
        const reportsMenus = {
            'accounting-reports': {
                title: 'üìò –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã',
                sections: [
                    {
                        title: 'üìä –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã',
                        reports: [
                            { id: 'balance', icon: '‚öñÔ∏è', color: '#e3f2fd', title: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å', desc: '–§–æ—Ä–º–∞ ‚Ññ1 (–û–ö–£–î 0710001)' },
                            { id: 'profit-loss', icon: 'üìà', color: '#e3f2fd', title: '–û—Ç—á—ë—Ç –æ —Ñ–∏–Ω. —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö', desc: '–§–æ—Ä–º–∞ ‚Ññ2 (–û–ö–£–î 0710002)' },
                            { id: 'target-use', icon: 'üéØ', color: '#e3f2fd', title: '–û—Ç—á—ë—Ç –æ —Ü–µ–ª–µ–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏', desc: '–§–æ—Ä–º–∞ ‚Ññ3 (–û–ö–£–î 0710003)' }
                        ]
                    },
                    {
                        title: 'üìã –†–µ–≥–∏—Å—Ç—Ä—ã –∏ –≤–µ–¥–æ–º–æ—Å—Ç–∏',
                        reports: [
                            { id: 'osv', icon: 'üìä', color: '#fff3e0', title: '–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å', desc: '–û–±–æ—Ä–æ—Ç—ã –∏ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å—á–µ—Ç–∞–º' },
                            { id: 'journal-target', icon: 'üìñ', color: '#fff3e0', title: '–ñ—É—Ä–Ω–∞–ª —Ü–µ–ª–µ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è', desc: '–û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ —Ñ–æ–Ω–¥–∞–º' },
                            { id: 'funds-movement', icon: 'üìâ', color: '#fff3e0', title: '–í–µ–¥–æ–º–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Ñ–æ–Ω–¥–æ–≤', desc: '–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –≤—ã–±—ã—Ç–∏–µ' }
                        ]
                    },
                    {
                        title: 'üí∞ –û—Ç—á—ë—Ç—ã –ø–æ —Ñ–æ–Ω–¥–∞–º',
                        reports: [
                            { id: 'annual-funds', icon: 'üìä', color: '#e8f5e9', title: '–ì–æ–¥–æ–≤–æ–π –æ—Ç—á—ë—Ç –ø–æ —Ñ–æ–Ω–¥–∞–º', desc: '5 —Ñ–æ–Ω–¥–æ–≤ –∑–∞ –≥–æ–¥' },
                            { id: 'share-card', icon: 'üìá', color: '#e8f5e9', title: '–ö–∞—Ä—Ç–æ—á–∫–∞ –ø–∞–µ–≤–æ–≥–æ –≤–∑–Ω–æ—Å–∞', desc: '–ò—Å—Ç–æ—Ä–∏—è –ø–æ –ø–∞–π—â–∏–∫—É' }
                        ]
                    }
                ]
            },
            'analytics': {
                title: 'üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞',
                sections: [
                    {
                        title: 'üìä –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç—á—ë—Ç—ã',
                        reports: [
                            { id: 'members-report', icon: 'üìã', color: '#e8f5e9', title: '–û—Ç—á—ë—Ç –ø–æ –ø–∞–π—â–∏–∫–∞–º', desc: '–†–µ–µ—Å—Ç—Ä, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞' },
                            { id: 'payments-report', icon: 'üí≥', color: '#e8f5e9', title: '–û—Ç—á—ë—Ç –ø–æ –ø–∞–µ–≤—ã–º –≤–∑–Ω–æ—Å–∞–º', desc: '–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤–∑–Ω–æ—Å–æ–≤' },
                            { id: 'financial-report', icon: 'üìà', color: '#e8f5e9', title: '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç', desc: '–ë–∞–ª–∞–Ω—Å, –î–î–°, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã' }
                        ]
                    },
                    {
                        title: 'üìâ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç—á—ë—Ç—ã',
                        reports: [
                            { id: 'debt-report', icon: '‚ö†Ô∏è', color: '#fff3e0', title: '–û—Ç—á—ë—Ç –æ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö', desc: '–°–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–∏–∫–æ–≤' },
                            { id: 'share-return', icon: '‚Ü©Ô∏è', color: '#fff3e0', title: '–û—Ç—á—ë—Ç –æ –≤–æ–∑–≤—Ä–∞—Ç–∞—Ö –ø–∞–µ–≤', desc: '–í–æ–∑–≤—Ä–∞—â—ë–Ω–Ω—ã–µ –≤–∑–Ω–æ—Å—ã' },
                            { id: 'share-value', icon: 'üßÆ', color: '#fff3e0', title: '–†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–∞—è', desc: '–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å' }
                        ]
                    },
                    {
                        title: 'üìä –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã',
                        reports: [
                            { id: 'analytics', icon: 'üìà', color: '#fce4ec', title: '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã', desc: '–î–∏–Ω–∞–º–∏–∫–∞, –≥—Ä–∞—Ñ–∏–∫–∏' },
                            { id: 'members-registry', icon: 'üìã', color: '#fce4ec', title: '–†–µ–µ—Å—Ç—Ä —á–ª–µ–Ω–æ–≤', desc: '–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–∞–π—â–∏–∫–æ–≤' }
                        ]
                    }
                ]
            },
            'meetings': {
                title: 'üìù –°–æ–±—Ä–∞–Ω–∏—è –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã',
                sections: [
                    {
                        title: 'üìã –î–æ–∫—É–º–µ–Ω—Ç—ã —Å–æ–±—Ä–∞–Ω–∏–π',
                        reports: [
                            { id: 'meeting-protocol', icon: 'üìù', color: '#e8f5e9', title: '–ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±—â–µ–≥–æ —Å–æ–±—Ä–∞–Ω–∏—è', desc: '–§–æ—Ä–º–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞' },
                            { id: 'attendance-list', icon: '‚úçÔ∏è', color: '#e8f5e9', title: '–õ–∏—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', desc: '–Ø–≤–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤' },
                            { id: 'board-protocol', icon: 'üìã', color: '#e8f5e9', title: '–ü—Ä–æ—Ç–æ–∫–æ–ª –ø—Ä–∞–≤–ª–µ–Ω–∏—è', desc: '–ó–∞—Å–µ–¥–∞–Ω–∏—è –ø—Ä–∞–≤–ª–µ–Ω–∏—è' }
                        ]
                    },
                    {
                        title: 'üìä –û—Ç—á—ë—Ç—ã —Ä–µ–≤–∏–∑–∏–æ–Ω–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏',
                        reports: [
                            { id: 'supervision-report', icon: '‚úÖ', color: '#fff3e0', title: '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–≤–∏–∑–∏–æ–Ω–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏', desc: '–ò—Ç–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏' }
                        ]
                    }
                ]
            },
            'control': {
                title: '‚è∞ –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤',
                sections: [
                    {
                        title: 'üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä–∏ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è',
                        reports: [
                            { id: 'calendar', icon: 'üìÖ', color: '#e3f2fd', title: '–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π', desc: '–°–æ–±—Ä–∞–Ω–∏—è, –ø–ª–∞—Ç–µ–∂–∏, —Å—Ä–æ–∫–∏' },
                            { id: 'control-dashboard', icon: '‚è∞', color: '#e3f2fd', title: '–ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤', desc: '–ò—Å—Ç–µ–∫–∞—é—â–∏–µ —Å—Ä–æ–∫–∏' },
                            { id: 'retention-settings', icon: '‚öôÔ∏è', color: '#e3f2fd', title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ä–æ–∫–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è', desc: '–ü–µ—Ä–∏–æ–¥—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤' }
                        ]
                    }
                ]
            }
        };

        // –ö–û–ù–¢–ï–ù–¢ –î–õ–Ø –ü–ê–ù–ï–õ–ï–ô
        const menuPanelContent = {
            favorites: {
                title: '‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ',
                content: '<div style="margin-bottom:20px"><div style="padding:15px;background:#ffebee;border-radius:8px;margin-bottom:15px"><div style="font-size:16px;font-weight:600;margin-bottom:5px">‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –≤–∑–Ω–æ—Å—ã</div><div style="font-size:13px;color:#666">3 –ø–∞–π—â–∏–∫–∞ –∏–º–µ—é—Ç –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å</div></div><div style="padding:15px;background:#fff3e0;border-radius:8px;margin-bottom:15px"><div style="font-size:16px;font-weight:600;margin-bottom:5px">üìù –ó–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</div><div style="font-size:13px;color:#666">5 –∑–∞—è–≤–ª–µ–Ω–∏–π –æ–∂–∏–¥–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏</div></div><div style="padding:15px;background:#e8f5e9;border-radius:8px"><div style="font-size:16px;font-weight:600;margin-bottom:5px">ü§ù –ë–ª–∏–∂–∞–π—à–µ–µ –∑–∞—Å–µ–¥–∞–Ω–∏–µ</div><div style="font-size:13px;color:#666">–ó–∞–≤—Ç—Ä–∞ –≤ 10:00 ‚Ä¢ –ë–æ–ª—å—à–æ–π –∑–∞–ª</div></div></div>'
            },
            calendar: {
                title: 'üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π',
                content: '<div style="padding:20px;background:#e3f2fd;border-radius:8px;margin-bottom:20px"><div style="font-size:16px;font-weight:600;margin-bottom:10px">üìÖ –§–µ–≤—Ä–∞–ª—å 2024</div><div style="font-size:14px;margin-bottom:5px"><strong>17 —Ñ–µ–≤—Ä–∞–ª—è:</strong> –û–±—â–µ–µ —Å–æ–±—Ä–∞–Ω–∏–µ (10:00)</div><div style="font-size:14px;margin-bottom:5px"><strong>28 —Ñ–µ–≤—Ä–∞–ª—è:</strong> –°—Ä–æ–∫ —Å–¥–∞—á–∏ –£–°–ù</div><div style="font-size:14px"><strong>1 –º–∞—Ä—Ç–∞:</strong> –ü–ª–∞—Ç—ë–∂ –ø–æ –∫—Ä–µ–¥–∏—Ç—É</div></div>'
            },
            'members-registry': {
                title: 'üìã –†–µ–µ—Å—Ç—Ä —á–ª–µ–Ω–æ–≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞',
                content: '<div style="margin-bottom:15px"><strong>12 –ø–∞–π—â–∏–∫–æ–≤</strong> –≤ —Ä–µ–µ—Å—Ç—Ä–µ</div>' + members.map(m => '<div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px;cursor:pointer" onclick="selectMember('+m.id+')"><div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:600">'+m.name+'</div><span style="background:'+(m.status==='active'?'#e8f5e9':'#ffebee')+';color:'+(m.status==='active'?'#2e7d32':'#c62828')+';padding:4px 8px;border-radius:4px;font-size:11px">'+m.statusText+'</span></div><div style="font-size:12px;color:#666;margin-top:5px">–ë–∞–ª–∞–Ω—Å: <strong style="color:'+(m.balance>=0?'#4caf50':'#f44336')+'">'+(m.balance>=0?'+':'')+m.balance.toLocaleString()+' ‚ÇΩ</strong></div></div>').join('')
            },
            certificates: {
                title: 'üìú –†–µ–µ—Å—Ç—Ä –≤—ã–¥–∞–Ω–Ω—ã—Ö —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π',
                content: '<div style="margin-bottom:15px"><strong>9 –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö</strong> —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π</div><div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px"><div style="font-weight:600">–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ ‚Ññ001</div><div style="font-size:12px;color:#666;margin-top:5px">–í—ã–¥–∞–Ω–æ: –ò–≤–∞–Ω–æ–≤ –ò.–ò. | 15.01.2023</div></div><div style="padding:15px;background:#f5f7fa;border-radius:8px;margin-bottom:10px"><div style="font-weight:600">–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ ‚Ññ002</div><div style="font-size:12px;color:#666;margin-top:5px">–í—ã–¥–∞–Ω–æ: –ü–µ—Ç—Ä–æ–≤–∞ –ú.–°. | 20.02.2023</div></div>'
            },
            profile: {
                title: 'üë§ –ü—Ä–æ—Ñ–∏–ª—å',
                content: '<div style="text-align:center;margin-bottom:20px"><div style="width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,#0088cc,#0066aa);color:#fff;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:bold;margin:0 auto 15px">–ê</div><div style="font-size:18px;font-weight:600">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div><div style="font-size:13px;color:#666">admin@coop.ru</div></div>'
            },
            backup: {
                title: 'üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ',
                content: '<div style="padding:20px;background:#e3f2fd;border-radius:8px;margin-bottom:20px"><div style="font-size:16px;font-weight:600;margin-bottom:10px">–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</div><div style="font-size:14px"><strong>–î–∞—Ç–∞:</strong> 16 —Ñ–µ–≤—Ä–∞–ª—è 2024, 03:00</div><div style="font-size:14px"><strong>–†–∞–∑–º–µ—Ä:</strong> 24.5 –ú–ë</div></div><button style="width:100%;padding:15px;background:#0088cc;color:#fff;border:none;border-radius:8px;cursor:pointer">üíæ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é</button>'
            }
        };

        // –û–¢–ß–ï–¢–´ - –∫–æ–Ω—Ç–µ–Ω—Ç
        const reportsContent = {
            'balance': { title: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å (–§–æ—Ä–º–∞ ‚Ññ1)', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚öñÔ∏è</div><div style="font-size:16px;color:#666">–ë–∞–ª–∞–Ω—Å –Ω–∞ 31.12.2023</div></div>' },
            'profit-loss': { title: '–û—Ç—á—ë—Ç –æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö (–§–æ—Ä–º–∞ ‚Ññ2)', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìà</div><div style="font-size:16px;color:#666">–û—Ç—á—ë—Ç –∑–∞ 2023 –≥–æ–¥</div></div>' },
            'target-use': { title: '–û—Ç—á—ë—Ç –æ —Ü–µ–ª–µ–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üéØ</div><div style="font-size:16px;color:#666">–û—Ç—á—ë—Ç –∑–∞ 2023 –≥–æ–¥</div></div>' },
            'osv': { title: '–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å', html: '<div style="display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap"><button style="padding:8px 16px;border:1px solid #e0e0e0;border-radius:6px;background:#fff;cursor:pointer">üìä –¢–∞–±–ª–∏—Ü–∞</button><button style="padding:8px 16px;border:1px solid #e0e0e0;border-radius:6px;background:#fff;cursor:pointer">üìà –ì—Ä–∞—Ñ–∏–∫</button></div><table style="width:100%;border-collapse:collapse;font-size:13px;background:#fff;border-radius:8px;overflow:hidden"><thead><tr style="background:#f5f7fa"><th style="padding:12px;text-align:left">–°—á–µ—Ç</th><th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th><th>–í—Ö. –î—Ç</th><th>–í—Ö. –ö—Ç</th><th>–û–±–æ—Ä–æ—Ç –î—Ç</th><th>–û–±–æ—Ä–æ—Ç –ö—Ç</th></tr></thead><tbody><tr><td style="padding:12px">50</td><td>–ö–∞—Å—Å–∞</td><td>15 000</td><td>5 000</td><td>120 000</td><td>115 000</td></tr><tr style="background:#f9fafb"><td style="padding:12px">51</td><td>–†–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞</td><td>250 000</td><td>180 000</td><td>1 250 000</td><td>1 180 000</td></tr><tr><td style="padding:12px">86-1</td><td>–ü–∞–µ–≤–æ–π —Ñ–æ–Ω–¥</td><td>500 000</td><td>450 000</td><td>50 000</td><td>45 000</td></tr><tr style="background:#e3f2fd;font-weight:600"><td colspan="2" style="padding:12px">–ò–¢–û–ì–û</td><td>890 000</td><td>750 000</td><td>1 440 000</td><td>1 357 000</td></tr></tbody></table>' },
            'journal-target': { title: '–ñ—É—Ä–Ω–∞–ª —Ü–µ–ª–µ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìñ</div><div style="font-size:16px;color:#666">–ñ—É—Ä–Ω–∞–ª –∑–∞ 2024 –≥–æ–¥</div></div>' },
            'funds-movement': { title: '–í–µ–¥–æ–º–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Ñ–æ–Ω–¥–æ–≤', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìâ</div><div style="font-size:16px;color:#666">–í–µ–¥–æ–º–æ—Å—Ç—å –∑–∞ –Ø–Ω–≤–∞—Ä—å 2024</div></div>' },
            'annual-funds': { title: '–ì–æ–¥–æ–≤–æ–π –æ—Ç—á—ë—Ç –ø–æ —Ñ–æ–Ω–¥–∞–º', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìä</div><div style="font-size:16px;color:#666">–û—Ç—á—ë—Ç –∑–∞ 2023 –≥–æ–¥</div></div>' },
            'share-card': { title: '–ö–∞—Ä—Ç–æ—á–∫–∞ –ø–∞–µ–≤–æ–≥–æ –≤–∑–Ω–æ—Å–∞', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìá</div><div style="font-size:16px;color:#666">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞</div></div>' },
            'members-report': { title: '–û—Ç—á—ë—Ç –ø–æ –ø–∞–π—â–∏–∫–∞–º', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìã</div><div style="font-size:16px;color:#666">–†–µ–µ—Å—Ç—Ä —á–ª–µ–Ω–æ–≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div></div>' },
            'payments-report': { title: '–û—Ç—á—ë—Ç –ø–æ –ø–∞–µ–≤—ã–º –≤–∑–Ω–æ—Å–∞–º', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üí≥</div><div style="font-size:16px;color:#666">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤–∑–Ω–æ—Å–æ–≤</div></div>' },
            'financial-report': { title: '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìà</div><div style="font-size:16px;color:#666">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</div></div>' },
            'debt-report': { title: '–û—Ç—á—ë—Ç –æ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚ö†Ô∏è</div><div style="font-size:16px;color:#666">–°–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–∏–∫–æ–≤</div></div>' },
            'share-return': { title: '–û—Ç—á—ë—Ç –æ –≤–æ–∑–≤—Ä–∞—Ç–∞—Ö –ø–∞–µ–≤—ã—Ö –≤–∑–Ω–æ—Å–æ–≤', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚Ü©Ô∏è</div><div style="font-size:16px;color:#666">–í–æ–∑–≤—Ä–∞—â—ë–Ω–Ω—ã–µ –≤–∑–Ω–æ—Å—ã</div></div>' },
            'share-value': { title: '–†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–∞—è', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üßÆ</div><div style="font-size:16px;color:#666">–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–∞—è</div></div>' },
            'analytics': { title: '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìä</div><div style="font-size:16px;color:#666">–î–∏–Ω–∞–º–∏–∫–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∏</div></div>' },
            'members-registry': { title: '–†–µ–µ—Å—Ç—Ä —á–ª–µ–Ω–æ–≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞', html: menuPanelContent['members-registry'].content },
            'meeting-protocol': { title: '–ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±—â–µ–≥–æ —Å–æ–±—Ä–∞–Ω–∏—è', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìù</div><div style="font-size:16px;color:#666">–§–æ—Ä–º–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞</div></div>' },
            'attendance-list': { title: '–õ–∏—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚úçÔ∏è</div><div style="font-size:16px;color:#666">–°–ø–∏—Å–æ–∫ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏</div></div>' },
            'board-protocol': { title: '–ü—Ä–æ—Ç–æ–∫–æ–ª –∑–∞—Å–µ–¥–∞–Ω–∏—è –ø—Ä–∞–≤–ª–µ–Ω–∏—è', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìã</div><div style="font-size:16px;color:#666">–ü—Ä–æ—Ç–æ–∫–æ–ª –ø—Ä–∞–≤–ª–µ–Ω–∏—è</div></div>' },
            'supervision-report': { title: '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–≤–∏–∑–∏–æ–Ω–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–∏', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚úÖ</div><div style="font-size:16px;color:#666">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∑–∞ 2023 –≥–æ–¥</div></div>' },
            'calendar': { title: '–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π', html: menuPanelContent['calendar'].content },
            'control-dashboard': { title: '–ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚è∞</div><div style="font-size:16px;color:#666">–ò—Å—Ç–µ–∫–∞—é—â–∏–µ —Å—Ä–æ–∫–∏</div></div>' },
            'retention-settings': { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ä–æ–∫–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚öôÔ∏è</div><div style="font-size:16px;color:#666">–ü–µ—Ä–∏–æ–¥—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è</div></div>' }
        };

        let currentMember = null;
        let fabExpanded = false;

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        function init() {
            renderChats();
            if (members.length > 0) selectMember(members[0]);
            setupEventListeners();
        }

        // –†–µ–Ω–¥–µ—Ä —á–∞—Ç–æ–≤
        function renderChats() {
            const chatsList = document.getElementById('chatsList');
            chatsList.innerHTML = members.map(m => {
                const balanceClass = m.balance >= 0 ? 'positive' : 'negative';
                const balanceText = m.balance >= 0 ? m.balance.toLocaleString() + ' ‚ÇΩ' : '‚àí' + Math.abs(m.balance).toLocaleString() + ' ‚ÇΩ';
                const icon = m.status === 'debt' ? '‚ö†' : m.status === 'pending' ? 'üìù' : '‚úì';
                return '<div class="chat-item" data-id="' + m.id + '"><div class="avatar" style="background:' + m.color + '">' + m.avatar + '</div><div class="chat-info"><div class="chat-top"><span class="chat-name">' + m.name + '</span><span class="chat-time">' + m.lastTime + '</span></div><div class="chat-middle"><span class="status ' + m.status + '">' + m.statusText + '</span><span class="balance ' + balanceClass + '">' + balanceText + '</span></div><div class="last-message"><span class="icon">' + icon + '</span>' + m.lastTransaction + '</div></div></div>';
            }).join('');
            chatsList.querySelectorAll('.chat-item').forEach(item => {
                item.addEventListener('click', () => selectMember(members.find(m => m.id == item.dataset.id)));
            });
        }

        // –í—ã–±–æ—Ä –ø–∞–π—â–∏–∫–∞
        function selectMember(member) {
            currentMember = member;
            document.getElementById('currentName').textContent = member.name;
            document.getElementById('currentAvatar').textContent = member.avatar;
            document.getElementById('currentAvatar').style.background = member.color;
            document.querySelectorAll('.chat-item').forEach(i => i.classList.remove('active'));
            const activeItem = document.querySelector('.chat-item[data-id="' + member.id + '"]');
            if (activeItem) activeItem.classList.add('active');
            renderMessages(member.operations);
            hideAllRightPanels();
        }

        // –†–µ–Ω–¥–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
        function renderMessages(operations) {
            const container = document.getElementById('messagesContainer');
            container.innerHTML = operations.map(op => {
                const statusIcon = op.status === 'paid' ? '‚úì' : op.status === 'overdue' ? '‚ö†' : '‚è≥';
                return '<div class="message received" onclick="showOperationDetails(' + op.id + ')"><div class="message-type">' + op.type + '</div><div class="message-content">' + op.description + '</div>' + (op.amount ? '<div class="message-amount">' + op.amount.toLocaleString() + ' ‚ÇΩ</div>' : '') + '<div class="message-time">' + op.date + ' ' + statusIcon + '</div></div>';
            }).join('');
            container.scrollTop = container.scrollHeight;
        }

        // –°–∫—Ä—ã—Ç—å –≤—Å–µ –ø—Ä–∞–≤—ã–µ –ø–∞–Ω–µ–ª–∏
        function hideAllRightPanels() {
            document.getElementById('sidebarRight').classList.remove('visible');
            document.getElementById('operationDetailsPanel').classList.remove('visible');
            document.getElementById('menuContentPanel').classList.remove('visible');
            document.getElementById('largeReportPanel').classList.remove('visible');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å FAB –∫–Ω–æ–ø–∫—É
        function showFab() {
            document.getElementById('fabContainer').classList.remove('hidden');
        }

        function hideFab() {
            document.getElementById('fabContainer').classList.add('hidden');
            fabExpanded = false;
            document.getElementById('fabMain').classList.remove('close');
            document.getElementById('fabMenu').classList.remove('expanded');
        }

        // ==================== –û–¢–ß–ï–¢–´ - –ù–û–í–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –æ—Ç—á–µ—Ç–∞ - –¥–æ—Å—Ç—É–ø–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ
        window.openReportById = function(reportId) {
            console.log('=== –û–¢–ö–†–´–¢–ò–ï –û–¢–ß–ï–¢–ê ===', reportId);
            const report = reportsContent[reportId];
            if (!report) {
                console.error('–û—Ç—á–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω:', reportId);
                alert('–û—Ç—á–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω: ' + reportId);
                return;
            }
            console.log('–û—Ç—á–µ—Ç –Ω–∞–π–¥–µ–Ω:', report.title);
            openLargeReport(report.title, report.html);
        };

        function openReportsSubmenu(menuType) {
            console.log('=== –û–¢–ö–†–´–¢–ò–ï –ü–û–î–ú–ï–ù–Æ ===', menuType);
            const data = reportsMenus[menuType];
            if (!data) {
                console.error('–ú–µ–Ω—é –Ω–µ –Ω–∞–π–¥–µ–Ω–æ:', menuType);
                return;
            }
            
            document.getElementById('submenuTitle').textContent = data.title;
            const content = document.getElementById('submenuContent');
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤
            let html = '';
            data.sections.forEach(section => {
                html += '<div class="submenu-section"><div class="submenu-section-title">' + section.title + '</div>';
                section.reports.forEach(report => {
                    html += '<div class="report-card" data-report-id="' + report.id + '">' +
                        '<div class="report-card-icon" style="background:' + report.color + '">' + report.icon + '</div>' +
                        '<div class="report-card-info">' +
                        '<div class="report-card-title">' + report.title + '</div>' +
                        '<div class="report-card-desc">' + report.desc + '</div>' +
                        '</div></div>';
                });
                html += '</div>';
            });
            
            content.innerHTML = html;
            
            // –í–ê–ñ–ù–û: –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ü–û–°–õ–ï –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ HTML
            content.querySelectorAll('.report-card').forEach(card => {
                card.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    console.log('–ö–ª–∏–∫ –ø–æ –æ—Ç—á–µ—Ç—É:', reportId);
                    openReportById(reportId);
                });
            });
            
            document.getElementById('reportsSubmenu').classList.add('visible');
            document.getElementById('sidebarMenu').classList.remove('visible');
        }

        function closeReportsSubmenu() {
            document.getElementById('reportsSubmenu').classList.remove('visible');
        }

        function openMenuPanel(panelType) {
            const panel = menuPanelContent[panelType];
            if (!panel) return;
            document.getElementById('menuPanelTitle').textContent = panel.title;
            document.getElementById('menuPanelContent').innerHTML = panel.content;
            document.getElementById('menuContentPanel').classList.add('visible');
            document.getElementById('sidebarMenu').classList.remove('visible');
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏–∑ –º–µ–Ω—é
        function handleMenuAction(action) {
            console.log('–î–µ–π—Å—Ç–≤–∏–µ –º–µ–Ω—é:', action);
            const actions = {
                'pko': { title: '–ü–ö–û', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìÑ</div><div style="font-size:16px;color:#666">–ü—Ä–∏—Ö–æ–¥–Ω—ã–π –∫–∞—Å—Å–æ–≤—ã–π –æ—Ä–¥–µ—Ä (–ö–û-1)</div></div>' },
                'rko': { title: '–†–ö–û', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìÑ</div><div style="font-size:16px;color:#666">–†–∞—Å—Ö–æ–¥–Ω—ã–π –∫–∞—Å—Å–æ–≤—ã–π –æ—Ä–¥–µ—Ä (–ö–û-2)</div></div>' },
                'certificate': { title: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìÑ</div><div style="font-size:16px;color:#666">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞</div></div>' },
                'kudir': { title: '–ö–£–î–∏–†', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìñ</div><div style="font-size:16px;color:#666">–ö–Ω–∏–≥–∞ —É—á—ë—Ç–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤</div></div>' },
                'usn': { title: '–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">üìã</div><div style="font-size:16px;color:#666">–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –ø–æ –£–°–ù –∑–∞ 2023 –≥–æ–¥</div></div>' },
                'zero': { title: '–ù—É–ª–µ–≤–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å', html: '<div style="padding:40px;text-align:center"><div style="font-size:48px;margin-bottom:20px">‚àÖ</div><div style="font-size:16px;color:#666">–ù—É–ª–µ–≤–∞—è –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù</div></div>' }
            };
            const actionData = actions[action];
            if (actionData) {
                openLargeReport(actionData.title, actionData.html);
            }
        }

        function showMemberInfo() {
            if (!currentMember) return;
            const m = currentMember;
            const statusClass = m.status === 'active' ? 'positive' : m.status === 'debt' ? 'negative' : '';
            const balanceClass = m.balance >= 0 ? '' : 'style="color:#ffcdd2"';
            const content = '<div class="member-avatar-large" style="background:' + m.color + '">' + m.avatar + '</div><div class="member-name-large">' + m.name + '</div><div class="member-status-large">‚óè <span class="' + statusClass + '">' + m.statusText + '</span></div><div class="balance-card"><div class="balance-label">–ë–∞–ª–∞–Ω—Å –ø–∞–π—â–∏–∫–∞</div><div class="balance-amount" ' + balanceClass + '>' + (m.balance >= 0 ? '+' : '') + m.balance.toLocaleString() + ' ‚ÇΩ</div></div><div class="info-section"><div class="info-section-title">üìã –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div><div class="info-row"><span class="info-label">–¢–µ–ª–µ—Ñ–æ–Ω</span><span class="info-value">' + m.phone + '</span></div><div class="info-row"><span class="info-label">Email</span><span class="info-value">' + m.email + '</span></div><div class="info-row"><span class="info-label">–ê–¥—Ä–µ—Å</span><span class="info-value">' + m.address + '</span></div></div><div class="info-section"><div class="info-section-title">üìä –ß–ª–µ–Ω—Å—Ç–≤–æ</div><div class="info-row"><span class="info-label">–î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</span><span class="info-value">' + m.joinDate + '</span></div><div class="info-row"><span class="info-label">–°—Ç–∞—Ç—É—Å</span><span class="info-value">' + m.statusText + '</span></div><div class="info-row"><span class="info-label">–ë–∞–ª–∞–Ω—Å</span><span class="info-value" ' + balanceClass + '>' + (m.balance >= 0 ? '+' : '') + m.balance.toLocaleString() + ' ‚ÇΩ</span></div></div><div class="info-actions"><button class="info-action-btn primary">üìÑ –í—ã–ø–∏—Å–∫–∞ –ø–æ —Å—á–µ—Ç—É</button><button class="info-action-btn secondary">‚úâÔ∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</button><button class="info-action-btn danger">‚ö†Ô∏è –ò—Å–∫–ª—é—á–∏—Ç—å</button></div>';
            document.getElementById('memberInfoContent').innerHTML = content;
            document.getElementById('sidebarRight').classList.add('visible');
            hideFab();
        }

        function showOperationDetails(opId) {
            const op = currentMember.operations.find(o => o.id === opId);
            if (!op) return;
            const statusText = op.status === 'paid' ? '‚úì –û–ø–ª–∞—á–µ–Ω–æ' : op.status === 'overdue' ? '‚ö† –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ' : '‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è';
            const content = '<div class="detail-tabs"><button class="detail-tab active" onclick="switchTab(\'main\')">–û—Å–Ω–æ–≤–Ω–æ–µ</button><button class="detail-tab" onclick="switchTab(\'accounting\')">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è</button></div><div class="tab-content active" id="tab-main"><div class="detail-item"><div class="detail-label">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</div><div class="detail-value highlight">' + op.type + '</div></div><div class="detail-item"><div class="detail-label">–°—É–º–º–∞</div><div class="detail-value highlight">' + (op.amount ? op.amount.toLocaleString() + ' ‚ÇΩ' : '‚Äî') + '</div></div><div class="detail-item"><div class="detail-label">–î–∞—Ç–∞</div><div class="detail-value">' + op.date + '</div></div><div class="detail-item"><div class="detail-label">–û–ø–∏—Å–∞–Ω–∏–µ</div><div class="detail-value">' + op.description + '</div></div><div class="detail-item"><div class="detail-label">–°—Ç–∞—Ç—É—Å</div><div class="detail-value">' + statusText + '</div></div><div class="action-buttons"><button class="action-btn primary">üìÑ –ü–µ—á–∞—Ç—å</button><button class="action-btn secondary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button><button class="action-btn danger">‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç</button></div></div><div class="tab-content" id="tab-accounting"><div class="detail-item"><div class="detail-label">–ü—Ä–æ–≤–æ–¥–∫–∏</div><div class="detail-value">–î—Ç 50 - –ö—Ç 86-1: ' + (op.amount || 0) + ' ‚ÇΩ</div></div></div>';
            document.getElementById('detailsTitle').textContent = '–î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏';
            document.getElementById('detailsContent').innerHTML = content;
            document.getElementById('operationDetailsPanel').classList.add('visible');
            hideFab();
        }

        function switchTab(tab) {
            document.querySelectorAll('.detail-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('tab-' + tab).classList.add('active');
        }

        function openLargeReport(title, content) {
            document.getElementById('largeReportTitle').textContent = title;
            document.getElementById('largeReportContent').innerHTML = content;
            document.getElementById('largeReportPanel').classList.add('visible');
            document.getElementById('reportsSubmenu').classList.remove('visible');
            hideFab();
        }

        function closeLargeReport() {
            document.getElementById('largeReportPanel').classList.remove('visible');
            showFab();
        }

        // FAB –∫–Ω–æ–ø–∫–∞
        function toggleFab() {
            fabExpanded = !fabExpanded;
            const fabMain = document.getElementById('fabMain');
            const fabMenu = document.getElementById('fabMenu');
            if (fabExpanded) {
                fabMain.classList.add('close');
                fabMenu.classList.add('expanded');
            } else {
                fabMain.classList.remove('close');
                fabMenu.classList.remove('expanded');
            }
        }

        function createNew(type) {
            const titles = {
                member: '–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π—â–∏–∫–∞',
                payment: '–í–Ω–µ—Å–µ–Ω–∏–µ –≤–∑–Ω–æ—Å–∞',
                transaction: '–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∫–∏',
                document: '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                application: '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–ª–µ–Ω–∏—è'
            };
            alert(titles[type] || '–°–æ–∑–¥–∞–Ω–∏–µ');
            toggleFab();
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ë—É—Ä–≥–µ—Ä –º–µ–Ω—é
            document.getElementById('burgerBtn').addEventListener('click', function() {
                document.getElementById('sidebarMenu').classList.add('visible');
            });

            // –ó–∞–∫—Ä—ã—Ç—å –ª–µ–≤–æ–µ –º–µ–Ω—é
            document.getElementById('menuCloseBtn').addEventListener('click', function() {
                document.getElementById('sidebarMenu').classList.remove('visible');
            });

            // –ö–ª–∏–∫ –ø–æ –ø—É–Ω–∫—Ç–∞–º –ª–µ–≤–æ–≥–æ –º–µ–Ω—é
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const panel = this.dataset.panel;
                    const submenu = this.dataset.submenu;
                    const action = this.dataset.action;
                    if (panel) {
                        openMenuPanel(panel);
                    } else if (submenu) {
                        openReportsSubmenu(submenu);
                    } else if (action) {
                        handleMenuAction(action);
                    }
                });
            });

            // –ù–∞–∑–∞–¥ –∏–∑ –ø–æ–¥–º–µ–Ω—é
            document.getElementById('submenuBackBtn').addEventListener('click', function() {
                closeReportsSubmenu();
            });

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            document.getElementById('sendButton').addEventListener('click', sendMessage);
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });

            // –ó–∞–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
            document.getElementById('closeDetailsBtn').addEventListener('click', function() {
                document.getElementById('operationDetailsPanel').classList.remove('visible');
                showFab();
            });

            // –ó–∞–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ
            document.getElementById('closeInfoBtn').addEventListener('click', function() {
                document.getElementById('sidebarRight').classList.remove('visible');
                showFab();
            });

            // –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            document.getElementById('closePanelBtn').addEventListener('click', function() {
                document.getElementById('menuContentPanel').classList.remove('visible');
                showFab();
            });

            // –û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ –æ –ø–∞–π—â–∏–∫–µ (3 —Ç–æ—á–∫–∏)
            document.getElementById('menuMoreBtn').addEventListener('click', showMemberInfo);

            // FAB –∫–Ω–æ–ø–∫–∞
            document.getElementById('fabMain').addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                toggleFab();
                return false;
            });

            // –ö–ª–∏–∫ –ø–æ FAB —ç–ª–µ–º–µ–Ω—Ç–∞–º
            document.querySelectorAll('.fab-item').forEach(item => {
                item.addEventListener('click', function() {
                    const action = this.dataset.action;
                    createNew(action);
                });
            });

            // –ü–æ–∏—Å–∫
            document.getElementById('searchInput').addEventListener('input', function(e) {
                const term = e.target.value.toLowerCase();
                document.querySelectorAll('.chat-item').forEach(item => {
                    const name = item.querySelector('.chat-name');
                    if (name) {
                        const nameText = name.textContent.toLowerCase();
                        item.style.display = nameText.includes(term) ? 'flex' : 'none';
                    }
                });
            });

            // –§–∏–ª—å—Ç—Ä—ã
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // –ö–ª–∏–∫ –≤–Ω–µ FAB –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é
            document.addEventListener('click', function(e) {
                if (fabExpanded && !e.target.closest('.fab-container')) {
                    toggleFab();
                }
            });
        }

        function sendMessage() {
            const text = document.getElementById('messageInput').value.trim();
            if (!text || !currentMember) return;
            currentMember.operations.push({ id: Date.now(), type: "–°–æ–æ–±—â–µ–Ω–∏–µ", amount: 0, date: new Date().toISOString().split('T')[0], description: text, status: "paid" });
            renderMessages(currentMember.operations);
            document.getElementById('messageInput').value = '';
        }

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>
