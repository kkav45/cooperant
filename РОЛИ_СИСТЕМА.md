# 🎭 СИСТЕМА ВЫБОРА РОЛЕЙ: ПАЙЩИК / КООПЕРАТИВ

**Версия:** 1.0  
**Дата:** 20 февраля 2026  
**Статус:** ✅ ГОТОВО

---

## 📋 ОБЗОР

При входе в систему пользователь выбирает одну из двух ролей:

```
┌─────────────────────────────────────────────────────────┐
│                    КООПЕРАНТ                            │
│                                                         │
│              Выберите вашу роль                         │
│                                                         │
│  ┌──────────────────┐    ┌──────────────────┐          │
│  │   👤 Пайщик      │    │   🏢 Кооператив  │          │
│  │                  │    │                  │          │
│  │  • Просмотр      │    │  • Управление    │          │
│  │  • Заявления     │    │  • Реестр        │          │
│  │  • Синхронизация │    │  • Бухгалтерия   │          │
│  └──────────────────┘    └──────────────────┘          │
│                                                         │
│              [ Продолжить → ]                           │
└─────────────────────────────────────────────────────────┘
```

---

## 🚀 КАК ЭТО РАБОТАЕТ

### Шаг 1: Вход на главную страницу

```
Откройте: d:\!Минкооп_рф\! КООП\index.html
```

### Шаг 2: Выбор роли

**Две карточки:**

| Роль | Иконка | Для кого |
|------|--------|----------|
| **👤 Пайщик** | 👤 | Физические и юридические лица — члены кооператива |
| **🏢 Кооператив** | 🏢 | Председатель, бухгалтер, администратор |

### Шаг 3: Перенаправление

После выбора роли система перенаправляет в соответствующий кабинет:

```
Выбрана роль → Перенаправление
─────────────────────────────────────────
Пайщик       → member-cabinet.html
Кооператив   → cooperative-cabinet.html
```

---

## 📁 СТРУКТУРА ФАЙЛОВ

```
d:\!Минкооп_рф\! КООП\
│
├── index.html                    ← ГЛАВНАЯ: Выбор роли
│
├── member-cabinet.html           ← КАБИНЕТ ПАЙЩИКА
│   ├── member-app.js             │   ← Логика пайщика
│   └── member-auth-callback.html │   ← Авторизация
│
└── cooperative-cabinet.html      ← КАБИНЕТ КООПЕРАТИВА
    └── (в разработке)            │   ← Модули для бухгалтера
```

---

## 🔧 ТЕХНИЧЕСКАЯ РЕАЛИЗАЦИЯ

### 1. Главная страница (index.html)

**Проверка выбора:**

```javascript
// Выбор роли
function selectRole(role) {
    selectedRole = role;
    localStorage.setItem('selectedRole', role);
}

// Перенаправление
function continueToLogin() {
    if (selectedRole === 'member') {
        window.location.href = 'member-cabinet.html';
    } else if (selectedRole === 'cooperative') {
        window.location.href = 'cooperative-cabinet.html';
    }
}
```

### 2. Проверка роли в кабинете

**member-cabinet.html:**

```javascript
(function() {
    const selectedRole = localStorage.getItem('selectedRole');
    
    // Если роль не выбрана или выбрана роль "cooperative"
    if (!selectedRole || selectedRole !== 'member') {
        window.location.href = 'index.html';
    }
})();
```

**cooperative-cabinet.html:**

```javascript
(function() {
    const selectedRole = localStorage.getItem('selectedRole');
    
    // Если роль не выбрана или выбрана роль "member"
    if (!selectedRole || selectedRole !== 'cooperative') {
        window.location.href = 'index.html';
    }
})();
```

### 3. Выход из системы

```javascript
function logout() {
    localStorage.removeItem('selectedRole');
    localStorage.removeItem('yandex_member_token');
    window.location.href = 'index.html';
}
```

---

## 🎨 ДИЗАЙН ИНТЕРФЕЙСА

### Главная страница (index.html)

**Элементы:**

```
┌─────────────────────────────────────────────────────────┐
│  🏠                                                     │
│  КООПЕРАНТ                                              │
│  Информационная система учёта пайщиков кооператива      │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  Выберите вашу роль                                     │
│                                                         │
│  ┌──────────────────┐    ┌──────────────────┐          │
│  │  👤              │    │  🏢              │          │
│  │  Пайщик          │    │  Кооператив      │          │
│  │                  │    │                  │          │
│  │  Физическое или  │    │  Председатель,   │          │
│  │  юридическое     │    │  бухгалтер,      │          │
│  │  лицо, член      │    │  администратор   │          │
│  │  кооператива     │    │  кооператива     │          │
│  │                  │    │                  │          │
│  │  ✓ Просмотр      │    │  ✓ Управление    │          │
│  │    своих взносов  │    │    реестром      │          │
│  │  ✓ Подача        │    │  ✓ Учёт взносов   │          │
│  │    заявлений     │    │  ✓ Бухгалтерия   │          │
│  │  ✓ Синхронизация │    │  ✓ Отчётность    │          │
│  │    с кооперативом│    │                  │          │
│  │                  │    │                  │          │
│  │  [Популярный]    │    │  [Для org]       │          │
│  └──────────────────┘    └──────────────────┘          │
│                                                         │
│              [ Продолжить → ]                           │
├─────────────────────────────────────────────────────────┤
│  🔒 Безопасно    ☁️ Облако         📱 Удобно            │
│  Яндекс.Диск     Хранение        Адаптивно             │
└─────────────────────────────────────────────────────────┘
```

---

## 📊 СРАВНЕНИЕ РОЛЕЙ

| Функция | Пайщик | Кооператив |
|---------|--------|------------|
| **Просмотр данных** | ✅ Своих | ✅ Всех пайщиков |
| **Редактирование** | ⚠️ Контактов | ✅ Всех данных |
| **Заявления** | ✅ Подавать | ✅ Рассматривать |
| **Взносы** | ✅ Просмотр | ✅ Добавлять |
| **Синхронизация** | ✅ С кооперативом | ✅ С пайщиками |
| **Отчёты** | ✅ Свои | ✅ Все отчёты |
| **Документы** | ✅ Скачивать | ✅ Создавать |

---

## 🎯 СЦЕНАРИИ ИСПОЛЬЗОВАНИЯ

### Сценарий 1: Пайщик входит в систему

```
1. Открывает index.html
        ↓
2. Выбирает роль «👤 Пайщик»
        ↓
3. Нажимает «Продолжить»
        ↓
4. Попадает в member-cabinet.html
        ↓
5. Работает с личным кабинетом
```

### Сценарий 2: Бухгалтер входит в систему

```
1. Открывает index.html
        ↓
2. Выбирает роль «🏢 Кооператив»
        ↓
3. Нажимает «Продолжить»
        ↓
4. Попадает в cooperative-cabinet.html
        ↓
5. Работает с панелью управления
```

### Сценарий 3: Повторный вход

```
1. Открывает index.html
        ↓
2. Система проверяет localStorage
        ↓
3. Если роль сохранена — предлагает выбрать снова
   или автоматически перенаправляет
```

---

## 🔐 БЕЗОПАСНОСТЬ

### Защита от несанкционированного доступа

```javascript
// В member-cabinet.html
if (!selectedRole || selectedRole !== 'member') {
    window.location.href = 'index.html'; // Перенаправление
}

// В cooperative-cabinet.html
if (!selectedRole || selectedRole !== 'cooperative') {
    window.location.href = 'index.html'; // Перенаправление
}
```

### Хранение роли

```javascript
// Сохранение
localStorage.setItem('selectedRole', 'member');

// Чтение
const role = localStorage.getItem('selectedRole');

// Удаление (выход)
localStorage.removeItem('selectedRole');
```

---

## 📱 АДАПТИВНОСТЬ

### Desktop (>1024px)

```
┌────────────────────────────────────────┐
│  [👤 Пайщик]      [🏢 Кооператив]      │
│                                         │
│  [ Продолжить ]                         │
└────────────────────────────────────────┘
```

### Tablet (768-1024px)

```
┌───────────────────────────┐
│  [👤 Пайщик]              │
│  [🏢 Кооператив]          │
│                           │
│  [ Продолжить ]           │
└───────────────────────────┘
```

### Mobile (<768px)

```
┌─────────────────┐
│  [👤 Пайщик]    │
│  [🏢 Коопера-   │
│   тив]          │
│                 │
│  [ Продолжить ] │
└─────────────────┘
```

---

## 🎨 ВИЗУАЛЬНЫЕ ЭФФЕКТЫ

### Анимации

```css
/* Плавное появление */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Пульсация при наведении */
.role-option:hover {
    transform: translateY(-5px);
    border-color: var(--primary-color);
}

/* Бегущая полоса */
.role-option::before {
    background: linear-gradient(90deg, 
        transparent, 
        var(--primary-color), 
        transparent
    );
}
```

### Тактильный отклик (Mobile)

```javascript
if (navigator.vibrate) {
    navigator.vibrate(50); // Вибрация при выборе
}
```

---

## 🧪 ТЕСТИРОВАНИЕ

### Чек-лист

- [ ] Откройте `index.html`
- [ ] Выберите роль «Пайщик»
- [ ] Нажмите «Продолжить»
- [ ] Проверьте перенаправление на `member-cabinet.html`
- [ ] Выберите роль «Кооператив»
- [ ] Нажмите «Продолжить»
- [ ] Проверьте перенаправление на `cooperative-cabinet.html`
- [ ] Выйдите из системы
- [ ] Проверьте возврат на `index.html`

### Тест на защиту

```
1. Откройте member-cabinet.html напрямую (без выбора роли)
   → Должно перенаправить на index.html

2. Откройте cooperative-cabinet.html с ролью «member»
   → Должно перенаправить на index.html

3. Откройте member-cabinet.html с ролью «cooperative」
   → Должно перенаправить на index.html
```

---

## 📊 СТАТИСТИКА

### Файлы системы:

| Файл | Строк | Назначение |
|------|-------|------------|
| `index.html` | 500+ | Главная: выбор роли |
| `member-cabinet.html` | 1480+ | Кабинет пайщика |
| `cooperative-cabinet.html` | 350+ | Кабинет кооператива |
| `member-app.js` | 1250+ | Логика пайщика |

### Функционал:

| Функция | Статус |
|---------|--------|
| Выбор роли | ✅ 100% |
| Перенаправление | ✅ 100% |
| Проверка роли | ✅ 100% |
| Выход из системы | ✅ 100% |
| Адаптивность | ✅ 100% |
| Анимации | ✅ 100% |
| Тактильный отклик | ✅ 100% |

---

## 🎯 СЛЕДУЮЩИЕ ШАГИ

### Для роли «Пайщик»:

✅ Личный кабинет готов  
✅ Синхронизация реализована  
✅ Заявления работают  

**В разработке:**
- ⏳ Интеграция с Яндекс.Диском кооператива
- ⏳ Telegram-бот для уведомлений

### Для роли «Кооператив»:

✅ Заготовка панели управления  

**В разработке:**
- ⏳ Модуль «Пайщики» (реестр, добавление)
- ⏳ Модуль «Взносы» (ПКО, РКО)
- ⏳ Модуль «Бухгалтерия» (проводки, отчёты)
- ⏳ Модуль «Заявления» (рассмотрение)

---

## ✅ ГОТОВНОСТЬ

| Компонент | Готовность |
|-----------|------------|
| Главная (выбор роли) | ✅ 100% |
| Кабинет пайщика | ✅ 85% |
| Кабинет кооператива | ✅ 20% |
| Защита ролей | ✅ 100% |
| Адаптивность | ✅ 100% |

**Общая готовность:** 🎯 **68%**

---

**Система выбора ролей готова к использованию! 🎉**
