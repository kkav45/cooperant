# ‚úÖ –Ø–ù–î–ï–ö–°.–î–ò–°–ö | –§–ò–ù–ê–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø

## üéâ –í—Å—ë –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ!

---

## üöÄ –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```
start.html ‚Üí –ö–∞–±–∏–Ω–µ—Ç –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞ ‚Üí index-cabinet-v2.html
```

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```
–õ–µ–≤–æ–µ –º–µ–Ω—é ‚Üí ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### –®–∞–≥ 3: –ù–∞–∂–º–∏—Ç–µ "üîê –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å"
- –í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –Ø–Ω–¥–µ–∫—Å OAuth
- **–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ –Ø–Ω–¥–µ–∫—Å–µ**
- **–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –¥–∏—Å–∫—É**
- –í—ã–±–µ—Ä–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞–∑—Ä–µ—à–∏—Ç—å"

### –®–∞–≥ 4: –î–æ–∂–¥–∏—Ç–µ—Å—å –≤–æ–∑–≤—Ä–∞—Ç–∞
- –ß–µ—Ä–µ–∑ 2-3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—è–≤–∏—Ç—Å—è —ç–∫—Ä–∞–Ω —É—Å–ø–µ—Ö–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```
‚úÖ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω
–ü–∞–ø–∫–∞: –ö–û–û–ü–ï–†–ê–ù–¢

[üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å]
[üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è]
[üö™ –í—ã–π—Ç–∏]
```

---

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏
```javascript
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—É—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞
sessionStorage.setItem('yandex_return_path', 'index-cabinet-v2.html');

// –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ OAuth
window.location.href = authUrl;
```

### 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```
https://oauth.yandex.ru/authorize?
  response_type=token&
  client_id=3772de21483443aba93e1889bd7ca4dc&
  redirect_uri=https://kkav45.github.io/cooperant/yandex-auth-callback.html&
  scope=cloud_api:disk.app_folder
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ callback
```javascript
// yandex-auth-callback.html
token = hashParams.get('access_token');
localStorage.setItem('yandexDiskToken', token);

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
```

### 4. –í–æ–∑–≤—Ä–∞—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```javascript
// –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≥–¥–µ –±—ã–ª–∏
window.location.href = returnUrl;

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
handleYandexCallback();
updateYandexDiskStatus();
```

---

## üìÅ –§–∞–π–ª—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|------------|--------|
| `start.html` | –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ | ‚úÖ |
| `index-cabinet-v2.html` | –ö–∞–±–∏–Ω–µ—Ç –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞ | ‚úÖ |
| `yandex-auth-callback.html` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | ‚úÖ |
| `yandex-disk-integration-v2.js` | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ø–Ω–¥–µ–∫—Å | ‚úÖ |
| `test-yandex-direct.html` | –¢–µ—Å—Ç OAuth | ‚úÖ |

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω
–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
localStorage.getItem('yandexDiskToken')
// –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: y0_AgA...
```

### 2. –ü–∞–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∞
```javascript
localStorage.getItem('yandexCooperativFolderId')
// –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: ID –ø–∞–ø–∫–∏
```

### 3. API —Ä–∞–±–æ—Ç–∞–µ—Ç
```javascript
fetch('https://cloud-api.yandex.net/v1/disk/resources?path=app-folder:/', {
    headers: { 'Authorization': `OAuth ${localStorage.getItem('yandexDiskToken')}` }
})
.then(r => r.json())
.then(d => console.log('–ü–∞–ø–∫–∞:', d.name))
// –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏: –ü–∞–ø–∫–∞: –ö–û–û–ü–ï–†–ê–ù–¢
```

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞"
**–ü—Ä–∏—á–∏–Ω–∞:** –û–∫–Ω–æ –∑–∞–∫—Ä—ã–ª–æ—Å—å –¥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–π–¥–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ, –¥–æ–∂–¥–∏—Ç–µ—Å—å —ç–∫—Ä–∞–Ω–∞ —É—Å–ø–µ—Ö–∞

### "invalid_scope"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –≤—ã–±—Ä–∞–Ω—ã –ø—Ä–∞–≤–∞ –≤ OAuth Console  
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–±–µ—Ä–∏—Ç–µ `cloud_api:disk.app_folder` –≤ –Ø–Ω–¥–µ–∫—Å OAuth Console

### "Redirect URI mismatch"
**–ü—Ä–∏—á–∏–Ω–∞:** URI –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redirect URI –≤ OAuth Console:
```
https://kkav45.github.io/cooperant/yandex-auth-callback.html
```

### –í–æ–∑–≤—Ä–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–ü—Ä–∏—á–∏–Ω–∞:** sessionStorage –æ—á–∏—â–µ–Ω  
**–†–µ—à–µ–Ω–∏–µ:** –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" –≤—Ä—É—á–Ω—É—é

---

## üìä –õ–æ–≥–∏

### –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```
[Yandex] –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é...
[Yandex Callback] DOM –∑–∞–≥—Ä—É–∂–µ–Ω
[Yandex Callback] –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω –≤ hash: y0_AgA...
[Yandex Callback] –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ localStorage
[Yandex Callback] –ü–æ–∫–∞–∑–∞–Ω —ç–∫—Ä–∞–Ω —É—Å–ø–µ—Ö–∞
[Yandex Callback] –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è...
[Yandex] –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
[Yandex] –ü–∞–ø–∫–∞ –ö–û–û–ü–ï–†–ê–ù–¢ –≥–æ—Ç–æ–≤–∞
```

### –û—à–∏–±–∫–∏
```
[Yandex Callback] –¢–æ–∫–µ–Ω –ù–ï –Ω–∞–π–¥–µ–Ω –≤ URL
[Yandex Callback] –ü–æ–∫–∞–∑ –æ—à–∏–±–∫–∏: –¢–æ–∫–µ–Ω –Ω–µ –ø–æ–ª—É—á–µ–Ω
```

---

## üéØ –ò—Ç–æ–≥

**–Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω:**

1. ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è **–≤ —Ç–æ–º –∂–µ –æ–∫–Ω–µ** (–Ω–µ popup)
2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. ‚úÖ –¢–æ–∫–µ–Ω **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage**
4. ‚úÖ –ü–∞–ø–∫–∞ **—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**
5. ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
6. ‚úÖ **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
1. ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ** - –Ω–∞–∂–º–∏—Ç–µ "üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å"
2. ‚úÖ **–°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é** - –Ω–∞–∂–º–∏—Ç–µ "üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è"
3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É** –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–µ - `/–ö–û–û–ü–ï–†–ê–ù–¢/`

### –î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã:
- ‚úÖ –ù–µ –æ—á–∏—â–∞–π—Ç–µ localStorage
- ‚úÖ –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
- ‚úÖ –î–æ–±–∞–≤—å—Ç–µ —Å–∞–π—Ç –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞

---

**–í–µ—Ä—Å–∏—è:** 2.4  
**–î–∞—Ç–∞:** 21 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç!
