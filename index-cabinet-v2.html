<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#2196F3">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤ –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä | –ö–û–û–ü–ï–†–ê–ù–¢</title>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè†</text></svg>">

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- Google Fonts: Roboto (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap&subset=cyrillic" rel="stylesheet">

    <style>
        :root {
            --primary-color: #2196F3;
            --primary-dark: #1976D2;
            --primary-light: #BBDEFB;
            --success-color: #4CAF50;
            --warning-color: #FF9800;
            --danger-color: #F44336;
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-primary: #212121;
            --text-secondary: #757575;
            --border-color: #e0e0e0;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 16px rgba(0,0,0,0.15);
            --radius: 16px;
            --radius-sm: 10px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { 
            height: 100%;
            overflow: hidden;
            -webkit-overflow-scrolling: touch;
        }
        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 16px 24px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 600;
        }
        .logo-icon { font-size: 28px; }
        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .sync-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .sync-status:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        .sync-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-color);
            flex-shrink: 0;
        }
        .sync-indicator.syncing {
            background: var(--warning-color);
            animation: pulse 1s infinite;
        }
        .sync-indicator.error {
            background: var(--danger-color);
        }
        .sync-indicator.disconnected {
            background: var(--text-secondary);
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .notification-badge {
            position: relative;
            cursor: pointer;
            font-size: 22px;
        }
        .notification-count {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--danger-color);
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 2px 5px;
            border-radius: 10px;
            min-width: 16px;
            text-align: center;
        }
        .user-menu {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .user-info { text-align: right; }
        .user-name { font-weight: 600; font-size: 14px; }
        .user-role { font-size: 12px; opacity: 0.9; }
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            height: calc(100% - 64px);
            max-height: calc(100dvh - 64px);
        }

        /* Sidebar Menu */
        .sidebar-menu {
            width: 320px;
            min-width: 320px;
            background: var(--card-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .menu-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
        }
        .menu-title { font-size: 18px; font-weight: 600; margin-bottom: 4px; }
        .menu-subtitle { font-size: 13px; opacity: 0.9; }
        .menu-search {
            padding: 12px 16px;
            background: #f5f7fa;
            border-bottom: 1px solid var(--border-color);
        }
        .menu-search input {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 14px;
            outline: none;
            background: var(--card-bg);
            color: var(--text-primary);
        }
        .menu-search input:focus { border-color: var(--primary-color); }
        .menu-content { flex: 1; overflow-y: auto; padding: 8px 0; }
        .menu-section { padding: 12px 0; border-bottom: 1px solid #f0f0f0; }
        .menu-section-title {
            padding: 8px 20px;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s;
            gap: 12px;
        }
        .menu-item:hover { background: #f5f7fa; }
        .menu-item.active {
            background: var(--primary-light);
            border-right: 3px solid var(--primary-color);
        }
        .menu-item-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }
        .menu-item-info { flex: 1; min-width: 0; }
        .menu-item-name {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .menu-item-subtitle {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .menu-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            background: #e0e0e0;
            color: var(--text-secondary);
            flex-shrink: 0;
        }
        .menu-badge.alert { background: #ffebee; color: var(--danger-color); }
        .menu-badge.success { background: #e8f5e9; color: var(--success-color); }
        .menu-arrow { color: #ccc; margin-left: 8px; font-size: 14px; }

        /* Submenu */
        .submenu {
            display: none;
            padding: 8px 0;
            background: #fafafa;
        }
        .submenu.open { display: block; }
        .submenu-item {
            display: flex;
            align-items: center;
            padding: 10px 20px 10px 56px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
            gap: 10px;
        }
        .submenu-item:hover { background: var(--primary-light); }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .content-tabs {
            display: flex;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 0 20px;
            flex-shrink: 0;
        }
        .content-tab {
            padding: 16px 24px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
            transition: all 0.2s;
        }
        .content-tab:hover { color: var(--primary-color); }
        .content-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        .stat-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }
        .stat-card.secondary { background: linear-gradient(135deg, var(--success-color), #388E3C); }
        .stat-card.warning { background: linear-gradient(135deg, var(--warning-color), #F57C00); }
        .stat-card.danger { background: linear-gradient(135deg, var(--danger-color), #D32F2F); }
        .stat-value { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
        .stat-label { font-size: 13px; opacity: 0.9; }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
            transition: box-shadow 0.2s;
        }
        .card:hover { box-shadow: var(--shadow-hover); }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        .card-title { font-size: 16px; font-weight: 600; color: var(--text-primary); }
        .card-subtitle { font-size: 13px; color: var(--text-secondary); margin-top: 4px; }

        /* Members List */
        .members-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .member-item {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            background: #f5f7fa;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s;
            gap: 14px;
        }
        .member-item:hover {
            background: var(--primary-light);
            transform: translateX(4px);
        }
        .member-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            flex-shrink: 0;
        }
        .member-info { flex: 1; min-width: 0; }
        .member-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .member-details {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        .member-status {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 500;
            flex-shrink: 0;
        }
        .member-status::before { content: '‚óè'; font-size: 8px; }
        .member-status.active { background: #e8f5e9; color: var(--success-color); }
        .member-status.debt { background: #ffebee; color: var(--danger-color); }
        .member-status.pending { background: #fff3e0; color: var(--warning-color); }
        .member-balance {
            font-weight: 600;
            font-size: 13px;
            flex-shrink: 0;
        }
        .member-balance.positive { color: var(--success-color); }
        .member-balance.negative { color: var(--danger-color); }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }
        .quick-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px;
            background: #f5f7fa;
            border-radius: var(--radius-sm);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            gap: 8px;
        }
        .quick-action-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }
        .quick-action-icon { font-size: 28px; }
        .quick-action-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            text-align: center;
        }

        /* FAB Button */
        .fab-container {
            position: fixed;
            right: 24px;
            bottom: 24px;
            z-index: 1000;
        }
        .fab-main {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
            cursor: pointer;
            font-size: 24px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .fab-main:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(33, 150, 243, 0.5);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(4px);
        }
        .modal-overlay.active { display: flex; }
        .modal {
            background: var(--card-bg);
            border-radius: var(--radius);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            animation: modalSlideUp 0.3s ease;
        }
        @keyframes modalSlideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-title { font-size: 18px; font-weight: 600; }
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }
        .modal-close:hover { background: #f5f7fa; }
        .modal-body { padding: 24px; }
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-secondary { background: #f5f7fa; color: var(--text-primary); }
        .btn-secondary:hover { background: #e0e0e0; }
        .btn-block { width: 100%; justify-content: center; }

        /* Form */
        .form-group { margin-bottom: 16px; }
        .form-label {
            display: block;
            margin-bottom: 6px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }
        .form-input {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 14px;
            transition: border-color 0.2s;
            background: var(--card-bg);
            color: var(--text-primary);
        }
        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        /* Toast */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .toast {
            min-width: 300px;
            padding: 16px 20px;
            border-radius: var(--radius-sm);
            background: var(--card-bg);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease;
        }
        @keyframes slideInRight {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast.success { background: #e8f5e9; border-left: 4px solid var(--success-color); }
        .toast.error { background: #ffebee; border-left: 4px solid var(--danger-color); }
        .toast.warning { background: #fff3e0; border-left: 4px solid var(--warning-color); }
        .toast.info { background: #e3f2fd; border-left: 4px solid var(--primary-color); }
        .toast-icon { font-size: 20px; }
        .toast-message { flex: 1; font-size: 14px; color: var(--text-primary); }

        /* Report Table */
        .report-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        .report-table th,
        .report-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        .report-table th {
            background: #f5f7fa;
            font-weight: 600;
            color: var(--text-primary);
        }
        .report-table tr:hover { background: #f5f7fa; }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar-menu { width: 280px; min-width: 280px; }
        }
        @media (max-width: 768px) {
            .sidebar-menu {
                position: fixed;
                left: 0;
                top: 0;
                height: 100%;
                z-index: 150;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            .sidebar-menu.visible { transform: translateX(0); }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .header-content { flex-wrap: wrap; gap: 12px; }
            .user-info { display: none; }
            .content-tabs { overflow-x: auto; }
            .content-tab { padding: 14px 16px; font-size: 13px; white-space: nowrap; }
            .modal { max-width: 95%; }
            .form-row { grid-template-columns: 1fr; }
        }
        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: 1fr 1fr; }
            .stat-value { font-size: 22px; }
            .stat-label { font-size: 11px; }
            .quick-actions { grid-template-columns: repeat(2, 1fr); }
            .quick-action-btn { padding: 12px; }
            .quick-action-icon { font-size: 24px; }
            .quick-action-label { font-size: 11px; }
            .member-item { padding: 12px; }
            .member-avatar { width: 40px; height: 40px; font-size: 14px; }
            .member-details { display: none; }
            .toast { min-width: auto; max-width: calc(100% - 40px); }
            .modal-body { padding: 16px; }
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üè†</span>
                <span>–ö–û–û–ü–ï–†–ê–ù–¢</span>
            </div>
            <div class="header-actions">
                <div class="sync-status">
                    <div class="sync-indicator" id="syncIndicator"></div>
                    <span id="syncText">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ</span>
                </div>
                <div class="notification-badge" onclick="showNotifications()">
                    üîî
                    <span class="notification-count" id="notifCount">3</span>
                </div>
                <div class="user-menu">
                    <div class="user-info">
                        <div class="user-name" id="userName">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                        <div class="user-role">–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div>
                    </div>
                    <div class="avatar" onclick="showProfile()">üë§</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Sidebar Menu -->
        <aside class="sidebar-menu" id="sidebarMenu">
            <div class="menu-header">
                <div class="menu-title">üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div>
                <div class="menu-subtitle">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
            </div>

            <div class="menu-search">
                <input type="text" placeholder="üîç –ü–æ–∏—Å–∫ —Ñ—É–Ω–∫—Ü–∏–π..." id="menuSearch">
            </div>

            <div class="menu-content">
                <!-- ‚ö° –ë–´–°–¢–†–´–ô –î–û–°–¢–£–ü -->
                <div class="menu-section">
                    <div class="menu-section-title">‚ö° –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</div>
                    <div class="menu-item active" data-section="dashboard">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–∞—à–±–æ—Ä–¥</div>
                            <div class="menu-item-subtitle">–û–±–∑–æ—Ä –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div>
                        </div>
                    </div>
                    <div class="menu-item" data-section="members">
                        <div class="menu-item-icon" style="background:#e8f5e9">üë•</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–∞–π—â–∏–∫–∏</div>
                            <div class="menu-item-subtitle">–†–µ–µ—Å—Ç—Ä —á–ª–µ–Ω–æ–≤</div>
                        </div>
                        <span class="menu-badge success" id="membersCountBadge">12</span>
                    </div>
                </div>

                <!-- üë• –ü–ê–ô–©–ò–ö–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">üë• –ü–∞–π—â–∏–∫–∏</div>
                    <div class="menu-item" data-action="create-member">
                        <div class="menu-item-icon" style="background:#e8f5e9">‚ûï</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–æ–±–∞–≤–∏—Ç—å –ø–∞–π—â–∏–∫–∞</div>
                            <div class="menu-item-subtitle">–ù–æ–≤—ã–π —á–ª–µ–Ω</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="edit-member">
                        <div class="menu-item-icon" style="background:#e8f5e9">‚úèÔ∏è</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</div>
                            <div class="menu-item-subtitle">–ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="certificates-registry-full">
                        <div class="menu-item-icon" style="background:#fce4ec">üìú</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–í—ã–¥–∞–Ω–Ω—ã–µ –±–ª–∞–Ω–∫–∏</div>
                        </div>
                    </div>
                </div>

                <!-- üí≥ –í–ó–ù–û–°–´ -->
                <div class="menu-section">
                    <div class="menu-section-title">üí≥ –í–∑–Ω–æ—Å—ã</div>
                    <div class="menu-item" data-action="create-payment">
                        <div class="menu-item-icon" style="background:#e3f2fd">‚ûï</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–î–æ–±–∞–≤–∏—Ç—å –≤–∑–Ω–æ—Å</div>
                            <div class="menu-item-subtitle">–ù–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="create-return-payment">
                        <div class="menu-item-icon" style="background:#ffebee">‚Ü©Ô∏è</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–í–æ–∑–≤—Ä–∞—Ç –≤–∑–Ω–æ—Å–∞</div>
                            <div class="menu-item-subtitle">–û—Ñ–æ—Ä–º–∏—Ç—å –≤–æ–∑–≤—Ä–∞—Ç</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="payments-report-full">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º</div>
                            <div class="menu-item-subtitle">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</div>
                        </div>
                    </div>
                </div>

                <!-- üìò –ë–£–•–ì–ê–õ–¢–ï–†–ò–Ø -->
                <div class="menu-section">
                    <div class="menu-section-title">üìò –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è</div>
                    <div class="menu-item" data-action="create-transaction">
                        <div class="menu-item-icon" style="background:#fff3e0">üìí</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü—Ä–æ–≤–æ–¥–∫–∞</div>
                            <div class="menu-item-subtitle">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è –∑–∞–ø–∏—Å—å</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="osv">
                        <div class="menu-item-icon" style="background:#fff3e0">üìà</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û–°–í</div>
                            <div class="menu-item-subtitle">–û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="pko">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–ö–û</div>
                            <div class="menu-item-subtitle">–ü—Ä–∏—Ö–æ–¥–Ω—ã–π –æ—Ä–¥–µ—Ä</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="rko">
                        <div class="menu-item-icon" style="background:#e3f2fd">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–ö–û</div>
                            <div class="menu-item-subtitle">–†–∞—Å—Ö–æ–¥–Ω—ã–π –æ—Ä–¥–µ—Ä</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="payment-order">
                        <div class="menu-item-icon" style="background:#e8f5e9">üí∞</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–ª–∞—Ç—ë–∂–Ω–æ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ</div>
                            <div class="menu-item-subtitle">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–ª–∞—Ç—ë–∂</div>
                        </div>
                    </div>
                    <div class="menu-item" data-submenu="accounting-reports">
                        <div class="menu-item-icon" style="background:#fff3e0">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–û—Ç—á—ë—Ç—ã</div>
                            <div class="menu-item-subtitle">–ë–∞–ª–∞–Ω—Å—ã, —Å–ø—Ä–∞–≤–∫–∏</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="submenu" id="submenu-accounting-reports">
                        <div class="submenu-item" data-report="balance">‚öñÔ∏è –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å</div>
                        <div class="submenu-item" data-report="profit-loss">üìà –û—Ç—á—ë—Ç –æ —Ñ–∏–Ω. —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö</div>
                        <div class="submenu-item" data-report="target-use">üéØ –û—Ç—á—ë—Ç –æ —Ü–µ–ª–µ–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏</div>
                        <div class="submenu-item" data-report="accounting-certificate">üìÑ –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞</div>
                    </div>
                </div>

                <!-- üìô –ù–ê–õ–û–ì–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">üìô –ù–∞–ª–æ–≥–∏</div>
                    <div class="menu-item" data-report="kudir">
                        <div class="menu-item-icon" style="background:#fff3e0">üìñ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–£–î–∏–†</div>
                            <div class="menu-item-subtitle">–ö–Ω–∏–≥–∞ —É—á—ë—Ç–∞</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="act-sverka">
                        <div class="menu-item-icon" style="background:#f5f5f5">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ê–∫—Ç —Å–≤–µ—Ä–∫–∏</div>
                            <div class="menu-item-subtitle">–°–≤–µ—Ä–∫–∞ —Å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º–∏</div>
                        </div>
                    </div>
                    <div class="menu-item" data-submenu="zero-reporting">
                        <div class="menu-item-icon" style="background:#f5f5f5">‚àÖ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ù—É–ª–µ–≤–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å</div>
                            <div class="menu-item-subtitle">–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="submenu" id="submenu-zero-reporting">
                        <div class="submenu-item" data-action="generate-usn-zero">üìã –î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù</div>
                        <div class="submenu-item" data-action="generate-balance-zero">‚öñÔ∏è –ë–∞–ª–∞–Ω—Å</div>
                        <div class="submenu-item" data-action="generate-szv-zero">üìä –°–ó–í-–°–¢–ê–ñ</div>
                        <div class="submenu-item" data-action="generate-rsv-zero">üìä –†–°–í</div>
                        <div class="submenu-item" data-action="generate-sredn-zero">üë• –°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è</div>
                    </div>
                </div>

                <!-- üìó –£–ü–†–ê–í–õ–ï–ù–ß–ï–°–ö–ò–ô –£–ß–Å–¢ -->
                <div class="menu-section">
                    <div class="menu-section-title">üìó –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á—ë—Ç</div>
                    <div class="menu-item" data-submenu="analytics">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìà</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
                            <div class="menu-item-subtitle">–û—Ç—á—ë—Ç—ã, –≥—Ä–∞—Ñ–∏–∫–∏</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="submenu" id="submenu-analytics">
                        <div class="submenu-item" data-report="members-report-full">üìã –†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤</div>
                        <div class="submenu-item" data-report="payments-report-full">üí≥ –û—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º</div>
                        <div class="submenu-item" data-report="financial-report-full">üìà –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç</div>
                        <div class="submenu-item" data-report="debt-report">‚ö†Ô∏è –û—Ç—á—ë—Ç –æ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö</div>
                    </div>
                    <div class="menu-item" data-submenu="funds">
                        <div class="menu-item-icon" style="background:#e8f5e9">üí∞</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–§–æ–Ω–¥—ã</div>
                            <div class="menu-item-subtitle">–û—Ç—á—ë—Ç—ã –ø–æ —Ñ–æ–Ω–¥–∞–º</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="submenu" id="submenu-funds">
                        <div class="submenu-item" data-report="share-fund">üí∞ –ü–∞–µ–≤–æ–π —Ñ–æ–Ω–¥</div>
                        <div class="submenu-item" data-report="development-fund">üöÄ –§–æ–Ω–¥ —Ä–∞–∑–≤–∏—Ç–∏—è</div>
                        <div class="submenu-item" data-report="business-fund">üè¢ –§–æ–Ω–¥ —Ö–æ–∑. –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</div>
                        <div class="submenu-item" data-report="funds-analytics">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ñ–æ–Ω–¥–æ–≤</div>
                        <div class="submenu-item" data-report="indivisible-fund">üèõÔ∏è –ù–µ–¥–µ–ª–∏–º—ã–π —Ñ–æ–Ω–¥</div>
                        <div class="submenu-item" data-report="reserve-fund">üõ°Ô∏è –†–µ–∑–µ—Ä–≤–Ω—ã–π —Ñ–æ–Ω–¥</div>
                    </div>
                    <div class="menu-item" data-submenu="meetings">
                        <div class="menu-item-icon" style="background:#e8f5e9">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–°–æ–±—Ä–∞–Ω–∏—è</div>
                            <div class="menu-item-subtitle">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="submenu" id="submenu-meetings">
                        <div class="submenu-item" data-action="create-meeting">‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª</div>
                        <div class="submenu-item" data-report="meeting-protocol-full">üìù –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–±—Ä–∞–Ω–∏—è</div>
                        <div class="submenu-item" data-report="attendance-list-full">‚úçÔ∏è –õ–∏—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                    </div>
                    <div class="menu-item" data-submenu="control">
                        <div class="menu-item-icon" style="background:#e8f5e9">‚è∞</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ö–æ–Ω—Ç—Ä–æ–ª—å</div>
                            <div class="menu-item-subtitle">–°—Ä–æ–∫–∏, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</div>
                        </div>
                        <span class="menu-arrow">‚Üí</span>
                    </div>
                    <div class="submenu" id="submenu-control">
                        <div class="submenu-item" data-action="add-calendar-event">‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</div>
                        <div class="submenu-item" data-report="calendar-full">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</div>
                        <div class="submenu-item" data-report="control-dashboard">‚è∞ –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤</div>
                    </div>
                </div>

                <!-- üìÅ –î–û–ö–£–ú–ï–ù–¢–´ -->
                <div class="menu-section">
                    <div class="menu-section-title">üìÅ –î–æ–∫—É–º–µ–Ω—Ç—ã</div>
                    <div class="menu-item" data-action="create-document">
                        <div class="menu-item-icon" style="background:#f5f7fa">üìÅ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</div>
                            <div class="menu-item-subtitle">–ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</div>
                        </div>
                    </div>
                    <div class="menu-item" data-action="invoice">
                        <div class="menu-item-icon" style="background:#f5f7fa">üìÑ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–°—á—ë—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É</div>
                            <div class="menu-item-subtitle">–í—ã—Å—Ç–∞–≤–∏—Ç—å —Å—á—ë—Ç</div>
                        </div>
                    </div>
                </div>

                <!-- üìã –ó–ê–Ø–í–õ–ï–ù–ò–Ø -->
                <div class="menu-section">
                    <div class="menu-section-title">üìã –ó–∞—è–≤–ª–µ–Ω–∏—è</div>
                    <div class="menu-item" data-action="create-application">
                        <div class="menu-item-icon" style="background:#fce4ec">üìù</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ</div>
                            <div class="menu-item-subtitle">–ù–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ</div>
                        </div>
                    </div>
                    <div class="menu-item" data-report="applications-registry">
                        <div class="menu-item-icon" style="background:#fce4ec">üìã</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–µ—Å—Ç—Ä –∑–∞—è–≤–ª–µ–Ω–∏–π</div>
                            <div class="menu-item-subtitle">–í—Å–µ –∑–∞—è–≤–ª–µ–Ω–∏—è</div>
                        </div>
                    </div>
                </div>

                <!-- ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò -->
                <div class="menu-section">
                    <div class="menu-section-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                    <div class="menu-item" data-panel="profile">
                        <div class="menu-item-icon" style="background:#e0e0e0">üë§</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–ü—Ä–æ—Ñ–∏–ª—å</div>
                            <div class="menu-item-subtitle">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="toggleDarkMode()">
                        <div class="menu-item-icon" style="background:#e0e0e0">üåì</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–¢—ë–º–Ω–∞—è —Ç–µ–º–∞</div>
                            <div class="menu-item-subtitle">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É</div>
                        </div>
                    </div>
                    <div class="menu-item" onclick="exportMembersToExcel()">
                        <div class="menu-item-icon" style="background:#e0e0e0">üìä</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</div>
                            <div class="menu-item-subtitle">–í—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
                        </div>
                    </div>
                    <div class="menu-item" data-panel="backup">
                        <div class="menu-item-icon" style="background:#e0e0e0">üíæ</div>
                        <div class="menu-item-info">
                            <div class="menu-item-name">–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                            <div class="menu-item-subtitle">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Tabs -->
            <div class="content-tabs">
                <button class="content-tab active" onclick="switchTab('dashboard')">üìä –î–∞—à–±–æ—Ä–¥</button>
                <button class="content-tab" onclick="switchTab('members')">üë• –ü–∞–π—â–∏–∫–∏</button>
                <button class="content-tab" onclick="switchTab('payments')">üí≥ –í–∑–Ω–æ—Å—ã</button>
                <button class="content-tab" onclick="switchTab('reports')">üìà –û—Ç—á—ë—Ç—ã</button>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Tab: Dashboard -->
                <div id="tab-dashboard" class="tab-content">
                    <!-- Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalMembers">12</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –ø–∞–π—â–∏–∫–æ–≤</div>
                        </div>
                        <div class="stat-card secondary">
                            <div class="stat-value" id="activeMembers">9</div>
                            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-value" id="debtMembers">2</div>
                            <div class="stat-label">–î–æ–ª–∂–Ω–∏–∫–æ–≤</div>
                        </div>
                        <div class="stat-card danger">
                            <div class="stat-value" id="totalDebt">45 000 ‚ÇΩ</div>
                            <div class="stat-label">–û–±—â–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</div>
                                <div class="card-subtitle">–ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</div>
                            </div>
                        </div>
                        <div class="quick-actions">
                            <button class="quick-action-btn" onclick="showCreateMemberModal()">
                                <span class="quick-action-icon">üë§</span>
                                <span class="quick-action-label">–î–æ–±–∞–≤–∏—Ç—å –ø–∞–π—â–∏–∫–∞</span>
                            </button>
                            <button class="quick-action-btn" onclick="showCreatePaymentModal()">
                                <span class="quick-action-icon">üí≥</span>
                                <span class="quick-action-label">–í–Ω–µ—Å—Ç–∏ –≤–∑–Ω–æ—Å</span>
                            </button>
                            <button class="quick-action-btn" onclick="showCreateTransactionModal()">
                                <span class="quick-action-icon">üìí</span>
                                <span class="quick-action-label">–ü—Ä–æ–≤–æ–¥–∫–∞</span>
                            </button>
                            <button class="quick-action-btn" onclick="showUploadDocumentModal()">
                                <span class="quick-action-icon">üìÑ</span>
                                <span class="quick-action-label">–î–æ–∫—É–º–µ–Ω—Ç</span>
                            </button>
                            <button class="quick-action-btn" onclick="showSubmitApplicationModal()">
                                <span class="quick-action-icon">üìã</span>
                                <span class="quick-action-label">–ó–∞—è–≤–ª–µ–Ω–∏–µ</span>
                            </button>
                        </div>
                    </div>

                    <!-- Recent Members -->
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">üë• –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–∞–π—â–∏–∫–∏</div>
                                <div class="card-subtitle">–ù–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ</div>
                            </div>
                            <button class="btn btn-secondary" onclick="switchTab('members')">–í—Å–µ –ø–∞–π—â–∏–∫–∏ ‚Üí</button>
                        </div>
                        <div class="members-list" id="recentMembersList">
                            <!-- Members will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Tab: Members -->
                <div id="tab-members" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">üë• –†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤</div>
                                <div class="card-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–ª–µ–Ω–∞–º–∏ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div>
                            </div>
                            <button class="btn btn-primary" onclick="showCreateMemberModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                        <div class="members-list" id="membersList">
                            <!-- Members will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Tab: Payments -->
                <div id="tab-payments" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">üí≥ –í–∑–Ω–æ—Å—ã</div>
                                <div class="card-subtitle">–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π</div>
                            </div>
                            <button class="btn btn-primary" onclick="showCreatePaymentModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                        <div id="paymentsList">
                            <!-- Payments will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Tab: Reports -->
                <div id="tab-reports" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">üìà –û—Ç—á—ë—Ç—ã</div>
                                <div class="card-subtitle">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã</div>
                            </div>
                        </div>
                        <div class="quick-actions">
                            <button class="quick-action-btn" onclick="openReportByName('members-registry-full')">
                                <span class="quick-action-icon">üìã</span>
                                <span class="quick-action-label">–†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤</span>
                            </button>
                            <button class="quick-action-btn" onclick="openReportByName('payments-report-full')">
                                <span class="quick-action-icon">üí≥</span>
                                <span class="quick-action-label">–û—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º</span>
                            </button>
                            <button class="quick-action-btn" onclick="openReportByName('osv')">
                                <span class="quick-action-icon">üìà</span>
                                <span class="quick-action-label">–û–°–í</span>
                            </button>
                            <button class="quick-action-btn" onclick="openReportByName('balance')">
                                <span class="quick-action-icon">‚öñÔ∏è</span>
                                <span class="quick-action-label">–ë–∞–ª–∞–Ω—Å</span>
                            </button>
                            <button class="quick-action-btn" onclick="openReportByName('kudir')">
                                <span class="quick-action-icon">üìñ</span>
                                <span class="quick-action-label">–ö–£–î–∏–†</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- FAB Button -->
    <div class="fab-container">
        <button class="fab-main" onclick="toggleFab()" title="–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è">+</button>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- ============================================
         MODAL WINDOWS
    ============================================ -->

    <!-- Modal: Create Member -->
    <div class="modal-overlay" id="createMemberModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‚ûï –ù–æ–≤—ã–π –ø–∞–π—â–∏–∫</div>
                <button class="modal-close" onclick="closeModal('createMemberModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–§–ò–û *</label>
                    <input type="text" class="form-input" id="newMemberName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="tel" class="form-input" id="newMemberPhone" placeholder="+7 (900) 123-45-67">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="newMemberEmail" placeholder="email@example.com">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å (‚ÇΩ)</label>
                        <input type="number" class="form-input" id="newMemberFee" value="1000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ü–∞–µ–≤–æ–π –≤–∑–Ω–æ—Å (‚ÇΩ)</label>
                        <input type="number" class="form-input" id="newMemberShare" value="10000">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                    <input type="date" class="form-input" id="newMemberBirthDate">
                </div>
                <div class="form-group">
                    <label class="form-label">–ê–¥—Ä–µ—Å</label>
                    <input type="text" class="form-input" id="newMemberAddress" placeholder="–ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createMemberModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleCreateMember(event)">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Edit Member -->
    <div class="modal-overlay" id="editMemberModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–π—â–∏–∫–∞</div>
                <button class="modal-close" onclick="closeModal('editMemberModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–§–ò–û *</label>
                    <input type="text" class="form-input" id="editMemberName">
                    <input type="hidden" id="editMemberId">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="tel" class="form-input" id="editMemberPhone">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="editMemberEmail">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">–ë–∞–ª–∞–Ω—Å (‚ÇΩ)</label>
                    <input type="number" class="form-input" id="editMemberBalance" readonly>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('editMemberModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleEditMemberSave()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Create Payment -->
    <div class="modal-overlay" id="createPaymentModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üí≥ –ù–æ–≤—ã–π –≤–∑–Ω–æ—Å</div>
                <button class="modal-close" onclick="closeModal('createPaymentModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ü–∞–π—â–∏–∫ *</label>
                    <select class="form-input" id="paymentMember">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞ (‚ÇΩ) *</label>
                        <input type="number" class="form-input" id="paymentAmount" placeholder="1000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–¢–∏–ø –≤–∑–Ω–æ—Å–∞</label>
                        <select class="form-input" id="paymentType">
                            <option value="entrance">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π</option>
                            <option value="share">–ü–∞–µ–≤–æ–π</option>
                            <option value="member">–ß–ª–µ–Ω—Å–∫–∏–π</option>
                            <option value="additional">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞</label>
                    <input type="date" class="form-input" id="paymentDate">
                </div>
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="paymentDescription" placeholder="–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createPaymentModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleCreatePayment(event)">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Return Payment -->
    <div class="modal-overlay" id="returnPaymentModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç –≤–∑–Ω–æ—Å–∞</div>
                <button class="modal-close" onclick="closeModal('returnPaymentModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ü–∞–π—â–∏–∫ *</label>
                    <select class="form-input" id="returnPaymentMember">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞ –∫ –≤–æ–∑–≤—Ä–∞—Ç—É (‚ÇΩ)</label>
                    <input type="number" class="form-input" id="returnPaymentAmount" placeholder="5000">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü—Ä–∏—á–∏–Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞</label>
                    <textarea class="form-input" id="returnPaymentReason" rows="3" placeholder="–ü—Ä–∏—á–∏–Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤–∑–Ω–æ—Å–∞"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('returnPaymentModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleReturnPayment(event)">üíæ –û—Ñ–æ—Ä–º–∏—Ç—å –≤–æ–∑–≤—Ä–∞—Ç</button>
            </div>
        </div>
    </div>

    <!-- Modal: Create Transaction -->
    <div class="modal-overlay" id="createTransactionModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìí –ù–æ–≤–∞—è –ø—Ä–æ–≤–æ–¥–∫–∞</div>
                <button class="modal-close" onclick="closeModal('createTransactionModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ *</label>
                        <select class="form-input" id="transactionType">
                            <option value="income">–î–æ—Ö–æ–¥</option>
                            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞ (‚ÇΩ) *</label>
                        <input type="number" class="form-input" id="transactionAmount" placeholder="1000">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–°—á—ë—Ç –î—Ç *</label>
                        <input type="text" class="form-input" id="transactionDebit" placeholder="50">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–°—á—ë—Ç –ö—Ç *</label>
                        <input type="text" class="form-input" id="transactionCredit" placeholder="62">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</label>
                    <input type="text" class="form-input" id="transactionDescription" placeholder="–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞">
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞</label>
                    <input type="date" class="form-input" id="transactionDate">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createTransactionModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleCreateTransaction(event)">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: PKO -->
    <div class="modal-overlay" id="pkoModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìù –ü–ö–û (–ü—Ä–∏—Ö–æ–¥–Ω—ã–π –∫–∞—Å—Å–æ–≤—ã–π –æ—Ä–¥–µ—Ä)</div>
                <button class="modal-close" onclick="closeModal('pkoModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–æ–º–µ—Ä –æ—Ä–¥–µ—Ä–∞</label>
                    <input type="text" class="form-input" id="pkoNumber" placeholder="1">
                </div>
                <div class="form-group">
                    <label class="form-label">–û—Ç –∫–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–æ *</label>
                    <input type="text" class="form-input" id="pkoFrom" placeholder="–§–ò–û –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞">
                </div>
                <div class="form-group">
                    <label class="form-label">–û—Å–Ω–æ–≤–∞–Ω–∏–µ *</label>
                    <input type="text" class="form-input" id="pkoReason" placeholder="–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞ (‚ÇΩ) *</label>
                        <input type="number" class="form-input" id="pkoAmount" placeholder="1000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞</label>
                        <input type="date" class="form-input" id="pkoDate">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('pkoModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="generatePKO(event)">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ü–ö–û</button>
            </div>
        </div>
    </div>

    <!-- Modal: RKO -->
    <div class="modal-overlay" id="rkoModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìù –†–ö–û (–†–∞—Å—Ö–æ–¥–Ω—ã–π –∫–∞—Å—Å–æ–≤—ã–π –æ—Ä–¥–µ—Ä)</div>
                <button class="modal-close" onclick="closeModal('rkoModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–æ–º–µ—Ä –æ—Ä–¥–µ—Ä–∞</label>
                    <input type="text" class="form-input" id="rkoNumber" placeholder="1">
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–º—É –≤—ã–¥–∞—Ç—å *</label>
                    <input type="text" class="form-input" id="rkoTo" placeholder="–§–ò–û –ø–æ–ª—É—á–∞—Ç–µ–ª—è">
                </div>
                <div class="form-group">
                    <label class="form-label">–û—Å–Ω–æ–≤–∞–Ω–∏–µ *</label>
                    <input type="text" class="form-input" id="rkoReason" placeholder="–í—ã–ø–ª–∞—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞ (‚ÇΩ) *</label>
                        <input type="number" class="form-input" id="rkoAmount" placeholder="5000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞</label>
                        <input type="date" class="form-input" id="rkoDate">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('rkoModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="generateRKO(event)">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –†–ö–û</button>
            </div>
        </div>
    </div>

    <!-- Modal: Payment Order -->
    <div class="modal-overlay" id="paymentOrderModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üí∞ –ü–ª–∞—Ç—ë–∂–Ω–æ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ</div>
                <button class="modal-close" onclick="closeModal('paymentOrderModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–æ–º–µ—Ä –ø–æ—Ä—É—á–µ–Ω–∏—è</label>
                    <input type="text" class="form-input" id="paymentOrderNumber" placeholder="1">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–æ–ª—É—á–∞—Ç–µ–ª—å *</label>
                    <input type="text" class="form-input" id="paymentOrderRecipient" placeholder="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–ë–ò–ö –±–∞–Ω–∫–∞</label>
                        <input type="text" class="form-input" id="paymentOrderBik" placeholder="044525225">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–°—á—ë—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è</label>
                        <input type="text" class="form-input" id="paymentOrderAccount" placeholder="40702810400000000001">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ *</label>
                    <input type="text" class="form-input" id="paymentOrderDescription" placeholder="–û–ø–ª–∞—Ç–∞ —É—Å–ª—É–≥ —Å–≤—è–∑–∏">
                </div>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞ (‚ÇΩ) *</label>
                    <input type="number" class="form-input" id="paymentOrderAmount" placeholder="1000">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('paymentOrderModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handlePaymentOrder(event)">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Invoice -->
    <div class="modal-overlay" id="invoiceModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìÑ –°—á—ë—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É</div>
                <button class="modal-close" onclick="closeModal('invoiceModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–æ–º–µ—Ä —Å—á—ë—Ç–∞</label>
                    <input type="text" class="form-input" id="invoiceNumber" placeholder="1">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–æ–∫—É–ø–∞—Ç–µ–ª—å *</label>
                    <input type="text" class="form-input" id="invoiceBuyer" placeholder="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è">
                </div>
                <div class="form-group">
                    <label class="form-label">–£—Å–ª—É–≥–∏/–¢–æ–≤–∞—Ä—ã</label>
                    <textarea class="form-input" id="invoiceItems" rows="3" placeholder="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥/—Ç–æ–≤–∞—Ä–æ–≤"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞ (‚ÇΩ) *</label>
                    <input type="number" class="form-input" id="invoiceAmount" placeholder="1000">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('invoiceModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleInvoice(event)">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å—á—ë—Ç</button>
            </div>
        </div>
    </div>

    <!-- Modal: Act Sverka -->
    <div class="modal-overlay" id="actSverkaModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìä –ê–∫—Ç —Å–≤–µ—Ä–∫–∏</div>
                <button class="modal-close" onclick="closeModal('actSverkaModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç *</label>
                    <select class="form-input" id="actSverkaCounterparty">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
                        <input type="date" class="form-input" id="actSverkaDateStart">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</label>
                        <input type="date" class="form-input" id="actSverkaDateEnd">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('actSverkaModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleActSverkaFull(event)">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç</button>
            </div>
        </div>
    </div>

    <!-- Modal: Upload Document -->
    <div class="modal-overlay" id="uploadDocumentModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</div>
                <button class="modal-close" onclick="closeModal('uploadDocumentModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                    <input type="text" class="form-input" id="documentName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞">
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø</label>
                    <select class="form-input" id="documentType">
                        <option value="protocol">–ü—Ä–æ—Ç–æ–∫–æ–ª</option>
                        <option value="certificate">–°–ø—Ä–∞–≤–∫–∞</option>
                        <option value="report">–û—Ç—á—ë—Ç</option>
                        <option value="other">–î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-input" id="documentCategory">
                        <option value="general">–û–±—â–µ–µ</option>
                        <option value="members">–ü–∞–π—â–∏–∫–∏</option>
                        <option value="payments">–í–∑–Ω–æ—Å—ã</option>
                        <option value="accounting">–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–§–∞–π–ª</label>
                    <input type="file" class="form-input" id="documentFile">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('uploadDocumentModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleUploadDocument(event)">üíæ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Submit Application -->
    <div class="modal-overlay" id="submitApplicationModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìã –ü–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ</div>
                <button class="modal-close" onclick="closeModal('submitApplicationModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –∑–∞—è–≤–ª–µ–Ω–∏—è *</label>
                    <select class="form-input" id="applicationType">
                        <option value="join">–ù–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</option>
                        <option value="leave">–ù–∞ –≤—ã—Ö–æ–¥ –∏–∑ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</option>
                        <option value="transfer">–ù–∞ –ø–µ—Ä–µ–≤–æ–¥ –ø–∞—è</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–§–ò–û *</label>
                    <input type="text" class="form-input" id="applicationName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="tel" class="form-input" id="applicationPhone" placeholder="+7 (900) 123-45-67">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="applicationEmail" placeholder="email@example.com">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">–†–∞–∑–º–µ—Ä –ø–∞—è (‚ÇΩ)</label>
                    <input type="number" class="form-input" id="applicationShare" value="10000">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('submitApplicationModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleSubmitApplication(event)">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Applications Registry -->
    <div class="modal-overlay" id="applicationsRegistryModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üìã –†–µ–µ—Å—Ç—Ä –∑–∞—è–≤–ª–µ–Ω–∏–π</div>
                <button class="modal-close" onclick="closeModal('applicationsRegistryModal')">√ó</button>
            </div>
            <div class="modal-body" id="applicationsRegistryContent">
                <!-- Content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Create Meeting -->
    <div class="modal-overlay" id="createMeetingModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìù –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–±—Ä–∞–Ω–∏—è</div>
                <button class="modal-close" onclick="closeModal('createMeetingModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–æ–º–µ—Ä –ø—Ä–æ—Ç–æ–∫–æ–ª–∞</label>
                    <input type="text" class="form-input" id="meetingNumber" placeholder="1">
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è *</label>
                    <input type="date" class="form-input" id="meetingDate">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–æ–≤–µ—Å—Ç–∫–∞ –¥–Ω—è</label>
                    <textarea class="form-input" id="meetingAgenda" rows="4" placeholder="–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ (—á–µ–ª.)</label>
                    <input type="number" class="form-input" id="meetingAttendees" placeholder="10">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createMeetingModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleCreateMeeting(event)">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª</button>
            </div>
        </div>
    </div>

    <!-- Modal: Calendar Event -->
    <div class="modal-overlay" id="calendarEventModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìÖ –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</div>
                <button class="modal-close" onclick="closeModal('calendarEventModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                    <input type="text" class="form-input" id="calendarEventTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
                        <input type="date" class="form-input" id="calendarEventDateStart">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</label>
                        <input type="date" class="form-input" id="calendarEventDateEnd">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø</label>
                    <select class="form-input" id="calendarEventType">
                        <option value="meeting">–°–æ–±—Ä–∞–Ω–∏–µ</option>
                        <option value="deadline">–°—Ä–æ–∫ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏</option>
                        <option value="payment">–°—Ä–æ–∫ –ø–ª–∞—Ç–µ–∂–∞</option>
                        <option value="other">–î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea class="form-input" id="calendarEventDescription" rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('calendarEventModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="addCalendarEvent()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Create Fund -->
    <div class="modal-overlay" id="createFundModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üí∞ –°–æ–∑–¥–∞—Ç—å —Ñ–æ–Ω–¥</div>
                <button class="modal-close" onclick="closeModal('createFundModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–æ–Ω–¥–∞ *</label>
                    <input type="text" class="form-input" id="fundName" placeholder="–ü–∞–µ–≤–æ–π —Ñ–æ–Ω–¥">
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø</label>
                    <select class="form-input" id="fundType">
                        <option value="share">–ü–∞–µ–≤–æ–π</option>
                        <option value="development">–§–æ–Ω–¥ —Ä–∞–∑–≤–∏—Ç–∏—è</option>
                        <option value="reserve">–†–µ–∑–µ—Ä–≤–Ω—ã–π</option>
                        <option value="business">–§–æ–Ω–¥ —Ö–æ–∑. –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</option>
                        <option value="indivisible">–ù–µ–¥–µ–ª–∏–º—ã–π</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–ù–∞—á–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ (‚ÇΩ)</label>
                    <input type="number" class="form-input" id="fundAmount" value="0">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createFundModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="handleCreateFund(event)">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Report Viewer -->
    <div class="modal-overlay" id="reportViewerModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title" id="reportViewerTitle">–û—Ç—á—ë—Ç</div>
                <button class="modal-close" onclick="closeModal('reportViewerModal')">√ó</button>
            </div>
            <div class="modal-body" id="reportViewerContent" style="max-height: 70vh; overflow-y: auto;">
                <!-- Report content will be rendered here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('reportViewerModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="exportReportToExcel()">üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
            </div>
        </div>
    </div>

    <!-- Modal: Profile -->
    <div class="modal-overlay" id="profileModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                <button class="modal-close" onclick="closeModal('profileModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–§–ò–û</label>
                    <input type="text" class="form-input" value="–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">–†–æ–ª—å</label>
                    <input type="text" class="form-input" value="–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" placeholder="admin@koop.ru">
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" class="form-input" placeholder="+7 (900) 123-45-67">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('profileModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="saveProfile()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Modal: Backup -->
    <div class="modal-overlay" id="backupModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                <button class="modal-close" onclick="closeModal('backupModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">‚òÅÔ∏è</div>
                    <h3 style="margin-bottom: 12px;">–Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">
                        –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞
                    </p>
                    <div id="yandexDiskStatus" style="margin-bottom: 20px;">
                        <!-- Status will be rendered here -->
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button class="btn btn-primary btn-block" onclick="window.connectYandexDisk()">
                            ‚òÅÔ∏è –ü–æ–¥–∫–ª—é—á–∏—Ç—å –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫
                        </button>
                        <button class="btn btn-secondary btn-block" onclick="window.createBackupYandexDisk()">
                            üíæ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
                        </button>
                        <button class="btn btn-secondary btn-block" onclick="window.exportDataJSON()">
                            üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (JSON)
                        </button>
                        <button class="btn btn-secondary btn-block" onclick="window.importDataJSON()">
                            üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (JSON)
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Zero Reporting -->
    <div class="modal-overlay" id="zeroReportingModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <div class="modal-title">‚àÖ –ù—É–ª–µ–≤–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å</div>
                <button class="modal-close" onclick="closeModal('zeroReportingModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div style="padding: 20px;">
                    <h4 style="margin-bottom: 16px;">–°–æ—Å—Ç–∞–≤ –Ω—É–ª–µ–≤–æ–π –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏:</h4>
                    <ul style="margin-bottom: 24px; padding-left: 20px; line-height: 1.8;">
                        <li>–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù (–Ω–∞–ª–æ–≥–æ–≤–∞—è)</li>
                        <li>–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å (–§–æ—Ä–º–∞ ‚Ññ1)</li>
                        <li>–û—Ç—á—ë—Ç –æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö (–§–æ—Ä–º–∞ ‚Ññ2)</li>
                        <li>–°–ó–í-–°–¢–ê–ñ (–ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–π)</li>
                        <li>–†–°–í (—Ä–∞—Å—á—ë—Ç –ø–æ —Å—Ç—Ä–∞—Ö–æ–≤—ã–º –≤–∑–Ω–æ—Å–∞–º)</li>
                        <li>–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å</li>
                    </ul>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button class="btn btn-primary btn-block" onclick="generateUSNZero()">üìã –î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù</button>
                        <button class="btn btn-primary btn-block" onclick="generateBalanceZero()">‚öñÔ∏è –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å</button>
                        <button class="btn btn-primary btn-block" onclick="generateSZVZero()">üìä –°–ó–í-–°–¢–ê–ñ</button>
                        <button class="btn btn-primary btn-block" onclick="generateRSVZero()">üìä –†–°–í</button>
                        <button class="btn btn-primary btn-block" onclick="generateSrednZero()">üë• –°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Analytics -->
    <div class="modal-overlay" id="analyticsModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div>
                <button class="modal-close" onclick="closeModal('analyticsModal')">√ó</button>
            </div>
            <div class="modal-body" id="analyticsContent">
                <!-- Analytics content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Funds -->
    <div class="modal-overlay" id="fundsModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üí∞ –§–æ–Ω–¥—ã –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</div>
                <button class="modal-close" onclick="closeModal('fundsModal')">√ó</button>
            </div>
            <div class="modal-body" id="fundsContent">
                <!-- Funds content will be rendered here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('fundsModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="showCreateFundModal()">‚ûï –°–æ–∑–¥–∞—Ç—å —Ñ–æ–Ω–¥</button>
            </div>
        </div>
    </div>

    <!-- Modal: Meetings -->
    <div class="modal-overlay" id="meetingsModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üìù –°–æ–±—Ä–∞–Ω–∏—è –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã</div>
                <button class="modal-close" onclick="closeModal('meetingsModal')">√ó</button>
            </div>
            <div class="modal-body" id="meetingsContent">
                <!-- Meetings content will be rendered here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('meetingsModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="showCreateMeetingModal()">‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª</button>
            </div>
        </div>
    </div>

    <!-- Modal: Control Dashboard -->
    <div class="modal-overlay" id="controlDashboardModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <div class="modal-title">‚è∞ –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤</div>
                <button class="modal-close" onclick="closeModal('controlDashboardModal')">√ó</button>
            </div>
            <div class="modal-body" id="controlDashboardContent">
                <!-- Control dashboard content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Certificates Registry -->
    <div class="modal-overlay" id="certificatesRegistryModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üìú –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –ø–∞–π—â–∏–∫–æ–≤</div>
                <button class="modal-close" onclick="closeModal('certificatesRegistryModal')">√ó</button>
            </div>
            <div class="modal-body" id="certificatesRegistryContent">
                <!-- Certificates content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Members Report -->
    <div class="modal-overlay" id="membersReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üìã –†–µ–µ—Å—Ç—Ä –ø–∞–π—â–∏–∫–æ–≤</div>
                <button class="modal-close" onclick="closeModal('membersReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="membersReportContent">
                <!-- Members report content will be rendered here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('membersReportModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="exportMembersToExcel()">üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
            </div>
        </div>
    </div>

    <!-- Modal: Payments Report -->
    <div class="modal-overlay" id="paymentsReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üí≥ –û—Ç—á—ë—Ç –ø–æ –≤–∑–Ω–æ—Å–∞–º</div>
                <button class="modal-close" onclick="closeModal('paymentsReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="paymentsReportContent">
                <!-- Payments report content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Debt Report -->
    <div class="modal-overlay" id="debtReportModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">‚ö†Ô∏è –û—Ç—á—ë—Ç –æ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö</div>
                <button class="modal-close" onclick="closeModal('debtReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="debtReportContent">
                <!-- Debt report content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Financial Report -->
    <div class="modal-overlay" id="financialReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üìà –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç</div>
                <button class="modal-close" onclick="closeModal('financialReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="financialReportContent">
                <!-- Financial report content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Calendar Report -->
    <div class="modal-overlay" id="calendarReportModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</div>
                <button class="modal-close" onclick="closeModal('calendarReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="calendarReportContent">
                <!-- Calendar content will be rendered here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('calendarReportModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="showCalendarEventModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</button>
            </div>
        </div>
    </div>

    <!-- Modal: Meeting Protocol -->
    <div class="modal-overlay" id="meetingProtocolModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üìù –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–±—Ä–∞–Ω–∏—è</div>
                <button class="modal-close" onclick="closeModal('meetingProtocolModal')">√ó</button>
            </div>
            <div class="modal-body" id="meetingProtocolContent">
                <!-- Protocol content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Attendance List -->
    <div class="modal-overlay" id="attendanceListModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">‚úçÔ∏è –õ–∏—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                <button class="modal-close" onclick="closeModal('attendanceListModal')">√ó</button>
            </div>
            <div class="modal-body" id="attendanceListContent">
                <!-- Attendance list content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: OSV Report -->
    <div class="modal-overlay" id="osvReportModal">
        <div class="modal" style="max-width: 1000px;">
            <div class="modal-header">
                <div class="modal-title">üìà –û–±–æ—Ä–æ—Ç–Ω–æ-—Å–∞–ª—å–¥–æ–≤–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å</div>
                <button class="modal-close" onclick="closeModal('osvReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="osvReportContent" style="max-height: 70vh; overflow-y: auto;">
                <!-- OSV content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Balance Report -->
    <div class="modal-overlay" id="balanceReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">‚öñÔ∏è –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –±–∞–ª–∞–Ω—Å (–§–æ—Ä–º–∞ ‚Ññ1)</div>
                <button class="modal-close" onclick="closeModal('balanceReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="balanceReportContent">
                <!-- Balance content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Profit Loss Report -->
    <div class="modal-overlay" id="profitLossReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üìà –û—Ç—á—ë—Ç –æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö (–§–æ—Ä–º–∞ ‚Ññ2)</div>
                <button class="modal-close" onclick="closeModal('profitLossReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="profitLossReportContent">
                <!-- Profit/Loss content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: KUDiR Report -->
    <div class="modal-overlay" id="kudirReportModal">
        <div class="modal" style="max-width: 1000px;">
            <div class="modal-header">
                <div class="modal-title">üìñ –ö–£–î–∏–† –£–°–ù</div>
                <button class="modal-close" onclick="closeModal('kudirReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="kudirReportContent" style="max-height: 70vh; overflow-y: auto;">
                <!-- KUDiR content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Target Use Report -->
    <div class="modal-overlay" id="targetUseReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üéØ –û—Ç—á—ë—Ç –æ —Ü–µ–ª–µ–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤</div>
                <button class="modal-close" onclick="closeModal('targetUseReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="targetUseReportContent">
                <!-- Target use content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Accounting Certificate -->
    <div class="modal-overlay" id="accountingCertificateModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìÑ –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞</div>
                <button class="modal-close" onclick="closeModal('accountingCertificateModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–∫–∏ *</label>
                    <input type="text" class="form-input" id="certificateName" placeholder="–°–ø—Ä–∞–≤–∫–∞ –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Ä–∞—Å—á—ë—Ç–æ–≤">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–µ—Ä–∏–æ–¥</label>
                    <input type="text" class="form-input" id="certificatePeriod" placeholder="2024 –≥–æ–¥">
                </div>
                <div class="form-group">
                    <label class="form-label">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</label>
                    <textarea class="form-input" id="certificateContent" rows="5"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('accountingCertificateModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="generateAccountingCertificate()">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É</button>
            </div>
        </div>
    </div>

    <!-- Modal: USN Declaration -->
    <div class="modal-overlay" id="usnDeclarationModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <div class="modal-title">üìã –î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù</div>
                <button class="modal-close" onclick="closeModal('usnDeclarationModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–ì–æ–¥</label>
                        <input type="number" class="form-input" id="usnYear" value="2024">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–°—Ç–∞–≤–∫–∞ (%)</label>
                        <input type="number" class="form-input" id="usnRate" value="6">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–î–æ—Ö–æ–¥—ã (‚ÇΩ)</label>
                        <input type="number" class="form-input" id="usnIncome" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–†–∞—Å—Ö–æ–¥—ã (‚ÇΩ)</label>
                        <input type="number" class="form-input" id="usnExpense" placeholder="0">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('usnDeclarationModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="generateUSNDeclaration()">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—é</button>
            </div>
        </div>
    </div>

    <!-- Modal: RSV Report -->
    <div class="modal-overlay" id="rsvReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üìä –†–°–í (–†–∞—Å—á—ë—Ç –ø–æ —Å—Ç—Ä–∞—Ö–æ–≤—ã–º –≤–∑–Ω–æ—Å–∞–º)</div>
                <button class="modal-close" onclick="closeModal('rsvReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="rsvReportContent">
                <!-- RSV content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: SZV-STAZH Report -->
    <div class="modal-overlay" id="szvStazhReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üìä –°–ó–í-–°–¢–ê–ñ</div>
                <button class="modal-close" onclick="closeModal('szvStazhReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="szvStazhReportContent">
                <!-- SZV-STAZH content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: 6-NDFL Report -->
    <div class="modal-overlay" id="6ndflReportModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üìä 6-–ù–î–§–õ</div>
                <button class="modal-close" onclick="closeModal('6ndflReportModal')">√ó</button>
            </div>
            <div class="modal-body" id="6ndflReportContent">
                <!-- 6-NDFL content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- ============================================
         EXTERNAL SCRIPTS
    ============================================ -->
    
    <!-- XLSX (—Å fallback –Ω–∞ cdnjs) -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script>
        if (typeof XLSX === 'undefined') {
            const fallback = document.createElement('script');
            fallback.src = 'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';
            document.head.appendChild(fallback);
        }
    </script>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="yandex-disk-integration-v2.js?v=5.0.1"></script>
    <script src="pdf_export.js?v=5.0.1"></script>

    <!-- ============================================
         MAIN APPLICATION SCRIPT
    ============================================ -->
    <script>
        // ============================================
        // –î–ê–ù–ù–´–ï - –∏—Å–ø–æ–ª—å–∑—É–µ–º window –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
        // ============================================
        
        window.members = window.members || JSON.parse(localStorage.getItem('members') || '[]');
        window.payments = window.payments || JSON.parse(localStorage.getItem('payments') || '[]');
        window.transactions = window.transactions || JSON.parse(localStorage.getItem('transactions') || '[]');
        window.documents = window.documents || JSON.parse(localStorage.getItem('documents') || '[]');
        window.applications = window.applications || JSON.parse(localStorage.getItem('applications') || '[]');
        window.meetings = window.meetings || JSON.parse(localStorage.getItem('meetings') || '[]');
        window.funds = window.funds || JSON.parse(localStorage.getItem('funds') || '[]');
        window.calendarEvents = window.calendarEvents || JSON.parse(localStorage.getItem('calendarEvents') || '[]');
        window.certificates = window.certificates || JSON.parse(localStorage.getItem('certificates') || '[]');

        // Demo –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –ø—É—Å—Ç–æ
        if (window.members.length === 0) {
            window.members = [
                { id: 1, name: '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', phone: '+7 (900) 111-11-11', email: 'ivanov@mail.ru', entranceFee: 1000, shareFee: 10000, balance: 10000, status: 'active', birthDate: '1980-05-15', address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1' },
                { id: 2, name: '–ü–µ—Ç—Ä–æ–≤ –ü—ë—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á', phone: '+7 (900) 222-22-22', email: 'petrov@mail.ru', entranceFee: 1000, shareFee: 10000, balance: 5000, status: 'active', birthDate: '1985-08-20', address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ú–∏—Ä–∞, –¥. 2' },
                { id: 3, name: '–°–∏–¥–æ—Ä–æ–≤ –°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤–∏—á', phone: '+7 (900) 333-33-33', email: 'sidorov@mail.ru', entranceFee: 1000, shareFee: 10000, balance: -5000, status: 'debt', birthDate: '1975-03-10', address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ì–∞–≥–∞—Ä–∏–Ω–∞, –¥. 3' },
                { id: 4, name: '–ö—É–∑–Ω–µ—Ü–æ–≤ –ö—É–∑—å–º–∞ –ö—É–∑–Ω–µ—Ü–æ–≤–∏—á', phone: '+7 (900) 444-44-44', email: 'kuznetsov@mail.ru', entranceFee: 1000, shareFee: 10000, balance: 15000, status: 'active', birthDate: '1990-12-05', address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 4' },
                { id: 5, name: '–°–º–∏—Ä–Ω–æ–≤–∞ –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–Ω–∞', phone: '+7 (900) 555-55-55', email: 'smirnova@mail.ru', entranceFee: 1000, shareFee: 10000, balance: 0, status: 'pending', birthDate: '1988-07-25', address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ß–µ—Ö–æ–≤–∞, –¥. 5' },
            ];
            localStorage.setItem('members', JSON.stringify(window.members));
        }

        // ============================================
        // TELEGRAM WEBAPP INIT
        // ============================================
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // Apply Telegram theme
        window.applyTelegramTheme = function() {
            document.documentElement.style.setProperty('--primary-color', tg.themeParams.button_color || '#2196F3');
            document.documentElement.style.setProperty('--bg-color', tg.themeParams.secondary_bg_color || '#f5f5f5');
            document.documentElement.style.setProperty('--card-bg', tg.themeParams.bg_color || '#ffffff');
            document.documentElement.style.setProperty('--text-primary', tg.themeParams.text_color || '#212121');
            document.documentElement.style.setProperty('--text-secondary', tg.themeParams.hint_color || '#757575');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞ —Ö–µ–¥–µ—Ä–∞
            tg.setHeaderColor(tg.themeParams.bg_color || '#ffffff');
            tg.setBottomBarColor(tg.themeParams.secondary_bg_color || '#f5f5f5');
        }

        window.applyTelegramTheme();

        tg.onEvent('themeChanged', () => {
            window.applyTelegramTheme();
        });

        // ============================================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            window.renderMembers();
            window.updateStats();
            window.populatePaymentMembers();
            window.populateReturnPaymentMembers();
            window.populateCounterparties();
            window.initMenuHandlers();
            window.initSubmenus();
            window.initSearch();

            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º—ã
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('paymentDate').value = today;
            document.getElementById('transactionDate').value = today;
            document.getElementById('pkoDate').value = today;
            document.getElementById('rkoDate').value = today;
        });

        // ============================================
        // –ù–ê–í–ò–ì–ê–¶–ò–Ø
        // ============================================
        window.switchTab = function(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });

            document.querySelectorAll('.content-tab').forEach(btn => {
                btn.classList.remove('active');
            });

            document.getElementById(`tab-${tabName}`).style.display = 'block';

            const activeBtn = document.querySelector(`.content-tab[onclick="switchTab('${tabName}')"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }

            // Update menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === tabName) {
                    item.classList.add('active');
                }
            });
        }

        // ============================================
        // –ú–ï–ù–Æ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò
        // ============================================
        window.initMenuHandlers = function() {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ –º–µ–Ω—é
            document.querySelectorAll('.menu-item[data-action]').forEach(item => {
                item.addEventListener('click', function() {
                    const action = this.dataset.action;
                    handleMenuAction(action);
                });
            });

            document.querySelectorAll('.menu-item[data-report]').forEach(item => {
                item.addEventListener('click', function() {
                    const report = this.dataset.report;
                    openReportByName(report);
                });
            });

            document.querySelectorAll('.menu-item[data-panel]').forEach(item => {
                item.addEventListener('click', function() {
                    const panel = this.dataset.panel;
                    openPanel(panel);
                });
            });

            // Submenu items
            document.querySelectorAll('.submenu-item[data-action]').forEach(item => {
                item.addEventListener('click', function() {
                    const action = this.dataset.action;
                    handleMenuAction(action);
                });
            });

            document.querySelectorAll('.submenu-item[data-report]').forEach(item => {
                item.addEventListener('click', function() {
                    const report = this.dataset.report;
                    openReportByName(report);
                });
            });
        }

        window.initSubmenus = function() {
            document.querySelectorAll('.menu-item[data-submenu]').forEach(item => {
                item.addEventListener('click', function() {
                    const submenuId = this.dataset.submenu;
                    const submenu = document.getElementById(`submenu-${submenuId}`);
                    const arrow = this.querySelector('.menu-arrow');
                    
                    if (submenu) {
                        submenu.classList.toggle('open');
                        if (arrow) {
                            arrow.textContent = submenu.classList.contains('open') ? '‚ñº' : '‚Üí';
                        }
                    }
                });
            });
        }

        window.initSearch = function() {
            document.getElementById('menuSearch').addEventListener('input', function(e) {
                const query = e.target.value.toLowerCase();
                document.querySelectorAll('.menu-item').forEach(item => {
                    const name = item.querySelector('.menu-item-name')?.textContent.toLowerCase() || '';
                    const subtitle = item.querySelector('.menu-item-subtitle')?.textContent.toLowerCase() || '';
                    if (name.includes(query) || subtitle.includes(query)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        window.handleMenuAction = function(action) {
            switch(action) {
                case 'create-member':
                    showCreateMemberModal();
                    break;
                case 'edit-member':
                    showEditMemberModal();
                    break;
                case 'create-payment':
                    showCreatePaymentModal();
                    break;
                case 'create-return-payment':
                    showReturnPaymentModal();
                    break;
                case 'create-transaction':
                    showCreateTransactionModal();
                    break;
                case 'pko':
                    showPKOModal();
                    break;
                case 'rko':
                    showRKOModal();
                    break;
                case 'payment-order':
                    showPaymentOrderModal();
                    break;
                case 'invoice':
                    showInvoiceModal();
                    break;
                case 'act-sverka':
                    showActSverkaModal();
                    break;
                case 'create-document':
                    showUploadDocumentModal();
                    break;
                case 'create-application':
                    showSubmitApplicationModal();
                    break;
                case 'create-meeting':
                    showCreateMeetingModal();
                    break;
                case 'add-calendar-event':
                    showCalendarEventModal();
                    break;
                case 'generate-usn-zero':
                case 'generate-balance-zero':
                case 'generate-szv-zero':
                case 'generate-rsv-zero':
                case 'generate-sredn-zero':
                    showZeroReportingModal();
                    break;
                default:
                    showToast({ type: 'info', message: `–î–µ–π—Å—Ç–≤–∏–µ "${action}" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ` });
            }
        }

        window.openReportByName = function(reportName) {
            console.log('üìä –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Ç—á—ë—Ç–∞:', reportName);
            
            switch(reportName) {
                case 'members-registry-full':
                case 'members-report-full':
                    showMembersReport();
                    break;
                case 'payments-report-full':
                    showPaymentsReport();
                    break;
                case 'osv':
                    showOSVReport();
                    break;
                case 'balance':
                    showBalanceReport();
                    break;
                case 'profit-loss':
                    showProfitLossReport();
                    break;
                case 'kudir':
                    showKUDiRReport();
                    break;
                case 'target-use':
                    showTargetUseReport();
                    break;
                case 'accounting-certificate':
                    showAccountingCertificateModal();
                    break;
                case 'certificates-registry-full':
                    showCertificatesRegistry();
                    break;
                case 'applications-registry':
                    showApplicationsRegistry();
                    break;
                case 'meeting-protocol-full':
                    showMeetingProtocol();
                    break;
                case 'attendance-list-full':
                    showAttendanceList();
                    break;
                case 'calendar-full':
                    showCalendarReport();
                    break;
                case 'control-dashboard':
                    showControlDashboard();
                    break;
                case 'financial-report-full':
                    showFinancialReport();
                    break;
                case 'debt-report':
                    showDebtReport();
                    break;
                case 'share-fund':
                case 'development-fund':
                case 'business-fund':
                case 'funds-analytics':
                case 'indivisible-fund':
                case 'reserve-fund':
                    showFundsModal();
                    break;
                case 'rsv':
                    showRSVReport();
                    break;
                case 'szv-stazh':
                    showSZVSTAZHReport();
                    break;
                case '6-ndfl':
                    show6NDFLReport();
                    break;
                default:
                    showToast({ type: 'info', message: `–û—Ç—á—ë—Ç "${reportName}" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ` });
            }
        }

        window.openPanel = function(panelName) {
            switch(panelName) {
                case 'profile':
                    showProfileModal();
                    break;
                case 'backup':
                    showBackupModal();
                    break;
                default:
                    showToast({ type: 'info', message: `–ü–∞–Ω–µ–ª—å "${panelName}" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ` });
            }
        }

        // ============================================
        // –†–ï–ù–î–ï–†–ò–ù–ì
        // ============================================
        window.renderMembers = function() {
            const membersList = document.getElementById('membersList');
            const recentMembersList = document.getElementById('recentMembersList');

            if (members.length === 0) {
                const emptyHtml = `
                    <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üë•</div>
                        <div style="font-size: 16px; font-weight: 500; margin-bottom: 8px;">–ù–µ—Ç –ø–∞–π—â–∏–∫–æ–≤</div>
                        <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞–π—â–∏–∫–∞, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å"</p>
                    </div>
                `;
                membersList.innerHTML = emptyHtml;
                recentMembersList.innerHTML = emptyHtml;
                return;
            }

            const html = members.map(member => createMemberItem(member)).join('');
            membersList.innerHTML = html;

            // Recent members (last 5)
            const recent = members.slice(-5).reverse();
            recentMembersList.innerHTML = recent.map(member => createMemberItem(member)).join('');
        }

        window.createMemberItem = function(member) {
            const initials = member.name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
            const color = getColorForMember(member.id);
            const statusClass = member.status === 'active' ? 'active' : member.status === 'debt' ? 'debt' : 'pending';
            const statusText = member.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : member.status === 'debt' ? '–î–æ–ª–∂–Ω–∏–∫' : '–û–∂–∏–¥–∞–Ω–∏–µ';
            const balanceClass = member.balance >= 0 ? 'positive' : 'negative';
            const balanceText = member.balance >= 0 ? `+${formatMoney(member.balance)}` : formatMoney(member.balance);

            return `
                <div class="member-item" onclick="openMemberDetail(${member.id})">
                    <div class="member-avatar" style="background: ${color}">${initials}</div>
                    <div class="member-info">
                        <div class="member-name">${member.name}</div>
                        <div class="member-details">
                            <span>üìû ${member.phone || '‚Äî'}</span>
                            <span>‚úâÔ∏è ${member.email || '‚Äî'}</span>
                        </div>
                    </div>
                    <span class="member-status ${statusClass}">${statusText}</span>
                    <span class="member-balance ${balanceClass}">${balanceText}</span>
                </div>
            `;
        }

        window.getColorForMember = function(id) {
            const colors = ['#2196F3', '#4CAF50', '#FF9800', '#9C27B0', '#F44336', '#00BCD4'];
            return colors[id % colors.length];
        }

        window.updateStats = function() {
            const total = members.length;
            const active = members.filter(m => m.status === 'active').length;
            const debt = members.filter(m => m.status === 'debt').length;
            const totalDebt = members.filter(m => m.balance < 0).reduce((sum, m) => sum + Math.abs(m.balance), 0);

            document.getElementById('totalMembers').textContent = total;
            document.getElementById('activeMembers').textContent = active;
            document.getElementById('debtMembers').textContent = debt;
            document.getElementById('totalDebt').textContent = formatMoney(totalDebt);
            document.getElementById('membersCountBadge').textContent = total;
        }

        window.populatePaymentMembers = function() {
            const select = document.getElementById('paymentMember');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞</option>' +
                members.map(m => `<option value="${m.id}">${m.name}</option>`).join('');
        }

        window.populateReturnPaymentMembers = function() {
            const select = document.getElementById('returnPaymentMember');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞</option>' +
                members.filter(m => m.balance > 0).map(m => `<option value="${m.id}">${m.name} (–ë–∞–ª–∞–Ω—Å: ${formatMoney(m.balance)})</option>`).join('');
        }

        window.populateCounterparties = function() {
            const select = document.getElementById('actSverkaCounterparty');
            // Add members and some default counterparties
            const counterparties = [
                ...members.map(m => ({ id: m.id, name: m.name, type: 'member' })),
                { id: 'tax', name: '–§–ù–° –†–æ—Å—Å–∏–∏', type: 'gov' },
                { id: 'pfr', name: '–ü–§–†', type: 'gov' },
                { id: 'ffoms', name: '–§–§–û–ú–°', type: 'gov' }
            ];
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞</option>' +
                counterparties.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
        }

        // ============================================
        // –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê - SHOW –§–£–ù–ö–¶–ò–ò
        // ============================================
        window.showCreateMemberModal = function() {
            document.getElementById('createMemberModal').classList.add('active');
        }

        window.showEditMemberModal = function() {
            if (members.length === 0) {
                showToast({ type: 'warning', message: '–ù–µ—Ç –ø–∞–π—â–∏–∫–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è' });
                return;
            }
            // Show first member for demo
            openEditMemberModal(members[0].id);
        }

        window.openEditMemberModal = function(memberId) {
            const member = members.find(m => m.id === memberId);
            if (!member) return;

            document.getElementById('editMemberId').value = member.id;
            document.getElementById('editMemberName').value = member.name;
            document.getElementById('editMemberPhone').value = member.phone || '';
            document.getElementById('editMemberEmail').value = member.email || '';
            document.getElementById('editMemberBalance').value = member.balance || 0;
            
            document.getElementById('editMemberModal').classList.add('active');
        }

        window.showCreatePaymentModal = function() {
            document.getElementById('createPaymentModal').classList.add('active');
        }

        window.showReturnPaymentModal = function() {
            document.getElementById('returnPaymentModal').classList.add('active');
        }

        window.showCreateTransactionModal = function() {
            document.getElementById('createTransactionModal').classList.add('active');
        }

        window.showPKOModal = function() {
            document.getElementById('pkoModal').classList.add('active');
        }

        window.showRKOModal = function() {
            document.getElementById('rkoModal').classList.add('active');
        }

        window.showPaymentOrderModal = function() {
            document.getElementById('paymentOrderModal').classList.add('active');
        }

        window.showInvoiceModal = function() {
            document.getElementById('invoiceModal').classList.add('active');
        }

        window.showActSverkaModal = function() {
            document.getElementById('actSverkaModal').classList.add('active');
        }

        window.showUploadDocumentModal = function() {
            document.getElementById('uploadDocumentModal').classList.add('active');
        }

        window.showSubmitApplicationModal = function() {
            document.getElementById('submitApplicationModal').classList.add('active');
        }

        window.showApplicationsRegistry = function() {
            const content = document.getElementById('applicationsRegistryContent');
            if (applications.length === 0) {
                content.innerHTML = `
                    <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üìã</div>
                        <div style="font-size: 16px; font-weight: 500;">–ù–µ—Ç –∑–∞—è–≤–ª–µ–Ω–∏–π</div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>‚Ññ</th>
                                <th>–¢–∏–ø</th>
                                <th>–§–ò–û</th>
                                <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                <th>–°—É–º–º–∞ –ø–∞—è</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${applications.map((app, i) => `
                                <tr>
                                    <td>${i + 1}</td>
                                    <td>${app.type === 'join' ? '–ù–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ' : app.type === 'leave' ? '–ù–∞ –≤—ã—Ö–æ–¥' : '–ù–∞ –ø–µ—Ä–µ–≤–æ–¥'}</td>
                                    <td>${app.name}</td>
                                    <td>${app.phone || '‚Äî'}</td>
                                    <td>${formatMoney(app.share)}</td>
                                    <td>${app.status === 'approved' ? '‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ' : app.status === 'rejected' ? '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ' : '‚è≥ –ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏'}</td>
                                    <td>
                                        ${app.status === 'pending' ? `
                                            <button onclick="approveApplication(${app.id})" style="padding:4px 8px;background:#4CAF50;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-right:4px">‚úÖ</button>
                                            <button onclick="rejectApplication(${app.id})" style="padding:4px 8px;background:#F44336;color:#fff;border:none;border-radius:4px;cursor:pointer">‚ùå</button>
                                        ` : '‚Äî'}
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
            document.getElementById('applicationsRegistryModal').classList.add('active');
        }

        window.showCreateMeetingModal = function() {
            document.getElementById('createMeetingModal').classList.add('active');
        }

        window.showCalendarEventModal = function() {
            document.getElementById('calendarEventModal').classList.add('active');
        }

        window.showCreateFundModal = function() {
            document.getElementById('createFundModal').classList.add('active');
        }

        window.showProfileModal = function() {
            document.getElementById('profileModal').classList.add('active');
        }

        window.showBackupModal = function() {
            document.getElementById('backupModal').classList.add('active');
            window.updateYandexDiskStatus();
        }

        window.showZeroReportingModal = function() {
            document.getElementById('zeroReportingModal').classList.add('active');
        }

        window.showAnalyticsModal = function() {
            document.getElementById('analyticsModal').classList.add('active');
        }

        window.showFundsModal = function() {
            const content = document.getElementById('fundsContent');
            if (funds.length === 0) {
                content.innerHTML = `
                    <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üí∞</div>
                        <div style="font-size: 16px; font-weight: 500;">–§–æ–Ω–¥—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã</div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <div class="stats-grid">
                        ${funds.map(fund => `
                            <div class="stat-card">
                                <div class="stat-value">${formatMoney(fund.amount)}</div>
                                <div class="stat-label">${fund.name}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            document.getElementById('fundsModal').classList.add('active');
        }

        window.showMeetingsModal = function() {
            document.getElementById('meetingsModal').classList.add('active');
        }

        window.showControlDashboard = function() {
            document.getElementById('controlDashboardModal').classList.add('active');
        }

        window.showCertificatesRegistry = function() {
            document.getElementById('certificatesRegistryModal').classList.add('active');
        }

        window.showMembersReport = function() {
            const content = document.getElementById('membersReportContent');
            content.innerHTML = `
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>‚Ññ</th>
                            <th>–§–ò–û</th>
                            <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                            <th>Email</th>
                            <th>–í–∑–Ω–æ—Å (‚ÇΩ)</th>
                            <th>–ë–∞–ª–∞–Ω—Å (‚ÇΩ)</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${members.map((m, i) => `
                            <tr>
                                <td>${i + 1}</td>
                                <td>${m.name}</td>
                                <td>${m.phone || '‚Äî'}</td>
                                <td>${m.email || '‚Äî'}</td>
                                <td>${formatMoney(m.entranceFee)}</td>
                                <td style="color: ${m.balance >= 0 ? 'var(--success-color)' : 'var(--danger-color)'}">${formatMoney(m.balance)}</td>
                                <td>${m.status === 'active' ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : m.status === 'debt' ? '‚ö†Ô∏è –î–æ–ª–∂–Ω–∏–∫' : '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ'}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('membersReportModal').classList.add('active');
        }

        window.showPaymentsReport = function() {
            const content = document.getElementById('paymentsReportContent');
            if (payments.length === 0) {
                content.innerHTML = `
                    <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üí≥</div>
                        <div style="font-size: 16px; font-weight: 500;">–í–∑–Ω–æ—Å–æ–≤ –Ω–µ—Ç</div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ü–∞–π—â–∏–∫</th>
                                <th>–¢–∏–ø</th>
                                <th>–°—É–º–º–∞ (‚ÇΩ)</th>
                                <th>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${payments.map(p => `
                                <tr>
                                    <td>${new Date(p.date).toLocaleDateString('ru-RU')}</td>
                                    <td>${p.memberName}</td>
                                    <td>${p.type === 'entrance' ? '–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π' : p.type === 'share' ? '–ü–∞–µ–≤–æ–π' : p.type === 'member' ? '–ß–ª–µ–Ω—Å–∫–∏–π' : '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π'}</td>
                                    <td>${formatMoney(p.amount)}</td>
                                    <td>${p.description || '‚Äî'}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
            document.getElementById('paymentsReportModal').classList.add('active');
        }

        window.showDebtReport = function() {
            const content = document.getElementById('debtReportContent');
            const debtMembers = members.filter(m => m.balance < 0);
            if (debtMembers.length === 0) {
                content.innerHTML = `
                    <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">‚úÖ</div>
                        <div style="font-size: 16px; font-weight: 500;">–ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–µ–π –Ω–µ—Ç</div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>–§–ò–û</th>
                                <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                <th>–ë–∞–ª–∞–Ω—Å (‚ÇΩ)</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${debtMembers.map(m => `
                                <tr>
                                    <td>${m.name}</td>
                                    <td>${m.phone || '‚Äî'}</td>
                                    <td style="color: var(--danger-color)">${formatMoney(m.balance)}</td>
                                    <td>‚ö†Ô∏è –î–æ–ª–∂–Ω–∏–∫</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
            document.getElementById('debtReportModal').classList.add('active');
        }

        window.showFinancialReport = function() {
            const totalIncome = payments.reduce((sum, p) => sum + p.amount, 0);
            const totalExpense = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            
            const content = document.getElementById('financialReportContent');
            content.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card secondary">
                        <div class="stat-value">${formatMoney(totalIncome)}</div>
                        <div class="stat-label">–î–æ—Ö–æ–¥—ã</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value">${formatMoney(totalExpense)}</div>
                        <div class="stat-label">–†–∞—Å—Ö–æ–¥—ã</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${formatMoney(totalIncome - totalExpense)}</div>
                        <div class="stat-label">–ü—Ä–∏–±—ã–ª—å</div>
                    </div>
                </div>
            `;
            document.getElementById('financialReportModal').classList.add('active');
        }

        window.showCalendarReport = function() {
            const content = document.getElementById('calendarReportContent');
            if (calendarEvents.length === 0) {
                content.innerHTML = `
                    <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üìÖ</div>
                        <div style="font-size: 16px; font-weight: 500;">–°–æ–±—ã—Ç–∏–π –Ω–µ—Ç</div>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–¢–∏–ø</th>
                                <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${calendarEvents.map(e => `
                                <tr>
                                    <td>${new Date(e.dateStart).toLocaleDateString('ru-RU')}</td>
                                    <td>${e.title}</td>
                                    <td>${e.type === 'meeting' ? '–°–æ–±—Ä–∞–Ω–∏–µ' : e.type === 'deadline' ? '–°—Ä–æ–∫' : e.type === 'payment' ? '–ü–ª–∞—Ç—ë–∂' : '–î—Ä—É–≥–æ–µ'}</td>
                                    <td>${e.description || '‚Äî'}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
            document.getElementById('calendarReportModal').classList.add('active');
        }

        window.showMeetingProtocol = function() {
            document.getElementById('meetingProtocolModal').classList.add('active');
        }

        window.showAttendanceList = function() {
            document.getElementById('attendanceListModal').classList.add('active');
        }

        window.showAccountingCertificateModal = function() {
            document.getElementById('accountingCertificateModal').classList.add('active');
        }

        // ============================================
        // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –§–û–†–ú
        // ============================================
        window.handleCreateMember = function(event) {
            event.preventDefault();
            
            const name = document.getElementById('newMemberName').value.trim();
            const phone = document.getElementById('newMemberPhone').value.trim();
            const email = document.getElementById('newMemberEmail').value.trim();
            const entranceFee = parseFloat(document.getElementById('newMemberFee').value) || 0;
            const shareFee = parseFloat(document.getElementById('newMemberShare').value) || 0;
            const birthDate = document.getElementById('newMemberBirthDate').value;
            const address = document.getElementById('newMemberAddress').value.trim();

            if (!name) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ –§–ò–û –ø–∞–π—â–∏–∫–∞' });
                return;
            }

            const newMember = {
                id: Date.now(),
                name,
                phone,
                email,
                entranceFee,
                shareFee,
                balance: entranceFee + shareFee,
                status: 'active',
                birthDate,
                address
            };

            members.push(newMember);
            localStorage.setItem('members', JSON.stringify(members));

            closeModal('createMemberModal');
            renderMembers();
            updateStats();
            populatePaymentMembers();
            populateReturnPaymentMembers();

            showToast({ type: 'success', message: `–ü–∞–π—â–∏–∫ "${name}" –¥–æ–±–∞–≤–ª–µ–Ω!` });

            // Clear form
            document.getElementById('newMemberName').value = '';
            document.getElementById('newMemberPhone').value = '';
            document.getElementById('newMemberEmail').value = '';
            document.getElementById('newMemberFee').value = '1000';
            document.getElementById('newMemberShare').value = '10000';
            document.getElementById('newMemberBirthDate').value = '';
            document.getElementById('newMemberAddress').value = '';
        }

        window.handleEditMemberSave = function() {
            const memberId = parseInt(document.getElementById('editMemberId').value);
            const name = document.getElementById('editMemberName').value.trim();
            const phone = document.getElementById('editMemberPhone').value.trim();
            const email = document.getElementById('editMemberEmail').value.trim();

            if (!name) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ –§–ò–û –ø–∞–π—â–∏–∫–∞' });
                return;
            }

            const member = members.find(m => m.id === memberId);
            if (member) {
                member.name = name;
                member.phone = phone;
                member.email = email;
                localStorage.setItem('members', JSON.stringify(members));
            }

            closeModal('editMemberModal');
            renderMembers();
            showToast({ type: 'success', message: `–î–∞–Ω–Ω—ã–µ –ø–∞–π—â–∏–∫–∞ "${name}" –æ–±–Ω–æ–≤–ª–µ–Ω—ã!` });
        }

        window.handleCreatePayment = function(event) {
            event.preventDefault();
            
            const memberId = document.getElementById('paymentMember').value;
            const amount = parseFloat(document.getElementById('paymentAmount').value) || 0;
            const type = document.getElementById('paymentType').value;
            const date = document.getElementById('paymentDate').value;
            const description = document.getElementById('paymentDescription').value.trim();

            if (!memberId) {
                showToast({ type: 'error', message: '–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞' });
                return;
            }

            if (!amount) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É' });
                return;
            }

            const member = members.find(m => m.id == memberId);
            if (member) {
                member.balance += amount;
                if (member.balance >= 0) member.status = 'active';
                localStorage.setItem('members', JSON.stringify(members));
            }

            // Save payment
            payments.push({
                id: Date.now(),
                memberId: parseInt(memberId),
                memberName: member?.name || '',
                amount,
                type,
                date,
                description
            });
            localStorage.setItem('payments', JSON.stringify(payments));

            closeModal('createPaymentModal');
            renderMembers();
            updateStats();
            populatePaymentMembers();

            showToast({ type: 'success', message: `–í–∑–Ω–æ—Å ${formatMoney(amount)} –≤–Ω–µ—Å—ë–Ω!` });

            // Clear form
            document.getElementById('paymentMember').value = '';
            document.getElementById('paymentAmount').value = '';
            document.getElementById('paymentDescription').value = '';
        }

        window.handleReturnPayment = function(event) {
            event.preventDefault();
            
            const memberId = document.getElementById('returnPaymentMember').value;
            const amount = parseFloat(document.getElementById('returnPaymentAmount').value) || 0;
            const reason = document.getElementById('returnPaymentReason').value.trim();

            if (!memberId) {
                showToast({ type: 'error', message: '–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–π—â–∏–∫–∞' });
                return;
            }

            if (!amount) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É' });
                return;
            }

            const member = members.find(m => m.id == memberId);
            if (member) {
                member.balance -= amount;
                localStorage.setItem('members', JSON.stringify(members));
            }

            closeModal('returnPaymentModal');
            renderMembers();
            updateStats();
            populateReturnPaymentMembers();

            showToast({ type: 'success', message: `–í–æ–∑–≤—Ä–∞—Ç ${formatMoney(amount)} –æ—Ñ–æ—Ä–º–ª–µ–Ω!` });

            // Clear form
            document.getElementById('returnPaymentMember').value = '';
            document.getElementById('returnPaymentAmount').value = '';
            document.getElementById('returnPaymentReason').value = '';
        }

        window.handleCreateTransaction = function(event) {
            event.preventDefault();
            
            const type = document.getElementById('transactionType').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value) || 0;
            const debit = document.getElementById('transactionDebit').value.trim();
            const credit = document.getElementById('transactionCredit').value.trim();
            const description = document.getElementById('transactionDescription').value.trim();
            const date = document.getElementById('transactionDate').value;

            if (!amount) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É' });
                return;
            }

            transactions.push({
                id: Date.now(),
                type,
                amount,
                debit,
                credit,
                description,
                date
            });
            localStorage.setItem('transactions', JSON.stringify(transactions));

            closeModal('createTransactionModal');
            showToast({ type: 'success', message: `–ü—Ä–æ–≤–æ–¥–∫–∞ –Ω–∞ —Å—É–º–º—É ${formatMoney(amount)} —Å–æ–∑–¥–∞–Ω–∞!` });

            // Clear form
            document.getElementById('transactionAmount').value = '';
            document.getElementById('transactionDebit').value = '';
            document.getElementById('transactionCredit').value = '';
            document.getElementById('transactionDescription').value = '';
        }

        window.generatePKO = function(event) {
            event.preventDefault();
            showToast({ type: 'success', message: '–ü–ö–û —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω! (PDF –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω)' });
            closeModal('pkoModal');
        }

        window.generateRKO = function(event) {
            event.preventDefault();
            showToast({ type: 'success', message: '–†–ö–û —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω! (PDF –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω)' });
            closeModal('rkoModal');
        }

        window.handlePaymentOrder = function(event) {
            event.preventDefault();
            showToast({ type: 'success', message: '–ü–ª–∞—Ç—ë–∂–Ω–æ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ!' });
            closeModal('paymentOrderModal');
        }

        window.handleInvoice = function(event) {
            event.preventDefault();
            showToast({ type: 'success', message: '–°—á—ë—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω!' });
            closeModal('invoiceModal');
        }

        window.handleActSverkaFull = function(event) {
            event.preventDefault();
            showToast({ type: 'success', message: '–ê–∫—Ç —Å–≤–µ—Ä–∫–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω!' });
            closeModal('actSverkaModal');
        }

        window.handleUploadDocument = function(event) {
            event.preventDefault();
            
            const name = document.getElementById('documentName').value.trim();
            const type = document.getElementById('documentType').value;
            const category = document.getElementById('documentCategory').value;

            if (!name) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞' });
                return;
            }

            documents.push({
                id: Date.now(),
                name,
                type,
                category,
                date: new Date().toISOString()
            });
            localStorage.setItem('documents', JSON.stringify(documents));

            closeModal('uploadDocumentModal');
            showToast({ type: 'success', message: `–î–æ–∫—É–º–µ–Ω—Ç "${name}" –∑–∞–≥—Ä—É–∂–µ–Ω!` });

            // Clear form
            document.getElementById('documentName').value = '';
        }

        window.handleSubmitApplication = function(event) {
            event.preventDefault();
            
            const type = document.getElementById('applicationType').value;
            const name = document.getElementById('applicationName').value.trim();
            const phone = document.getElementById('applicationPhone').value.trim();
            const email = document.getElementById('applicationEmail').value.trim();
            const share = parseFloat(document.getElementById('applicationShare').value) || 0;

            if (!name) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ –§–ò–û' });
                return;
            }

            applications.push({
                id: Date.now(),
                type,
                name,
                phone,
                email,
                share,
                status: 'pending',
                date: new Date().toISOString()
            });
            localStorage.setItem('applications', JSON.stringify(applications));

            closeModal('submitApplicationModal');
            showToast({ type: 'success', message: '–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ!' });

            // Clear form
            document.getElementById('applicationName').value = '';
            document.getElementById('applicationPhone').value = '';
            document.getElementById('applicationEmail').value = '';
        }

        window.approveApplication = function(appId) {
            const app = applications.find(a => a.id === appId);
            if (app) {
                app.status = 'approved';
                localStorage.setItem('applications', JSON.stringify(applications));
                showApplicationsRegistry();
                showToast({ type: 'success', message: '–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ!' });
            }
        }

        window.rejectApplication = function(appId) {
            const app = applications.find(a => a.id === appId);
            if (app) {
                app.status = 'rejected';
                localStorage.setItem('applications', JSON.stringify(applications));
                showApplicationsRegistry();
                showToast({ type: 'info', message: '–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ' });
            }
        }

        window.handleCreateMeeting = function(event) {
            event.preventDefault();
            
            const number = document.getElementById('meetingNumber').value.trim() || '1';
            const date = document.getElementById('meetingDate').value;
            const agenda = document.getElementById('meetingAgenda').value.trim();
            const attendees = parseInt(document.getElementById('meetingAttendees').value) || 0;

            meetings.push({
                id: Date.now(),
                number,
                date,
                agenda,
                attendees,
                createdAt: new Date().toISOString()
            });
            localStorage.setItem('meetings', JSON.stringify(meetings));

            closeModal('createMeetingModal');
            showToast({ type: 'success', message: `–ü—Ä–æ—Ç–æ–∫–æ–ª ‚Ññ${number} —Å–æ–∑–¥–∞–Ω!` });

            // Clear form
            document.getElementById('meetingNumber').value = '';
            document.getElementById('meetingDate').value = '';
            document.getElementById('meetingAgenda').value = '';
            document.getElementById('meetingAttendees').value = '';
        }

        window.addCalendarEvent = function() {
            const title = document.getElementById('calendarEventTitle').value.trim();
            const dateStart = document.getElementById('calendarEventDateStart').value;
            const dateEnd = document.getElementById('calendarEventDateEnd').value;
            const type = document.getElementById('calendarEventType').value;
            const description = document.getElementById('calendarEventDescription').value.trim();

            if (!title) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è' });
                return;
            }

            calendarEvents.push({
                id: Date.now(),
                title,
                dateStart,
                dateEnd,
                type,
                description
            });
            localStorage.setItem('calendarEvents', JSON.stringify(calendarEvents));

            closeModal('calendarEventModal');
            showToast({ type: 'success', message: '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å!' });

            // Clear form
            document.getElementById('calendarEventTitle').value = '';
            document.getElementById('calendarEventDateStart').value = '';
            document.getElementById('calendarEventDateEnd').value = '';
            document.getElementById('calendarEventDescription').value = '';
        }

        window.handleCreateFund = function(event) {
            event.preventDefault();
            
            const name = document.getElementById('fundName').value.trim();
            const type = document.getElementById('fundType').value;
            const amount = parseFloat(document.getElementById('fundAmount').value) || 0;

            if (!name) {
                showToast({ type: 'error', message: '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–æ–Ω–¥–∞' });
                return;
            }

            funds.push({
                id: Date.now(),
                name,
                type,
                amount
            });
            localStorage.setItem('funds', JSON.stringify(funds));

            closeModal('createFundModal');
            showToast({ type: 'success', message: `–§–æ–Ω–¥ "${name}" —Å–æ–∑–¥–∞–Ω!` });

            // Clear form
            document.getElementById('fundName').value = '';
            document.getElementById('fundAmount').value = '0';
        }

        window.saveProfile = function() {
            closeModal('profileModal');
            showToast({ type: 'success', message: '–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!' });
        }

        // ============================================
        // –û–¢–ß–Å–¢–´ (–∑–∞–≥–ª—É—à–∫–∏)
        // ============================================
        window.showOSVReport = function() {
            document.getElementById('osvReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">üìà –û–°–í —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('osvReportModal').classList.add('active');
        }

        window.showBalanceReport = function() {
            document.getElementById('balanceReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">‚öñÔ∏è –ë–∞–ª–∞–Ω—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('balanceReportModal').classList.add('active');
        }

        window.showProfitLossReport = function() {
            document.getElementById('profitLossReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">üìà –û—Ç—á—ë—Ç –æ —Ñ–∏–Ω. —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('profitLossReportModal').classList.add('active');
        }

        window.showKUDiRReport = function() {
            document.getElementById('kudirReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">üìñ –ö–£–î–∏–† —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('kudirReportModal').classList.add('active');
        }

        window.showTargetUseReport = function() {
            document.getElementById('targetUseReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">üéØ –û—Ç—á—ë—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('targetUseReportModal').classList.add('active');
        }

        window.showRSVReport = function() {
            document.getElementById('rsvReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">üìä –†–°–í —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('rsvReportModal').classList.add('active');
        }

        window.showSZVSTAZHReport = function() {
            document.getElementById('szvStazhReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">üìä –°–ó–í-–°–¢–ê–ñ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('szvStazhReportModal').classList.add('active');
        }

        window.show6NDFLReport = function() {
            document.getElementById('6ndflReportContent').innerHTML = '<div style="padding:40px;text-align:center;color:var(--text-secondary)">üìä 6-–ù–î–§–õ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...</div>';
            document.getElementById('6ndflReportModal').classList.add('active');
        }

        window.generateUSNZero = function() { showToast({ type: 'info', message: '–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù (–Ω—É–ª–µ–≤–∞—è) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...' }); closeModal('zeroReportingModal'); }
        window.generateBalanceZero = function() { showToast({ type: 'info', message: '–ë–∞–ª–∞–Ω—Å (–Ω—É–ª–µ–≤–æ–π) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...' }); closeModal('zeroReportingModal'); }
        window.generateSZVZero = function() { showToast({ type: 'info', message: '–°–ó–í-–°–¢–ê–ñ (–Ω—É–ª–µ–≤–æ–π) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...' }); closeModal('zeroReportingModal'); }
        window.generateRSVZero = function() { showToast({ type: 'info', message: '–†–°–í (–Ω—É–ª–µ–≤–æ–π) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...' }); closeModal('zeroReportingModal'); }
        window.generateSrednZero = function() { showToast({ type: 'info', message: '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è (–Ω—É–ª–µ–≤–∞—è) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...' }); closeModal('zeroReportingModal'); }
        window.generateUSNDeclaration = function() { showToast({ type: 'info', message: '–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –£–°–ù —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...' }); closeModal('usnDeclarationModal'); }
        window.generateAccountingCertificate = function() { showToast({ type: 'info', message: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...' }); closeModal('accountingCertificateModal'); }

        // ============================================
        // –£–¢–ò–õ–ò–¢–´
        // ============================================
        window.formatMoney = function(amount) {
            return new Intl.NumberFormat('ru-RU', {
                style: 'currency',
                currency: 'RUB',
                maximumFractionDigits: 0
            }).format(amount);
        }

        window.showToast = function({ type, message, duration = 3000 }) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icons = {
                success: '‚úì',
                error: '‚úï',
                warning: '‚ö†',
                info: '‚Ñπ'
            };

            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || '‚Ñπ'}</span>
                <span class="toast-message">${message}</span>
            `;

            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideInRight 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        window.closeModal = function(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Close modal on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        window.toggleDarkMode = function() {
            const currentMode = document.body.style.filter;
            if (currentMode === 'invert(1) hue-rotate(180deg)') {
                document.body.style.filter = '';
                localStorage.setItem('darkMode', 'false');
                showToast({ type: 'info', message: '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –≤–∫–ª—é—á–µ–Ω–∞' });
            } else {
                document.body.style.filter = 'invert(1) hue-rotate(180deg)';
                localStorage.setItem('darkMode', 'true');
                showToast({ type: 'info', message: 'üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ –≤–∫–ª—é—á–µ–Ω–∞' });
            }

            if (tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        // Apply saved dark mode
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.style.filter = 'invert(1) hue-rotate(180deg)';
        }

        window.showNotifications = function() {
            showToast({ type: 'info', message: 'üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:\n\n‚Ä¢ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö\n‚Ä¢ –ù–∞—á–∏—Å–ª–µ–Ω —á–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å 5 000 ‚ÇΩ\n‚Ä¢ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: —Å–æ–±—Ä–∞–Ω–∏–µ 15.03.2026' });
        }

        window.showProfile = function() {
            showToast({ type: 'info', message: 'üë§ –ü—Ä–æ—Ñ–∏–ª—å:\n\n–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä\n–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞' });
        }

        window.openMemberDetail = function(memberId) {
            const member = members.find(m => m.id === memberId);
            if (member) {
                showToast({ type: 'info', message: `üìá ${member.name}\n\n–ë–∞–ª–∞–Ω—Å: ${formatMoney(member.balance)}\n–°—Ç–∞—Ç—É—Å: ${member.status}` });
            }
        }

        window.toggleFab = function() {
            showToast({ type: 'info', message: '‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:\n\n–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—é –∏–∑ –º–µ–Ω—é –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ' });
        }

        window.exportMembersToExcel = function() {
            if (members.length === 0) {
                showToast({ type: 'warning', message: '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞' });
                return;
            }
            
            const ws = XLSX.utils.json_to_sheet(members);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, '–ü–∞–π—â–∏–∫–∏');
            XLSX.writeFile(wb, 'reestr_payschikov.xlsx');
            showToast({ type: 'success', message: '–≠–∫—Å–ø–æ—Ä—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω!' });
        }

        window.exportReportToExcel = function() {
            showToast({ type: 'info', message: '–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞...' });
        }

        // ============================================
        // YANDEX DISK INTEGRATION - –†–ï–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        // ============================================

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        window.updateSyncStatus = function(status, message) {
            const indicator = document.getElementById('syncIndicator');
            const text = document.getElementById('syncText');
            const statusContainer = document.querySelector('.sync-status');

            if (!indicator || !text) return;

            // –°–±—Ä–æ—Å –∫–ª–∞—Å—Å–æ–≤
            indicator.className = 'sync-indicator';

            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
            switch(status) {
                case 'synced':
                    indicator.style.background = 'var(--success-color)';
                    text.textContent = message || '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ';
                    text.style.color = '#4caf50';
                    break;
                case 'syncing':
                    indicator.className = 'sync-indicator syncing';
                    text.textContent = message || 'üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...';
                    text.style.color = '#ff9800';
                    break;
                case 'error':
                    indicator.className = 'sync-indicator error';
                    text.textContent = message || '‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏';
                    text.style.color = '#f44336';
                    break;
                case 'disconnected':
                    indicator.className = 'sync-indicator disconnected';
                    text.textContent = message || '‚õî –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏';
                    text.style.color = '#999';
                    break;
                default:
                    indicator.style.background = 'var(--success-color)';
                    text.textContent = message || '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ';
            }
        }

        window.updateYandexDiskStatus = function() {
            const token = localStorage.getItem('yandexDiskToken');
            const folderId = localStorage.getItem('yandexCooperativFolderId');
            const content = document.getElementById('yandexDiskStatus');

            if (!content) return;

            if (token && folderId) {
                content.innerHTML = `
                    <div style="margin-bottom:12px">
                        <div style="color:var(--success-color);font-weight:600;margin-bottom:4px">‚úÖ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω</div>
                        <div style="font-size:12px;color:var(--text-secondary)">–ü–∞–ø–∫–∞: –ö–û–û–ü–ï–†–ê–ù–¢</div>
                    </div>
                    <div style="display:flex;flex-direction:column;gap:8px">
                        <button onclick="window.forceSyncYandex()" class="btn btn-secondary btn-sm" style="width:100%">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button onclick="window.createBackupYandexDisk()" class="btn btn-secondary btn-sm" style="width:100%">üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</button>
                        <button onclick="window.logoutYandexDisk()" class="btn btn-danger btn-sm" style="width:100%">üö™ –í—ã–π—Ç–∏</button>
                    </div>
                `;

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ —Ö–µ–¥–µ—Ä–µ
                window.updateSyncStatus('synced', '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
            } else if (token) {
                content.innerHTML = `
                    <div style="color:var(--warning-color);font-weight:600;margin-bottom:8px">‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</div>
                    <button onclick="window.connectYandexDisk()" class="btn btn-primary btn-sm" style="width:100%">‚òÅÔ∏è –ü–æ–¥–∫–ª—é—á–∏—Ç—å</button>
                `;

                window.updateSyncStatus('disconnected', '‚õî –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
            } else {
                content.innerHTML = `
                    <div style="color:var(--text-secondary);margin-bottom:12px">‚òÅÔ∏è –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</div>
                    <button onclick="window.connectYandexDisk()" class="btn btn-primary btn-sm" style="width:100%">üîê –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å</button>
                `;

                window.updateSyncStatus('disconnected', '‚õî –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
            }
        }

        // –ö–ª–∏–∫ –ø–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        document.addEventListener('DOMContentLoaded', function() {
            const statusContainer = document.querySelector('.sync-status');
            if (statusContainer) {
                statusContainer.addEventListener('click', function() {
                    const token = localStorage.getItem('yandexDiskToken');
                    if (token) {
                        window.forceSyncYandex();
                    } else {
                        window.showBackupModal();
                    }
                });
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            setTimeout(() => {
                window.updateYandexDiskStatus();
            }, 500);
        });

        window.connectYandexDisk = function() {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ yandex-disk-integration-v2.js
            if (typeof window.connectYandexDiskAuth === 'function') {
                window.connectYandexDiskAuth();
            } else {
                // Fallback - –æ—Ç–∫—Ä—ã–≤–∞–µ–º OAuth –æ–∫–Ω–æ
                const authUrl = `https://oauth.yandex.ru/authorize?response_type=token&client_id=${YANDEX_DISK_CONFIG.CLIENT_ID}&redirect_uri=${encodeURIComponent(YANDEX_DISK_CONFIG.REDIRECT_URI)}`;
                window.open(authUrl, '_blank');
            }
        }

        window.createBackupYandexDisk = function() {
            if (typeof window.saveAllDataToYandex === 'function') {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                window.updateSyncStatus('syncing', 'üîÑ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏...');

                window.saveAllDataToYandex().then(() => {
                    showToast({ type: 'success', message: '‚úÖ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–µ!' });
                    window.updateSyncStatus('synced', '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                }).catch(err => {
                    showToast({ type: 'error', message: '‚ùå –û—à–∏–±–∫–∞: ' + err.message });
                    window.updateSyncStatus('error', '‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
                });
            } else {
                showToast({ type: 'warning', message: '‚ö†Ô∏è –§—É–Ω–∫—Ü–∏—è –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞' });
            }
        }

        window.forceSyncYandex = function() {
            if (typeof window.loadAllDataFromYandex === 'function') {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                window.updateSyncStatus('syncing', 'üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...');

                window.loadAllDataFromYandex().then(() => {
                    showToast({ type: 'success', message: '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!' });
                    window.updateSyncStatus('synced', '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                    window.renderMembers();
                    window.updateStats();
                }).catch(err => {
                    showToast({ type: 'error', message: '‚ùå –û—à–∏–±–∫–∞: ' + err.message });
                    window.updateSyncStatus('error', '‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
                });
            } else {
                showToast({ type: 'warning', message: '‚ö†Ô∏è –§—É–Ω–∫—Ü–∏—è –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞' });
            }
        }

        window.logoutYandexDisk = function() {
            localStorage.removeItem('yandexDiskToken');
            localStorage.removeItem('yandexCooperativFolderId');
            localStorage.removeItem('yandexLastSync');
            showToast({ type: 'success', message: '‚úÖ –í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω' });
            window.updateYandexDiskStatus();
            if (window.autoSaveYandexInterval) {
                clearInterval(window.autoSaveYandexInterval);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                window.updateYandexDiskStatus();
                
                // –ê–≤—Ç–æ-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á—ë–Ω
                const token = localStorage.getItem('yandexDiskToken');
                if (token && typeof window.startAutoSaveYandex === 'function') {
                    window.startAutoSaveYandex();
                }
            }, 1000);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        window.handleYandexCallback = function() {
            const hash = window.location.hash;
            const urlParams = new URLSearchParams(window.location.search);
            
            let token = null;
            
            // –ò–∑ hash
            if (hash && hash.includes('access_token')) {
                const hashParams = new URLSearchParams(hash.substring(1));
                token = hashParams.get('access_token');
            }
            
            // –ò–∑ search
            if (!token && urlParams.get('access_token')) {
                token = urlParams.get('access_token');
            }
            
            if (token) {
                console.log('[Yandex] –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω');
                localStorage.setItem('yandexDiskToken', token);
                
                // –û—á–∏—â–∞–µ–º URL
                window.history.replaceState({}, document.title, window.location.pathname);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                showToast({ type: 'success', message: '‚úÖ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω!', duration: 5000 });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                window.updateYandexDiskStatus();
                
                // –°–æ–∑–¥–∞—ë–º –ø–∞–ø–∫—É –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                if (typeof window.createCooperativFolder === 'function') {
                    window.createCooperativFolder().then(() => {
                        window.saveAllDataToYandex();
                    });
                }
                
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫—É–¥–∞ —à–ª–∏
                const returnUrl = sessionStorage.getItem('yandex_return_url');
                if (returnUrl && returnUrl !== window.location.href) {
                    setTimeout(() => {
                        window.location.href = returnUrl;
                    }, 2000);
                }
            }
        };

        // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            setTimeout(() => {
                window.handleYandexCallback();
            }, 500);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç callback –æ–∫–Ω–∞
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'YANDEX_TOKEN') {
                const token = event.data.token;
                if (token) {
                    localStorage.setItem('yandexDiskToken', token);
                    showToast({ type: 'success', message: '‚úÖ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω!' });
                    window.updateYandexDiskStatus();
                }
            }
        });

        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ JSON
        window.exportDataJSON = function() {
            const data = {
                members: window.members || [],
                payments: window.payments || [],
                transactions: window.transactions || [],
                documents: window.documents || [],
                applications: window.applications || [],
                meetings: window.meetings || [],
                funds: window.funds || [],
                calendarEvents: window.calendarEvents || []
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `koop_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast({ type: 'success', message: 'üì• –≠–∫—Å–ø–æ—Ä—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω!' });
        }

        // –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON
        window.importDataJSON = function() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = e => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = event => {
                        try {
                            const data = JSON.parse(event.target.result);
                            if (data.members) window.members = data.members;
                            if (data.payments) window.payments = data.payments;
                            if (data.transactions) window.transactions = data.transactions;
                            if (data.documents) window.documents = data.documents;
                            if (data.applications) window.applications = data.applications;
                            if (data.meetings) window.meetings = data.meetings;
                            if (data.funds) window.funds = data.funds;
                            if (data.calendarEvents) window.calendarEvents = data.calendarEvents;
                            
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                            localStorage.setItem('members', JSON.stringify(window.members));
                            localStorage.setItem('payments', JSON.stringify(window.payments));
                            localStorage.setItem('transactions', JSON.stringify(window.transactions));
                            localStorage.setItem('documents', JSON.stringify(window.documents));
                            localStorage.setItem('applications', JSON.stringify(window.applications));
                            localStorage.setItem('meetings', JSON.stringify(window.meetings));
                            localStorage.setItem('funds', JSON.stringify(window.funds));
                            localStorage.setItem('calendarEvents', JSON.stringify(window.calendarEvents));
                            
                            showToast({ type: 'success', message: 'üì• –ò–º–ø–æ—Ä—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω! –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.' });
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º UI
                            setTimeout(() => {
                                window.renderMembers();
                                window.updateStats();
                            }, 500);
                        } catch (err) {
                            showToast({ type: 'error', message: '‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: ' + err.message });
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

    </script>
</body>
</html>
