<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ø–∞–π—â–∏–∫–∞ | –ö–û–û–ü–ï–†–ê–ù–¢</title>
    <script>
        // –ü–†–û–í–ï–†–ö–ê –†–û–õ–ò –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        (function() {
            const selectedRole = localStorage.getItem('selectedRole');
            
            // –ï—Å–ª–∏ —Ä–æ–ª—å –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ —Ä–æ–ª—å "cooperative" ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º
            if (!selectedRole || selectedRole !== 'member') {
                window.location.href = 'index.html';
            }
        })();
    </script>
    <style>
        :root {
            --primary-color: #2196F3;
            --primary-dark: #1976D2;
            --success-color: #4CAF50;
            --warning-color: #FF9800;
            --danger-color: #F44336;
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-primary: #212121;
            --text-secondary: #757575;
            --border-color: #e0e0e0;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 16px rgba(0,0,0,0.15);
            --radius: 12px;
            --radius-sm: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 16px 24px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 600;
        }

        .logo-icon {
            font-size: 28px;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-info {
            text-align: right;
        }

        .user-name {
            font-weight: 600;
            font-size: 14px;
        }

        .user-email {
            font-size: 12px;
            opacity: 0.9;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            background: var(--card-bg);
            padding: 8px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .tab {
            flex: 1;
            padding: 12px 24px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            transition: all 0.2s;
        }

        .tab:hover {
            background: var(--bg-color);
        }

        .tab.active {
            background: var(--primary-color);
            color: white;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 24px;
            margin-bottom: 24px;
            transition: box-shadow 0.2s;
        }

        .card:hover {
            box-shadow: var(--shadow-hover);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Cooperative Grid */
        .coop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .coop-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .coop-card:hover {
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .coop-card-header {
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-bottom: 1px solid var(--border-color);
        }

        .coop-card-body {
            padding: 20px;
        }

        .coop-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .coop-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-active {
            background: #E8F5E9;
            color: #2E7D32;
        }

        .status-pending {
            background: #FFF3E0;
            color: #EF6C00;
        }

        .status-suspended {
            background: #FFEBEE;
            color: #C62828;
        }

        .coop-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 16px;
        }

        .info-item {
            font-size: 13px;
        }

        .info-label {
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .info-value {
            font-weight: 500;
        }

        .coop-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--bg-color);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .btn-outline:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 13px;
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        /* Search Bar */
        .search-bar {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .search-filters {
            display: flex;
            gap: 8px;
        }

        .filter-select {
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 14px;
            background: var(--card-bg);
            cursor: pointer;
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
        }

        /* Notifications */
        .notification-badge {
            position: relative;
            cursor: pointer;
        }

        .notification-count {
            position: absolute;
            top: -4px;
            right: -4px;
            background: var(--danger-color);
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--card-bg);
            border-radius: var(--radius);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Form */
        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 12px;
            }

            .user-menu {
                width: 100%;
                justify-content: space-between;
            }

            .tabs {
                overflow-x: auto;
            }

            .coop-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .search-bar {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            animation: fadeIn 0.3s ease-out;
        }

        /* Sync Status */
        .sync-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .sync-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-color);
        }

        .sync-indicator.syncing {
            background: var(--warning-color);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Discrepancy Alert */
        .discrepancy-alert {
            background: #FFF3E0;
            border-left: 4px solid var(--warning-color);
            padding: 16px;
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
        }

        .discrepancy-title {
            font-weight: 600;
            color: #EF6C00;
            margin-bottom: 8px;
        }

        .discrepancy-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .discrepancy-table th,
        .discrepancy-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #FFE0B2;
        }

        .discrepancy-table th {
            color: #E65100;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üè†</span>
                <span>–ö–û–û–ü–ï–†–ê–ù–¢</span>
            </div>
            <div class="user-menu">
                <div class="notification-badge" onclick="showNotifications()">
                    üîî
                    <span class="notification-count" id="notifCount">3</span>
                </div>
                <div class="user-info">
                    <div class="user-name" id="userName">–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á</div>
                    <div class="user-email" id="userEmail">ivanov@yandex.ru</div>
                </div>
                <div class="avatar" onclick="showProfile()">üë§</div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('my')">üìã –ú–æ–∏ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤—ã</button>
            <button class="tab" onclick="switchTab('search')">üîç –ü–æ–∏—Å–∫ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞</button>
            <button class="tab" onclick="switchTab('applications')">üì® –ú–æ–∏ –∑–∞—è–≤–ª–µ–Ω–∏—è</button>
        </div>

        <!-- Stats -->
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <div class="stat-value" id="totalCoops">2</div>
                <div class="stat-label">–ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–æ–≤</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #4CAF50, #388E3C);">
                <div class="stat-value" id="activeCoops">2</div>
                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #FF9800, #F57C00);">
                <div class="stat-value" id="pendingApps">1</div>
                <div class="stat-label">–ó–∞—è–≤–ª–µ–Ω–∏–π</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #9C27B0, #7B1FA2);">
                <div class="stat-value" id="totalInvested">160 000 ‚ÇΩ</div>
                <div class="stat-label">–í–Ω–µ—Å–µ–Ω–æ</div>
            </div>
        </div>

        <!-- Tab: My Cooperatives -->
        <div id="tab-my" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">–ú–æ–∏ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤—ã</div>
                        <div class="card-subtitle">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —á–ª–µ–Ω—Å—Ç–≤–æ–º –≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞—Ö</div>
                    </div>
                    <div class="sync-status">
                        <div class="sync-indicator" id="syncIndicator"></div>
                        <span id="syncText">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: 2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</span>
                        <button class="btn btn-sm btn-outline" onclick="syncAll()" style="margin-left: 12px;">
                            üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                    </div>
                </div>
            </div>

            <div class="coop-grid" id="myCoopsGrid">
                <!-- Cooperative cards will be rendered here -->
            </div>

            <!-- Add New -->
            <div class="card" style="text-align: center; padding: 40px;">
                <div class="empty-icon">‚ûï</div>
                <div class="empty-title">–í—Å—Ç—É–ø–∏—Ç—å –≤ –Ω–æ–≤—ã–π –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</div>
                <p style="margin-bottom: 16px; color: var(--text-secondary);">
                    –ù–∞–π–¥–∏—Ç–µ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –∏ –ø–æ–¥–∞–π—Ç–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ
                </p>
                <button class="btn btn-primary" onclick="switchTab('search')">
                    üîç –ù–∞–π—Ç–∏ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤
                </button>
            </div>
        </div>

        <!-- Tab: Search -->
        <div id="tab-search" class="tab-content" style="display: none;">
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">–ü–æ–∏—Å–∫ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–æ–≤</div>
                        <div class="card-subtitle">–ù–∞–π–¥–∏—Ç–µ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤ –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</div>
                    </div>
                </div>
            </div>

            <div class="search-bar">
                <input type="text" class="search-input" id="searchInput" 
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –ò–ù–ù –∏–ª–∏ —Ä–µ–≥–∏–æ–Ω..."
                       oninput="searchCooperatives()">
                <div class="search-filters">
                    <select class="filter-select" id="regionFilter" onchange="searchCooperatives()">
                        <option value="">–í—Å–µ —Ä–µ–≥–∏–æ–Ω—ã</option>
                        <option value="–ú–æ—Å–∫–≤–∞">–ú–æ—Å–∫–≤–∞</option>
                        <option value="–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π">–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                        <option value="–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
                    </select>
                    <select class="filter-select" id="typeFilter" onchange="searchCooperatives()">
                        <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                        <option value="credit">–ö—Ä–µ–¥–∏—Ç–Ω—ã–µ</option>
                        <option value="agricultural">–°–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ</option>
                        <option value="housing">–ñ–∏–ª–∏—â–Ω—ã–µ</option>
                    </select>
                </div>
            </div>

            <div class="coop-grid" id="searchGrid">
                <!-- Search results will be rendered here -->
            </div>
        </div>

        <!-- Tab: Applications -->
        <div id="tab-applications" class="tab-content" style="display: none;">
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">–ú–æ–∏ –∑–∞—è–≤–ª–µ–Ω–∏—è</div>
                        <div class="card-subtitle">–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–ª–µ–Ω–∏–π</div>
                    </div>
                </div>
            </div>

            <div id="applicationsList">
                <!-- Applications will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Cooperative Detail -->
    <div class="modal-overlay" id="coopModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalCoopName">–ö–ü–ö "–ü–µ—Ä–≤—ã–π"</div>
                <button class="modal-close" onclick="closeModal('coopModal')">√ó</button>
            </div>
            <div class="modal-body" id="modalCoopBody">
                <!-- Content will be rendered here -->
            </div>
            <div class="modal-footer" id="modalCoopFooter">
                <!-- Actions will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Modal: Application Form -->
    <div class="modal-overlay" id="applicationModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">–ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ</div>
                <button class="modal-close" onclick="closeModal('applicationModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–§–ò–û *</label>
                    <input type="text" class="form-input" id="appFullName" value="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è *</label>
                        <input type="date" class="form-input" id="appBirthDate" value="1980-05-15">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input type="tel" class="form-input" id="appPhone" value="+79001234567">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-input" id="appEmail" value="ivanov@yandex.ru">
                </div>
                <div class="form-group">
                    <label class="form-label">–ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ *</label>
                    <input type="text" class="form-input" id="appAddress" value="–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1, –∫–≤. 1">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å</label>
                        <input type="text" class="form-input" id="appEntranceFee" value="1 000 ‚ÇΩ" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–π *</label>
                        <input type="number" class="form-input" id="appShareAmount" value="10000" min="10000">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="appAgree" checked>
                        –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å —É—Å—Ç–∞–≤–æ–º –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞ –∏ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö *
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('applicationModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="submitApplication()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ</button>
            </div>
        </div>
    </div>

    <!-- Modal: Discrepancies -->
    <div class="modal-overlay" id="discrepancyModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‚ö†Ô∏è –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö</div>
                <button class="modal-close" onclick="closeModal('discrepancyModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="discrepancy-alert">
                    <div class="discrepancy-title">–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</div>
                    <table class="discrepancy-table">
                        <thead>
                            <tr>
                                <th>–ü–æ–ª–µ</th>
                                <th>–£ –≤–∞—Å</th>
                                <th>–í –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–µ</th>
                            </tr>
                        </thead>
                        <tbody id="discrepancyTableBody">
                            <!-- Will be rendered here -->
                        </tbody>
                    </table>
                </div>
                <div style="margin-top: 16px;">
                    <p style="margin-bottom: 12px; font-weight: 500;">–ß—Ç–æ –¥–µ–ª–∞—Ç—å?</p>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <button class="btn btn-primary btn-block" onclick="resolveDiscrepancy('accept')">
                            ‚úÖ –ü—Ä–∏–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞
                        </button>
                        <button class="btn btn-secondary btn-block" onclick="resolveDiscrepancy('request')">
                            üìù –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                        </button>
                        <button class="btn btn-outline btn-block" onclick="resolveDiscrepancy('ignore')">
                            ‚è≠Ô∏è –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // –î–ê–ù–ù–´–ï (Demo)
        // ============================================
        
        const cooperatives = [
            {
                id: 'coop_001',
                name: '–ö–ü–ö "–ü–µ—Ä–≤—ã–π"',
                inn: '1234567890',
                region: '–ú–æ—Å–∫–≤–∞',
                type: 'credit',
                typeName: '–ö—Ä–µ–¥–∏—Ç–Ω—ã–π',
                status: 'active',
                address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1',
                phone: '+7 (495) 123-45-67',
                email: 'info@koop1.ru',
                membersCount: 150,
                shareCapital: 5000000,
                foundedYear: 2020,
                entranceFee: 1000,
                minShare: 10000,
                logo: 'üè¶'
            },
            {
                id: 'coop_002',
                name: '–°–ü–ö "–ê–≥—Ä–æ"',
                inn: '9876543210',
                region: '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π',
                type: 'agricultural',
                typeName: '–°–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–π',
                status: 'active',
                address: '–≥. –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä, —É–ª. –°–µ–ª—å—Å–∫–∞—è, –¥. 10',
                phone: '+7 (861) 234-56-78',
                email: 'info@agro-koop.ru',
                membersCount: 75,
                shareCapital: 2500000,
                foundedYear: 2018,
                entranceFee: 500,
                minShare: 5000,
                logo: 'üåæ'
            },
            {
                id: 'coop_003',
                name: '–ñ–°–ö "–î–æ–º"',
                inn: '1122334455',
                region: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',
                type: 'housing',
                typeName: '–ñ–∏–ª–∏—â–Ω—ã–π',
                status: 'active',
                address: '–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø—Ä. –°—Ç—Ä–æ–∏—Ç–µ–ª–µ–π, –¥. 5',
                phone: '+7 (812) 345-67-89',
                email: 'info@zhsk-dom.ru',
                membersCount: 200,
                shareCapital: 10000000,
                foundedYear: 2015,
                entranceFee: 2000,
                minShare: 50000,
                logo: 'üè†'
            }
        ];

        const myMemberships = [
            {
                cooperativeId: 'coop_001',
                status: 'active',
                joinDate: '2023-03-15',
                shareAmount: 100000,
                paidAmount: 100000,
                debt: 0,
                certificateNumber: '001-2023',
                lastSync: new Date(Date.now() - 2 * 60 * 60 * 1000), // 2 hours ago
                discrepancies: []
            },
            {
                cooperativeId: 'coop_002',
                status: 'active',
                joinDate: '2024-06-20',
                shareAmount: 50000,
                paidAmount: 55000,
                debt: 0,
                certificateNumber: '025-2024',
                lastSync: new Date(Date.now() - 24 * 60 * 60 * 1000), // 1 day ago
                discrepancies: []
            }
        ];

        const applications = [
            {
                id: 'app_001',
                cooperativeId: 'coop_003',
                cooperativeName: '–ñ–°–ö "–î–æ–º"',
                type: 'join',
                status: 'pending',
                submittedAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000), // 2 days ago
                shareAmount: 50000
            }
        ];

        let selectedCoopId = null;

        // ============================================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ============================================

        document.addEventListener('DOMContentLoaded', function() {
            renderMyCooperatives();
            renderSearchResults();
            renderApplications();
            updateStats();
        });

        // ============================================
        // –ù–ê–í–ò–ì–ê–¶–ò–Ø
        // ============================================

        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`tab-${tabName}`).style.display = 'block';
            
            // Activate button
            event.target.classList.add('active');
        }

        // ============================================
        // –†–ï–ù–î–ï–†–ò–ù–ì
        // ============================================

        function renderMyCooperatives() {
            const grid = document.getElementById('myCoopsGrid');
            grid.innerHTML = '';

            myMemberships.forEach(membership => {
                const coop = cooperatives.find(c => c.id === membership.cooperativeId);
                if (!coop) return;

                const card = createCoopCard(coop, membership, true);
                grid.appendChild(card);
            });
        }

        function renderSearchResults() {
            const grid = document.getElementById('searchGrid');
            grid.innerHTML = '';

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const regionFilter = document.getElementById('regionFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;

            const filtered = cooperatives.filter(coop => {
                const matchesSearch = coop.name.toLowerCase().includes(searchTerm) ||
                                     coop.inn.includes(searchTerm) ||
                                     coop.region.toLowerCase().includes(searchTerm);
                const matchesRegion = !regionFilter || coop.region === regionFilter;
                const matchesType = !typeFilter || coop.type === typeFilter;
                const isAlreadyMember = myMemberships.some(m => m.cooperativeId === coop.id);
                
                return matchesSearch && matchesRegion && matchesType && !isAlreadyMember;
            });

            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">üîç</div>
                        <div class="empty-title">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
                    </div>
                `;
                return;
            }

            filtered.forEach(coop => {
                const card = createCoopCard(coop, null, false);
                grid.appendChild(card);
            });
        }

        function createCoopCard(coop, membership, isMember) {
            const card = document.createElement('div');
            card.className = 'coop-card';

            const statusClass = membership ? 
                (membership.status === 'active' ? 'status-active' : 
                 membership.status === 'pending' ? 'status-pending' : 'status-suspended') : 
                'status-active';
            
            const statusText = membership ?
                (membership.status === 'active' ? '‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–π' : 
                 membership.status === 'pending' ? '‚è≥ –ó–∞—è–≤–ª–µ–Ω–∏–µ' : '‚õî –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω') :
                '‚úÖ –î–µ–π—Å—Ç–≤—É—é—â–∏–π';

            const lastSyncText = membership ? 
                formatLastSync(membership.lastSync) : '';

            card.innerHTML = `
                <div class="coop-card-header">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 32px;">${coop.logo}</span>
                        <div>
                            <div class="coop-name">${coop.name}</div>
                            <span class="coop-status ${statusClass}">${statusText}</span>
                        </div>
                    </div>
                </div>
                <div class="coop-card-body">
                    <div class="coop-info">
                        <div class="info-item">
                            <div class="info-label">–†–µ–≥–∏–æ–Ω</div>
                            <div class="info-value">${coop.region}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–¢–∏–ø</div>
                            <div class="info-value">${coop.typeName}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–ü–∞–π—â–∏–∫–æ–≤</div>
                            <div class="info-value">${coop.membersCount}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–ü–∞–µ–≤–æ–π —Ñ–æ–Ω–¥</div>
                            <div class="info-value">${formatMoney(coop.shareCapital)}</div>
                        </div>
                        ${membership ? `
                        <div class="info-item">
                            <div class="info-label">–í–Ω–µ—Å–µ–Ω–æ</div>
                            <div class="info-value">${formatMoney(membership.paidAmount)}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</div>
                            <div class="info-value" style="font-size: 11px;">${lastSyncText}</div>
                        </div>
                        ` : ''}
                    </div>
                    <div class="coop-actions">
                        ${isMember ? `
                            <button class="btn btn-primary btn-sm" onclick="openCoopDetail('${coop.id}', true)">
                                üìä –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                            </button>
                            <button class="btn btn-outline btn-sm" onclick="syncCooperative('${coop.id}')">
                                üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        ` : `
                            <button class="btn btn-primary btn-sm" onclick="openCoopDetail('${coop.id}', false)">
                                üìã –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="openApplicationForm('${coop.id}')">
                                üì® –ü–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ
                            </button>
                        `}
                    </div>
                </div>
            `;

            return card;
        }

        function renderApplications() {
            const list = document.getElementById('applicationsList');
            
            if (applications.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üì®</div>
                        <div class="empty-title">–ù–µ—Ç –∑–∞—è–≤–ª–µ–Ω–∏–π</div>
                        <p>–ü–æ–¥–∞–π—Ç–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = applications.map(app => {
                const statusClass = app.status === 'pending' ? 'status-pending' :
                                   app.status === 'approved' ? 'status-active' : 'status-suspended';
                const statusText = app.status === 'pending' ? '‚è≥ –ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏' :
                                   app.status === 'approved' ? '‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ' : '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ';

                return `
                    <div class="card" style="margin-bottom: 16px;">
                        <div class="card-header">
                            <div>
                                <div class="card-title">${app.cooperativeName}</div>
                                <div class="card-subtitle">–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ—Ç ${formatDate(app.submittedAt)}</div>
                            </div>
                            <span class="coop-status ${statusClass}">${statusText}</span>
                        </div>
                        <div style="display: flex; gap: 16px; margin-top: 16px;">
                            <div class="info-item">
                                <div class="info-label">–°—É–º–º–∞ –ø–∞—è</div>
                                <div class="info-value">${formatMoney(app.shareAmount)}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å</div>
                                <div class="info-value">${formatMoney(1000)}</div>
                            </div>
                        </div>
                        ${app.status === 'pending' ? `
                        <div class="coop-actions" style="border: none; padding-top: 16px;">
                            <button class="btn btn-outline btn-sm">
                                üìÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="cancelApplication('${app.id}')">
                                ‚ùå –û—Ç–æ–∑–≤–∞—Ç—å
                            </button>
                        </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function updateStats() {
            document.getElementById('totalCoops').textContent = myMemberships.length;
            document.getElementById('activeCoops').textContent = myMemberships.filter(m => m.status === 'active').length;
            document.getElementById('pendingApps').textContent = applications.filter(a => a.status === 'pending').length;
            
            const total = myMemberships.reduce((sum, m) => sum + m.paidAmount, 0);
            document.getElementById('totalInvested').textContent = formatMoney(total);
        }

        // ============================================
        // –§–£–ù–ö–¶–ò–ò
        // ============================================

        function searchCooperatives() {
            renderSearchResults();
        }

        function openCoopDetail(coopId, isMember) {
            selectedCoopId = coopId;
            const coop = cooperatives.find(c => c.id === coopId);
            const membership = myMemberships.find(m => m.cooperativeId === coopId);

            const modal = document.getElementById('coopModal');
            const body = document.getElementById('modalCoopBody');
            const footer = document.getElementById('modalCoopFooter');

            body.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h3 style="margin-bottom: 12px;">üìä –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <div class="coop-info" style="grid-template-columns: 1fr;">
                        <div class="info-item">
                            <div class="info-label">–ò–ù–ù</div>
                            <div class="info-value">${coop.inn}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–ê–¥—Ä–µ—Å</div>
                            <div class="info-value">${coop.address}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–¢–µ–ª–µ—Ñ–æ–Ω</div>
                            <div class="info-value">${coop.phone}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Email</div>
                            <div class="info-value">${coop.email}</div>
                        </div>
                    </div>
                </div>

                ${isMember && membership ? `
                <div style="margin-bottom: 20px;">
                    <h3 style="margin-bottom: 12px;">üí∞ –ú–æ–∏ –≤–∑–Ω–æ—Å—ã</h3>
                    <div class="coop-info">
                        <div class="info-item">
                            <div class="info-label">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–π</div>
                            <div class="info-value">${formatMoney(membership.shareAmount)}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–í–Ω–µ—Å–µ–Ω–æ</div>
                            <div class="info-value" style="color: var(--success-color);">${formatMoney(membership.paidAmount)}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å</div>
                            <div class="info-value" style="color: ${membership.debt > 0 ? 'var(--danger-color)' : 'var(--success-color)'};">
                                ${formatMoney(membership.debt)}
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ</div>
                            <div class="info-value">‚Ññ${membership.certificateNumber}</div>
                        </div>
                    </div>
                </div>
                ` : ''}

                <div>
                    <h3 style="margin-bottom: 12px;">üìã –£—Å–ª–æ–≤–∏—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</h3>
                    <div class="coop-info">
                        <div class="info-item">
                            <div class="info-label">–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å</div>
                            <div class="info-value">${formatMoney(coop.entranceFee)}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–∞–π</div>
                            <div class="info-value">${formatMoney(coop.minShare)}</div>
                        </div>
                    </div>
                </div>
            `;

            footer.innerHTML = isMember ? `
                <button class="btn btn-secondary" onclick="closeModal('coopModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="showMemberDetail('${coopId}')">üìá –ú–æ–∏ –¥–∞–Ω–Ω—ã–µ</button>
            ` : `
                <button class="btn btn-secondary" onclick="closeModal('coopModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="openApplicationForm('${coopId}')">üì® –ü–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ</button>
            `;

            modal.classList.add('active');
        }

        function openApplicationForm(coopId) {
            selectedCoopId = coopId;
            document.getElementById('applicationModal').classList.add('active');
        }

        function submitApplication() {
            const coop = cooperatives.find(c => c.id === selectedCoopId);
            const shareAmount = document.getElementById('appShareAmount').value;
            const agree = document.getElementById('appAgree').checked;

            if (!agree) {
                alert('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏–µ —Å —É—Å—Ç–∞–≤–æ–º');
                return;
            }

            applications.push({
                id: `app_${Date.now()}`,
                cooperativeId: coop.id,
                cooperativeName: coop.name,
                type: 'join',
                status: 'pending',
                submittedAt: new Date(),
                shareAmount: parseInt(shareAmount)
            });

            closeModal('applicationModal');
            renderApplications();
            updateStats();
            switchTab('applications');
            
            alert(`–ó–∞—è–≤–ª–µ–Ω–∏–µ –≤ "${coop.name}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!\n\n–í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ email –ø–æ—Å–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è.`);
        }

        function cancelApplication(appId) {
            if (confirm('–û—Ç–æ–∑–≤–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ?')) {
                const index = applications.findIndex(a => a.id === appId);
                if (index > -1) {
                    applications[index].status = 'cancelled';
                    renderApplications();
                    updateStats();
                }
            }
        }

        function syncCooperative(coopId) {
            const indicator = document.getElementById('syncIndicator');
            const text = document.getElementById('syncText');
            
            indicator.classList.add('syncing');
            text.textContent = '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...';

            setTimeout(() => {
                indicator.classList.remove('syncing');
                
                // –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
                const hasDiscrepancies = Math.random() > 0.7;
                
                if (hasDiscrepancies) {
                    showDiscrepancies();
                } else {
                    const membership = myMemberships.find(m => m.cooperativeId === coopId);
                    if (membership) {
                        membership.lastSync = new Date();
                    }
                    text.textContent = `–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: —Ç–æ–ª—å–∫–æ —á—Ç–æ`;
                    renderMyCooperatives();
                    alert('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!\n\n–î–∞–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã.');
                }
            }, 1500);
        }

        function syncAll() {
            myMemberships.forEach((m, index) => {
                setTimeout(() => syncCooperative(m.cooperativeId), index * 500);
            });
        }

        function showDiscrepancies() {
            const tbody = document.getElementById('discrepancyTableBody');
            tbody.innerHTML = `
                <tr>
                    <td>üìû –¢–µ–ª–µ—Ñ–æ–Ω</td>
                    <td>+7 (900) 111-22-22</td>
                    <td>+7 (900) 333-44-44</td>
                </tr>
                <tr>
                    <td>‚úâÔ∏è Email</td>
                    <td>old@mail.ru</td>
                    <td>new@mail.ru</td>
                </tr>
            `;
            
            document.getElementById('discrepancyModal').classList.add('active');
        }

        function resolveDiscrepancy(action) {
            closeModal('discrepancyModal');
            
            switch(action) {
                case 'accept':
                    alert('‚úÖ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ –≤–µ—Ä—Å–∏–∏ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞');
                    break;
                case 'request':
                    alert('üìù –ó–∞–ø—Ä–æ—Å –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤\n\n–û–∂–∏–¥–∞–π—Ç–µ –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –¥–Ω–µ–π');
                    break;
                case 'ignore':
                    alert('‚è≠Ô∏è –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. –ù–∞–ø–æ–º–Ω–∏—Ç—å –ø–æ–∑–∂–µ?');
                    break;
            }
        }

        // ============================================
        // –£–¢–ò–õ–ò–¢–´
        // ============================================

        function formatMoney(amount) {
            return new Intl.NumberFormat('ru-RU', { 
                style: 'currency', 
                currency: 'RUB',
                maximumFractionDigits: 0 
            }).format(amount);
        }

        function formatDate(date) {
            return new Intl.DateTimeFormat('ru-RU', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            }).format(new Date(date));
        }

        function formatLastSync(date) {
            const now = new Date();
            const diff = now - date;
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const days = Math.floor(hours / 24);
            
            if (hours < 1) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            if (hours < 24) return `${hours} —á. –Ω–∞–∑–∞–¥`;
            if (days === 1) return '–≤—á–µ—Ä–∞';
            return `${days} –¥–Ω. –Ω–∞–∑–∞–¥`;
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function showNotifications() {
            alert('üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:\n\n' +
                  '1. ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö\n' +
                  '2. üí∞ –ù–∞—á–∏—Å–ª–µ–Ω —á–ª–µ–Ω—Å–∫–∏–π –≤–∑–Ω–æ—Å 5 000 ‚ÇΩ\n' +
                  '3. üìÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: —Å–æ–±—Ä–∞–Ω–∏–µ 15.03.2026');
        }

        function showProfile() {
            alert('üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–∞–π—â–∏–∫–∞\n\n' +
                  '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á\n' +
                  'ID: 79001234567\n' +
                  'Email: ivanov@yandex.ru\n\n' +
                  '[–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å]\n[–ù–∞—Å—Ç—Ä–æ–π–∫–∏]\n[–í—ã—Ö–æ–¥]');
        }

        function showMemberDetail(coopId) {
            alert('üìá –î–µ—Ç–∞–ª–∏ —á–ª–µ–Ω—Å—Ç–≤–∞\n\n' +
                  '–ó–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n' +
                  '‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è –≤–∑–Ω–æ—Å–æ–≤\n' +
                  '‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç—ã\n' +
                  '‚Ä¢ –°–æ–±—Ä–∞–Ω–∏—è\n' +
                  '‚Ä¢ –ó–∞—è–≤–ª–µ–Ω–∏—è');
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
