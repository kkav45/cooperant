# 📬 УВЕДОМЛЕНИЯ И СВЕРКА ДАННЫХ: ДЕТАЛЬНЫЙ ПРОТОКОЛ

**Версия:** 1.0  
**Дата:** 20 февраля 2026  
**Статус:** 📋 На согласовании

---

## 📋 СОДЕРЖАНИЕ

1. [Когда возникают расхождения](#1-когда-возникают-расхождения)
2. [Типы уведомлений](#2-типы-уведомлений)
3. [Каналы уведомлений](#3-каналы-уведомлений)
4. [Сценарии взаимодействия](#4-сценарии-взаимодействия)
5. [Примеры расхождений](#5-примеры-расхождений)
6. [Механизм разрешения конфликтов](#6-механизм-разрешения-конфликтов)

---

## 1. КОГДА ВОЗНИКАЮТ РАСХОЖДЕНИЯ

### 1.1 Источники расхождений

```
┌─────────────────────────────────────────────────────────────────┐
│                    ИСТОЧНИКИ РАСХОЖДЕНИЙ                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1️⃣ ПАЙЩИК изменил данные                                     │
│     • Обновил адрес в личном кабинете                          │
│     • Изменил телефон/email                                    │
│     • Загрузил новый паспорт                                   │
│                                                                 │
│  2️⃣ КООПЕРАТИВ изменил данные                                 │
│     • Бухгалтер исправил ФИО по паспорту                       │
│     • Изменил статус пайщика                                   │
│     • Внёс данные о взносах                                    │
│                                                                 │
│  3️⃣ ТЕХНИЧЕСКАЯ ОШИБКА                                        │
│     • Сбой при синхронизации                                   │
│     • Дублирование записей                                     │
│     • Некорректный формат данных                               │
│                                                                 │
│  4️⃣ ВРЕМЕННОЕ РАСХОЖДЕНИЕ                                     │
│     • Данные ещё не синхронизированы                           │
│     • Заявление на рассмотрении                                │
│     • Ожидание подтверждения                                   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 Момент возникновения расхождений

```
┌─────────────────────────────────────────────────────────────────┐
│                КОГДА ВОЗНИКАЕТ РАСХОЖДЕНИЕ                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Сценарий 1: Пайщик изменил контактные данные                  │
│  ─────────────────────────────────────────────────────────     │
│  1. Пайщик в личном кабинете:                                  │
│     "Изменить адрес" → "ул. Новая, д. 5"                       │
│     │                                                          │
│     ▼                                                          │
│  2. Данные сохраняются в Яндекс.Диск пайщика:                  │
│     /КООПЕРАНТ/member_profile.json                             │
│     │                                                          │
│     ▼                                                          │
│  3. Статус поля: "requires_confirmation" ⏳                    │
│     │                                                          │
│     ▼                                                          │
│  4. КОМФЛИКТ:                                                  │
│     У пайщика: "ул. Новая, д. 5" (ожидает подтверждения)       │
│     У кооператива: "ул. Старая, д. 1" (актуальные)             │
│                                                                 │
│                                                                 │
│  Сценарий 2: Кооператив внёс платёж                            │
│  ─────────────────────────────────────────────────────────     │
│  1. Бухгалтер создаёт ПКО-015 на 5000 ₽                        │
│     │                                                          │
│     ▼                                                          │
│  2. Данные в /КООПЕРАНТ/payments.json                          │
│     │                                                          │
│     ▼                                                          │
│  3. Пайщик ещё не синхронизировался                            │
│     │                                                          │
│     ▼                                                          │
│  4. КОМФЛИКТ:                                                  │
│     У пайщика: 100 000 ₽ (старые данные)                       │
│     У кооператива: 105 000 ₽ (новые данные)                    │
│                                                                 │
│                                                                 │
│  Сценарий 3: Изменение статуса пайщика                         │
│  ─────────────────────────────────────────────────────────     │
│  1. Общее собрание исключило пайщика                           │
│     │                                                          │
│     ▼                                                          │
│  2. Бухгалтер изменил статус: "active" → "excluded"            │
│     │                                                          │
│     ▼                                                          │
│  3. Пайщик не знает об этом                                    │
│     │                                                          │
│     ▼                                                          │
│  4. КОМФЛИКТ:                                                  │
│     У пайщика: "active" ✅                                     │
│     У кооператива: "excluded" ❌                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. ТИПЫ УВЕДОМЛЕНИЙ

### 2.1 Классификация уведомлений

```
┌─────────────────────────────────────────────────────────────────┐
│                    ТИПЫ УВЕДОМЛЕНИЙ                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  📧 ИНФОРМАЦИОННЫЕ (не требуют действия)                       │
│  ├─ Поступление платежа                                        │
│  ├─ Изменение статуса собрания                                 │
│  ├─ Выпуск документа                                           │
│  └─ Напоминание о собрании                                     │
│                                                                 │
│  ⚠️ ТРЕБУЮЩИЕ ДЕЙСТВИЯ (нужно реагировать)                     │
│  ├─ Подтверждение изменения данных                             │
│  ├─ Рассмотрение заявления                                     │
│  ├─ Оплата задолженности                                       │
│  └─ Обновление паспорта                                        │
│                                                                 │
│  🔔 СРОЧНЫЕ (немедленное внимание)                             │
│  ├─ Исключение из кооператива                                  │
│  ├─ Критическая ошибка синхронизации                           │
│  └─ Истечение срока документа                                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 Матрица уведомлений

| Событие | Пайщик | Кооператив | Канал | Приоритет |
|---------|--------|------------|-------|-----------|
| **Пайщик изменил адрес** | ✅ Подтверждение | ✅ На проверку | Email + В ЛК | Средний |
| **Поступление платежа** | ✅ Зачислено | ✅ Проведено | Email + В ЛК | Низкий |
| **Заявление подано** | ✅ Принято | ✅ Новое | Email + В ЛК | Высокий |
| **Заявление рассмотрено** | ✅ Решение | ✅ Статус | Email + В ЛК | Высокий |
| **Изменение статуса** | ✅ Уведомление | ✅ Запись | Email + В ЛК | Высокий |
| **Синхронизация** | ✅ Успех/Ошибка | ✅ Лог | В ЛК | Низкий |
| **Расхождение данных** | ✅ Запрос | ✅ Запрос | Email + В ЛК | Высокий |
| **Напоминание о взносе** | ✅ Оплатить | ✅ Список | Email + SMS | Средний |
| **Приглашение на собрание** | ✅ Явка | ✅ Кворум | Email + SMS | Средний |

---

## 3. КАНАЛЫ УВЕДОМЛЕНИЙ

### 3.1 Доступные каналы

```
┌─────────────────────────────────────────────────────────────────┐
│                      КАНАЛЫ УВЕДОМЛЕНИЙ                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1️⃣ EMAIL (Яндекс.Почта)                                      │
│     ├─ Кому: пайщик, бухгалтер, председатель                    │
│     ├─ Когда: все важные события                                │
│     ├─ Шаблон: HTML с логотипом                                 │
│     └─ Пример: noreply@koopérant.ru                             │
│                                                                 │
│  2️⃣ TELEGRAM (Telegram Bot)                                   │
│     ├─ Кому: пайщик (если подключил)                           │
│     ├─ Когда: срочные уведомления                              │
│     ├─ Формат: сообщения с кнопками                            │
│     └─ Пример: @KooperantBot                                    │
│                                                                 │
│  3️⃣ ЛИЧНЫЙ КАБИНЕТ (в системе)                                │
│     ├─ Кому: все пользователи                                  │
│     ├─ Когда: при входе в систему                              │
│     ├─ Формат: колокольчик 🔔 + счётчик                        │
│     └─ Раздел: "Уведомления"                                   │
│                                                                 │
│  4️⃣ PUSH (для мобильных)                                      │
│     ├─ Кому: пользователи приложения                           │
│     ├─ Когда: критические события                              │
│     └─ Формат: push-сообщения                                  │
│                                                                 │
│  5️⃣ SMS (резервный канал)                                     │
│     ├─ Кому: пайщик без интернета                              │
│     ├─ Когда: критически важные события                        │
│     └─ Пример: "КООПЕРАНТ: Вам начислен взнос 5000₽"           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 Приоритеты каналов

```
┌─────────────────────────────────────────────────────────────────┐
│           ВЫБОР КАНАЛА В ЗАВИСИМОСТИ ОТ СОБЫТИЯ                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🔴 КРИТИЧЕСКОЕ (исключение, ошибка)                           │
│     Email + Telegram + SMS + В ЛК                               │
│                                                                 │
│  🟠 ВАЖНОЕ (заявление, изменение данных)                       │
│     Email + Telegram + В ЛК                                     │
│                                                                 │
│  🟡 ОБЫЧНОЕ (платёж, документ)                                 │
│     Email + В ЛК                                                │
│                                                                 │
│  🟢 ИНФОРМАЦИОННОЕ (напоминание, статистика)                   │
│     В ЛК (по желанию Email)                                     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. СЦЕНАРИИ ВЗАИМОДЕЙСТВИЯ

### 4.1 Сценарий: Пайщик изменил адрес

```
┌─────────────────────────────────────────────────────────────────┐
│  СЦЕНАРИЙ: Пайщик изменил адрес проживания                      │
└─────────────────────────────────────────────────────────────────┘

  ┌──────────────┐
  │ 1. ПАЙЩИК    │
  │ Изменил адрес│
  │ в личном     │
  │ кабинете     │
  └──────┬───────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 2. СОХРАНЕНИЕ                                               │
  │ /КООПЕРАНТ/member_profile.json                              │
  │                                                             │
  │ "address": {                                                │
  │   "value": "ул. Новая, д. 5",                               │
  │   "status": "pending_confirmation",  ← Пометка              │
  │   "changedAt": "2026-02-20T10:00:00Z",                      │
  │   "previousValue": "ул. Старая, д. 1"                       │
  │ }                                                           │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 3. УВЕДОМЛЕНИЕ КООПЕРАТИВУ                                  │
  │ Кому: бухгалтер@koop1.ru                                    │
  │ Тема: ⚠️ Пайщик изменил контактные данные                  │
  │                                                             │
  │ Содержание:                                                 │
  │ ┌─────────────────────────────────────────────────────────┐ │
  │ │ Иванов И.И. (ID: 79001234567) изменил адрес:            │ │
  │ │                                                         │ │
  │ │ Было: ул. Старая, д. 1                                  │ │
  │ │ Стало: ул. Новая, д. 5                                  │ │
  │ │                                                         │ │
  │ │ [Подтвердить] [Отклонить] [Посмотреть в системе]        │ │
  │ └─────────────────────────────────────────────────────────┘ │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 4. БУХГАЛТЕР ПРОВЕРЯЕТ                                      │
  │                                                             │
  │ ┌─────────────────────────────────────────────────────────┐ │
  │ │  Подтверждение изменения данных                         │ │
  │ │                                                         │ │
  │ │ Пайщик: Иванов И.И.                                     │ │
  │ │ Поле: Адрес проживания                                  │ │
  │ │                                                         │ │
  │ │ Старое значение: ул. Старая, д. 1                       │ │
  │ │ Новое значение: ул. Новая, д. 5                         │ │
  │ │                                                         │ │
  │ │ [✅ Подтвердить] [❌ Отклонить]                         │ │
  │ │                                                         │ │
  │ │ Комментарий: [_________________________________]        │ │
  │ └─────────────────────────────────────────────────────────┘ │
  └─────────────────────────────────────────────────────────────┘
         │
    ┌────┴────┐
    │         │
    ▼         ▼
  ✅ ДА    ❌ НЕТ
    │         │
    │         └─→ Уведомление пайщику:
    │             "Изменение отклонено"
    │
    ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 5. ОБНОВЛЕНИЕ ДАННЫХ В КООПЕРАТИВЕ                          │
  │ /КООПЕРАНТ/members.json                                     │
  │                                                             │
  │ "address": "ул. Новая, д. 5",                               │
  │ "updatedAt": "2026-02-20T11:00:00Z"                         │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 6. УВЕДОМЛЕНИЕ ПАЙЩИКУ                                      │
  │ Кому: ivanov@yandex.ru                                      │
  │ Тема: ✅ Изменение адреса подтверждено                      │
  │                                                             │
  │ Содержание:                                                 │
  │ ┌─────────────────────────────────────────────────────────┐ │
  │ │ Ваш адрес обновлён в реестре кооператива:               │ │
  │ │ ул. Новая, д. 5                                         │ │
  │ │                                                         │ │
  │ │ Изменено: 20.02.2026 в 11:00                            │ │
  │ │ Бухгалтер: Петрова А.С.                                 │ │
  │ └─────────────────────────────────────────────────────────┘ │
  └─────────────────────────────────────────────────────────────┘
```

### 4.2 Сценарий: Кооператив начислил взносы

```
┌─────────────────────────────────────────────────────────────────┐
│  СЦЕНАРИЙ: Кооператив начислил членский взнос                   │
└─────────────────────────────────────────────────────────────────┘

  ┌──────────────┐
  │ 1. БУХГАЛТЕР │
  │ Создал ПКО   │
  │ на 5000 ₽    │
  └──────┬───────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 2. СОХРАНЕНИЕ                                               │
  │ /КООПЕРАНТ/payments.json                                    │
  │                                                             │
  │ {                                                           │
  │   "id": "pay_015",                                          │
  │   "memberId": "79001234567",                                │
  │   "type": "membership",                                     │
  │   "amount": 5000,                                           │
  │   "date": "2026-02-20",                                     │
  │   "documentNumber": "ПКО-015"                               │
  │ }                                                           │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 3. АВТОМАТИЧЕСКОЕ УВЕДОМЛЕНИЕ ПАЙЩИКУ                       │
  │ Кому: ivanov@yandex.ru                                      │
  │ Тема: 💰 Начислен членский взнос                            │
  │                                                             │
  │ Содержание:                                                 │
  │ ┌─────────────────────────────────────────────────────────┐ │
  │ │ КПК "Первый"                                            │ │
  │ │                                                         │ │
  │ │ Вам начислен членский взнос                             │ │
  │ │                                                         │ │
  │ │ Сумма: 5 000 ₽                                          │ │
  │ │ Документ: ПКО-015                                       │ │
  │ │ Дата: 20.02.2026                                        │ │
  │ │                                                         │ │
  │ │ [Посмотреть в личном кабинете]                          │ │
  │ └─────────────────────────────────────────────────────────┘ │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 4. ПАЙЩИК ПРИ СЛЕДУЮЩЕЙ СИНХРОНИЗАЦИИ                       │
  │                                                             │
  │ ┌─────────────────────────────────────────────────────────┐ │
  │ │ 💰 Мои взносы                                           │ │
  │ │                                                         │ │
  │ │ ✅ 20.02.2026 | Членский взнос 2026                     │ │
  │ │    +5 000 ₽ | ПКО-015                                   │ │
  │ │    🆕 Новое (сегодня)                                   │ │
  │ └─────────────────────────────────────────────────────────┘ │
  └─────────────────────────────────────────────────────────────┘
```

### 4.3 Сценарий: Обнаружены расхождения при синхронизации

```
┌─────────────────────────────────────────────────────────────────┐
│  СЦЕНАРИЙ: Синхронизация обнаружила расхождения                 │
└─────────────────────────────────────────────────────────────────┘

  ┌──────────────┐
  │ 1. ПАЙЩИК    │
  │ Нажал        │
  │ "Синхронизи- │
  │ ровать"      │
  └──────┬───────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 2. ЗАГРУЗКА ДАННЫХ ИЗ КООПЕРАТИВА                           │
  │                                                             │
  │ Запрос: /КООПЕРАНТ/members.json                             │
  │ Фильтр: memberId = "79001234567"                            │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 3. СРАВНЕНИЕ ДАННЫХ (member-compare.js)                     │
  │                                                             │
  │ ┌─────────────────────────────────────────────────────────┐ │
  │ │ Поле          │ Локально      │ В кооперативе   │ Статус│ │
  │ │───────────────│───────────────│─────────────────│───────│ │
  │ │ ФИО           │ Иванов И.И.   │ Иванов И.И.     │ ✅    │ │
  │ │ Телефон       │ +79001112222  │ +79003334444    │ ⚠️    │ │
  │ │ Email         │ old@mail.ru   │ new@mail.ru     │ ⚠️    │ │
  │ │ Адрес         │ ул.Мира, 10   │ ул.Мира, 10     │ ✅    │ │
  │ └─────────────────────────────────────────────────────────┘ │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 4. ПОКАЗ РАСХОЖДЕНИЙ ПАЙЩИКУ                                │
  │                                                             │
  │ ┌─────────────────────────────────────────────────────────┐ │
  │ │ ⚠️ Обнаружены расхождения в данных                      │ │
  │ │                                                         │ │
  │ │ Найдено 2 расхождения:                                  │ │
  │ │                                                         │ │
  │ │ 📞 Телефон                                              │ │
  │ │    У вас: +7 (900) 111-22-22                            │ │
  │ │    В кооперативе: +7 (900) 333-44-44                    │ │
  │ │    📅 Изменено: 15.02.2026                              │ │
  │ │                                                         │ │
  │ │ ✉️ Email                                                │ │
  │ │    У вас: old@mail.ru                                   │ │
  │ │    В кооперативе: new@mail.ru                           │ │
  │ │    📅 Изменено: 15.02.2026                              │ │
  │ │                                                         │ │
  │ │ Что делать?                                             │ │
  │ │                                                         │ │
  │ │ [✅ Принять версию кооператива]                         │ │
  │ │    → Ваши данные будут обновлены                        │ │
  │ │                                                         │ │
  │ │ [📝 Запросить исправление]                              │ │
  │ │    → Отправить запрос в кооператив                      │ │
  │ │                                                         │ │
  │ │ [⏭️ Игнорировать]                                       │ │
  │ │    → Напомнить позже                                    │ │
  │ └─────────────────────────────────────────────────────────┘ │
  └─────────────────────────────────────────────────────────────┘
         │
    ┌────┴─────────────────┐
    │                      │
    ▼                      ▼
  ✅ ПРИНЯТЬ           📝 ЗАПРОСИТЬ
    │                      │
    │                      └─→ Заявление в кооператив
    │                      │   Бухгалтер проверит
    │                      │   Ответ в течение 3 дней
    │
    ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 5. ОБНОВЛЕНИЕ ДАННЫХ ПАЙЩИКА                                │
  │                                                             │
  │ /КООПЕРАНТ/member_profile.json                              │
  │                                                             │
  │ "phone": "+79003334444",                                    │
  │ "email": "new@mail.ru",                                     │
  │ "lastSync": "2026-02-20T12:00:00Z"                          │
  └─────────────────────────────────────────────────────────────┘
         │
         ▼
  ┌─────────────────────────────────────────────────────────────┐
  │ 6. УВЕДОМЛЕНИЕ О УСПЕХЕ                                     │
  │                                                             │
  │ ✅ Синхронизация завершена                                  │
  │                                                             │
  │ Обновлено полей: 2                                          │
  │ • Телефон: +7 (900) 333-44-44                               │
  │ • Email: new@mail.ru                                        │ │
  │                                                             │
  │ [Посмотреть изменения]                                      │
  └─────────────────────────────────────────────────────────────┘
```

---

## 5. ПРИМЕРЫ РАСХОЖДЕНИЙ

### 5.1 Таблица типов расхождений

| Тип | У пайщика | У кооператива | Причина | Решение |
|-----|-----------|---------------|---------|---------|
| **Телефон** | +79001112222 | +79003334444 | Пайщик сменил номер | Принять версию кооператива или запросить исправление |
| **Email** | old@mail.ru | new@mail.ru | Пайщик не обновил | Принять версию кооператива |
| **Адрес** | ул. Мира, 10 | пр. Ленина, 5 | Переезд, не сообщил | Запросить исправление |
| **Паспорт** | 1234 567890 | 1234 567891 | Опечатка бухгалтера | Запросить исправление |
| **ФИО** | Иванов И.И. | Иванов Иван Иванович | Сокращённо vs полностью | Не критично, игнорировать |
| **Статус** | active | suspended | Задолженность | Принять версию кооператива |
| **Взносы** | 100 000 ₽ | 105 000 ₽ | Не синхронизирован | Принять версию кооператива |
| **Дата вступления** | 15.03.2023 | 16.03.2023 | Ошибка в протоколе | Запросить исправление |

### 5.2 Критические vs Некритические расхождения

```
┌─────────────────────────────────────────────────────────────────┐
│            КРИТИЧЕСКИЕ РАСХОЖДЕНИЯ (требуют внимания)           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🔴 ФИО (разное написание)                                     │
│     → Может повлиять на юридическую силу документов            │
│                                                                 │
│  🔴 Паспортные данные                                          │
│     → Ошибка в номере/серии                                    │
│                                                                 │
│  🔴 Статус пайщика                                             │
│     → Активный vs Исключён                                     │
│                                                                 │
│  🔴 Сумма взносов                                               │
│     → Разные финансовые данные                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│         НЕКРИТИЧЕСКИЕ РАСХОЖДЕНИЯ (можно игнорировать)          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🟡 Формат телефона                                              │
│     → +7 (900) vs +7900                                         │
│                                                                 │
│  🟡 Регистр букв в email                                         │
│     → Test@mail.ru vs test@mail.ru                               │
│                                                                 │
│  🟡 Сокращения ФИО                                               │
│     → Иванов И.И. vs Иванов Иван Иванович                       │
│                                                                 │
│  🟡 Формат адреса                                                │
│     → ул. Мира д. 10 vs улица Мира дом 10                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. МЕХАНИЗМ РАЗРЕШЕНИЯ КОНФЛИКТОВ

### 6.1 Алгоритм разрешения

```
┌─────────────────────────────────────────────────────────────────┐
│           АЛГОРИТМ РАЗРЕШЕНИЯ РАСХОЖДЕНИЙ                       │
└─────────────────────────────────────────────────────────────────┘

  1. ОБНАРУЖЕНИЕ
     │
     ▼
  2. КЛАССИФИКАЦИЯ (критичное/некритичное)
     │
     ├─ Некритичное → Автоматически принять версию кооператива
     │
     └─ Критичное
        │
        ▼
  3. УВЕДОМЛЕНИЕ СТОРОН
     │
     ▼
  4. ПРЕДОСТАВЛЕНИЕ ВЫБОРА
     │
     ├─ Пайщик выбирает действие
     │
     └─ Кооператив проверяет
        │
        ▼
  5. ИСПОЛНЕНИЕ
     │
     ├─ Обновление данных
     │
     └─ Запись в лог аудита
        │
        ▼
  6. УВЕДОМЛЕНИЕ О РЕЗУЛЬТАТЕ
```

### 6.2 Лог аудита расхождений

```json
{
  "discrepancyLog": [
    {
      "id": "disc_001",
      "memberId": "79001234567",
      "cooperativeId": "coop_001",
      "detectedAt": "2026-02-20T12:00:00Z",
      "field": "phone",
      "memberValue": "+79001112222",
      "cooperativeValue": "+79003334444",
      "severity": "medium",
      "resolvedBy": "member",
      "resolution": "accepted_cooperative_version",
      "resolvedAt": "2026-02-20T12:05:00Z",
      "resolvedByUser": "Иванов И.И.",
      "comment": ""
    },
    {
      "id": "disc_002",
      "memberId": "79001234567",
      "cooperativeId": "coop_001",
      "detectedAt": "2026-02-19T10:00:00Z",
      "field": "passport_number",
      "memberValue": "567890",
      "cooperativeValue": "567891",
      "severity": "high",
      "resolvedBy": "cooperative",
      "resolution": "corrected_by_accountant",
      "resolvedAt": "2026-02-19T15:00:00Z",
      "resolvedByUser": "Петрова А.С. (бухгалтер)",
      "comment": "Исправлена опечатка в номере паспорта"
    }
  ]
}
```

### 6.3 Шаблоны уведомлений

#### Email пайщику при расхождении

```
От: noreply@koopérant.ru
Кому: ivanov@yandex.ru
Тема: ⚠️ Обнаружены расхождения в данных

Уважаемый, Иван Иванович!

При синхронизации с кооперативом "КПК Первый" обнаружены расхождения:

┌─────────────────────────────────────────────────────────┐
│ Поле          │ У вас         │ В кооперативе         │
├───────────────┼───────────────┼───────────────────────┤
│ Телефон       │ +79001112222  │ +79003334444          │
│ Email         │ old@mail.ru   │ new@mail.ru           │
└─────────────────────────────────────────────────────────┘

Что делать?

1. Войти в личный кабинет: https://koopérant.ru/member
2. Перейти в раздел "Синхронизация"
3. Выбрать действие для каждого расхождения

Срок для устранения: 7 дней

Если не уверены — выберите "Запросить исправление" и мы проверим данные.

С уважением,
Команда КООПЕРАНТ
```

#### Email бухгалтеру при запросе исправления

```
От: noreply@koopérant.ru
Кому: buh@koop1.ru
Тема: 📝 Пайщик запросил исправление данных

Коллеги, добрый день!

Пайщик Иванов И.И. (ID: 79001234567) запросил исправление данных:

Поле: Адрес проживания
Текущее значение: ул. Старая, д. 1
Запрошенное значение: ул. Новая, д. 5

Комментарий пайщика: "Переехал, прошу обновить адрес"

Проверьте и подтвердите изменение:
https://koopérant.ru/coop/discrepancies/disc_003

Срок для ответа: 3 рабочих дня

Автоматическое сообщение, не отвечайте на этот email.
```

---

## 📊 СВОДНАЯ ТАБЛИЦА УВЕДОМЛЕНИЙ

| Событие | Кто получает | Канал | Когда | Требует действия |
|---------|--------------|-------|-------|------------------|
| Изменение данных пайщиком | Кооператив | Email + В ЛК | Сразу | ✅ Да |
| Подтверждение изменения | Пайщик | Email + В ЛК | Сразу | ❌ Нет |
| Начисление взноса | Пайщик | Email + В ЛК | Сразу | ❌ Нет |
| Синхронизация (успех) | Пайщик | В ЛК | После синхр. | ❌ Нет |
| Синхронизация (ошибка) | Пайщик | Email + В ЛК | После синхр. | ✅ Да |
| Расхождение найдено | Пайщик | Email + В ЛК | При синхр. | ✅ Да |
| Запрос исправления | Кооператив | Email + В ЛК | Сразу | ✅ Да |
| Решение по запросу | Пайщик | Email + В ЛК | Сразу | ❌ Нет |
| Напоминание о взносе | Пайщик | Email + SMS | За 7 дней | ✅ Да |
| Приглашение на собрание | Пайщик | Email + SMS | За 14 дней | ✅ Да |

---

## ✅ РЕКОМЕНДАЦИИ

### Для пайщика:

1. **Регулярно синхронизируйтесь** (раз в неделю)
2. **Проверяйте email** (раз в день)
3. **Сразу реагируйте на расхождения** (не откладывайте)
4. **Запрашивайте исправления** если не согласны

### Для кооператива:

1. **Проверяйте запросы** в течение 3 дней
2. **Комментируйте решения** (почему одобрено/отклонено)
3. **Ведите лог аудита** (для спорных ситуаций)
4. **Настройте авто-уведомления** (чтобы не пропустить)

---

**Документ готов для обсуждения.**
